<!DOCTYPE html><html lang="en" data-theme="dark"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><!-- Primary Meta Tags --><title>Python Best Practices and Advanced Techniques: Complete Professional Guide • Dev|Journal</title><meta name="description" content="Python Best Practices and Advanced Techniques: Complete Professional Guide Python's simplicity makes it easy to start, but mastering professional Python…"><meta name="keywords" content="software architecture, backend development, microservices, Java, Python, Spring Boot, technical blog"><meta name="author" content="El Mehdi Arezki"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://earezki.com/ai-news/2025-11-01-python-best-practices-advanced-guide/"><meta property="og:title" content="Python Best Practices and Advanced Techniques: Complete Professional Guide • Dev|Journal"><meta property="og:site_name" content="Dev|Journal"><meta property="og:description" content="Python Best Practices and Advanced Techniques: Complete Professional Guide Python's simplicity makes it easy to start, but mastering professional Python…"><meta property="og:image" content="https://earezki.com/assets/og-image-default.jpg"><!-- Twitter --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:url" content="https://earezki.com/ai-news/2025-11-01-python-best-practices-advanced-guide/"><meta name="twitter:title" content="Python Best Practices and Advanced Techniques: Complete Professional Guide • Dev|Journal"><meta name="twitter:description" content="Python Best Practices and Advanced Techniques: Complete Professional Guide Python's simplicity makes it easy to start, but mastering professional Python…"><meta name="twitter:image" content="https://earezki.com/assets/og-image-default.jpg"><meta name="twitter:creator" content="@earezki"><!-- Canonical and Indexing --><link rel="canonical" href="https://earezki.com/ai-news/2025-11-01-python-best-practices-advanced-guide/"><!-- Favicons --><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="icon" type="image/x-icon" href="/favicon.ico"><!-- RSS Feed --><link rel="alternate" type="application/rss+xml" title="RSS" href="/rss.xml"><!-- Analytics: Google Analytics (Legacy UA) --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-161447264-1"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);} 
      gtag('js', new Date()); 
      gtag('config', 'UA-161447264-1');
    </script><!-- Analytics: Umami --><script defer src="https://cloud.umami.is/script.js" data-website-id="4a26531d-1053-4f79-97a6-06a1366aff91"></script><!-- Theme Persistence (runs before page render to prevent flash) --><script>
      (function() {
        const theme = localStorage.getItem('theme');
        if (theme) { 
          document.documentElement.setAttribute('data-theme', theme); 
        }
      })();
    </script><!-- Structured Data (JSON-LD) --><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Python Best Practices and Advanced Techniques: Complete Professional Guide","datePublished":"2025-11-01T15:00:00.000Z","dateModified":"2025-11-01T15:00:00.000Z","author":{"@type":"Person","name":"AREZKI El Mehdi"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://earezki.com/ai-news/2025-11-01-python-best-practices-advanced-guide/"},"description":"Python Best Practices and Advanced Techniques: Complete Professional Guide Python's simplicity makes it easy to start, but mastering professional Python…"}</script><link rel="stylesheet" href="/_astro/_slug_.C8vOLobN.css">
<style>.toc[data-astro-cid-xvrfupwn]{position:sticky;top:90px;max-height:calc(100vh - 120px);overflow:auto;padding:1rem 1rem 1.2rem;background:var(--color-bg-alt);border:1px solid var(--color-border);border-radius:var(--radius-md);font-size:.8rem;line-height:1.3}.toc-title[data-astro-cid-xvrfupwn]{font-weight:600;font-size:.75rem;text-transform:uppercase;letter-spacing:.08em;margin-bottom:.6rem;color:var(--color-text-alt)}.toc[data-astro-cid-xvrfupwn] ul[data-astro-cid-xvrfupwn]{list-style:none;margin:0;padding:0;display:flex;flex-direction:column;gap:.35rem}.toc[data-astro-cid-xvrfupwn] a[data-astro-cid-xvrfupwn]{text-decoration:none;color:var(--color-text-alt);transition:color var(--transition)}.toc[data-astro-cid-xvrfupwn] a[data-astro-cid-xvrfupwn]:hover{color:var(--color-accent)}.toc[data-astro-cid-xvrfupwn] li[data-astro-cid-xvrfupwn][class*=d-3]{margin-left:.75rem}.toc[data-astro-cid-xvrfupwn] li[data-astro-cid-xvrfupwn][class*=d-4]{margin-left:1.4rem}@media (max-width: 1080px){.toc[data-astro-cid-xvrfupwn]{display:none}}.breadcrumbs[data-astro-cid-ilhxcym7]{margin:0 0 1.5rem;font-size:.85rem}.breadcrumbs[data-astro-cid-ilhxcym7] ol[data-astro-cid-ilhxcym7]{list-style:none;padding:0;margin:0;display:flex;flex-wrap:wrap;align-items:center;gap:.5rem}.breadcrumbs[data-astro-cid-ilhxcym7] li[data-astro-cid-ilhxcym7]{display:flex;align-items:center;gap:.5rem}.breadcrumbs[data-astro-cid-ilhxcym7] a[data-astro-cid-ilhxcym7]{color:var(--color-text-alt);text-decoration:none;transition:color var(--transition)}.breadcrumbs[data-astro-cid-ilhxcym7] a[data-astro-cid-ilhxcym7]:hover{color:var(--color-accent);text-decoration:underline}.breadcrumbs[data-astro-cid-ilhxcym7] .separator[data-astro-cid-ilhxcym7]{color:var(--color-text-alt);opacity:.5;user-select:none}.breadcrumbs[data-astro-cid-ilhxcym7] .current[data-astro-cid-ilhxcym7]{color:var(--color-text);font-weight:500}.related-posts[data-astro-cid-dpgbfi7r]{margin:3rem 0;padding-top:2rem;border-top:2px solid var(--color-border)}.related-posts[data-astro-cid-dpgbfi7r] h2[data-astro-cid-dpgbfi7r]{font-size:1.5rem;margin:0 0 1.5rem;color:var(--color-text)}.related-posts-grid[data-astro-cid-dpgbfi7r]{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1.5rem}.related-post-card[data-astro-cid-dpgbfi7r]{background:var(--color-bg-alt);border:1px solid var(--color-border);border-radius:var(--radius-md);padding:1.25rem;transition:all var(--transition)}.related-post-card[data-astro-cid-dpgbfi7r]:hover{border-color:var(--color-accent);transform:translateY(-2px);box-shadow:var(--shadow-md)}.related-post-link[data-astro-cid-dpgbfi7r]{text-decoration:none;color:inherit;display:block}.related-post-card[data-astro-cid-dpgbfi7r] h3[data-astro-cid-dpgbfi7r]{margin:0 0 .75rem;font-size:1.1rem;font-weight:600;color:var(--color-text);line-height:1.3}.related-post-link[data-astro-cid-dpgbfi7r]:hover h3[data-astro-cid-dpgbfi7r]{color:var(--color-accent)}.related-excerpt[data-astro-cid-dpgbfi7r]{font-size:.85rem;color:var(--color-text-alt);line-height:1.5;margin:0 0 .75rem}.related-meta[data-astro-cid-dpgbfi7r]{font-size:.75rem;color:var(--color-text-alt);display:flex;gap:.5rem;align-items:center}@media (max-width: 680px){.related-posts-grid[data-astro-cid-dpgbfi7r]{grid-template-columns:1fr}}
.post-layout[data-astro-cid-rkg3zjxi]{display:grid;grid-template-columns:260px 1fr;gap:2.5rem}.sidebar-left[data-astro-cid-rkg3zjxi]{position:relative}@media (max-width: 1080px){.post-layout[data-astro-cid-rkg3zjxi]{grid-template-columns:1fr}}.ai-disclaimer-article[data-astro-cid-rkg3zjxi]{display:flex;gap:.75rem;padding:.9rem 1.1rem;margin:0 auto 2rem;max-width:780px;background:linear-gradient(135deg,#667eea1a,#764ba21a,#f093fb1a);border:2px solid transparent;border-radius:var(--radius-md);position:relative;background-clip:padding-box;font-size:.85rem}.ai-disclaimer-article[data-astro-cid-rkg3zjxi]:before{content:"";position:absolute;inset:-2px;border-radius:var(--radius-md);padding:2px;background:var(--ai-gradient-border);background-size:200% 200%;animation:gradient-rotate 3s linear infinite;-webkit-mask:linear-gradient(#fff 0 0) content-box,linear-gradient(#fff 0 0);-webkit-mask-composite:xor;mask:linear-gradient(#fff 0 0) content-box,linear-gradient(#fff 0 0);mask-composite:exclude;pointer-events:none}html[data-theme=dark] .ai-disclaimer-article[data-astro-cid-rkg3zjxi]{background:linear-gradient(135deg,#667eea26,#764ba226,#f093fb26)}.ai-disclaimer-article[data-astro-cid-rkg3zjxi] svg[data-astro-cid-rkg3zjxi]{margin-top:.15rem}.ai-disclaimer-article[data-astro-cid-rkg3zjxi] strong[data-astro-cid-rkg3zjxi]{color:var(--color-text);display:block;margin-bottom:.15rem}.ai-disclaimer-article[data-astro-cid-rkg3zjxi] div[data-astro-cid-rkg3zjxi]{line-height:1.5;color:var(--color-text-alt)}
</style><script type="module" src="/_astro/hoisted.2U5tn40l.js"></script></head> <body> <div id="readingProgress" role="progressbar" aria-label="Reading progress" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="position:fixed;left:0;top:0;height:3px;background:linear-gradient(90deg,#2563eb,#9333ea);width:0;z-index:999;transition:width .15s ease;"></div>  <!-- Site Header --> <header class="site-header container"> <div class="logo-wrap"> <a class="logo" href="/" aria-label="Dev|Journal Home">
Dev|Journal
</a> </div> <nav class="main-nav" aria-label="Main navigation"> <a href="/"> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" style="vertical-align: -2px; margin-right: 4px;"> <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path> <polyline points="9 22 9 12 15 12 15 22"></polyline> </svg>
Home
</a> <a href="/ai-news/" class="ai-news-link"> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" style="vertical-align: -2px; margin-right: 4px;"> <path d="M12 2a2 2 0 0 1 2 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 0 1 7 7h-9.5a.5.5 0 0 0-.5.5.5.5 0 0 1-1 0 .5.5 0 0 0-.5-.5H1a7 7 0 0 1 7-7h1V5.73c-.6-.34-1-.99-1-1.73a2 2 0 0 1 2-2z"></path> <path d="M7 15v4a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-4"></path> </svg>
AI News
</a> <a href="/tags/"> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" style="vertical-align: -2px; margin-right: 4px;"> <path d="M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2z"></path> <circle cx="7" cy="7" r="1.5"></circle> </svg>
Tags
</a> <a href="/about/"> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" style="vertical-align: -2px; margin-right: 4px;"> <circle cx="12" cy="12" r="10"></circle> <path d="M12 16v-4"></path> <path d="M12 8h.01"></path> </svg>
About
</a> <button id="themeToggle" class="theme-toggle" aria-label="Toggle dark mode"> <span class="theme-icon" aria-hidden="true">☾</span> <span class="theme-text">dark</span> </button> </nav> </header> <!-- Main Content --> <main class="container content-area">  <nav class="breadcrumbs" aria-label="Breadcrumb" data-astro-cid-ilhxcym7> <ol data-astro-cid-ilhxcym7> <li data-astro-cid-ilhxcym7>  <a href="/" data-astro-cid-ilhxcym7>Home</a> <span class="separator" aria-hidden="true" data-astro-cid-ilhxcym7>/</span>  </li><li data-astro-cid-ilhxcym7>  <a href="/ai-news/" data-astro-cid-ilhxcym7>Ai News</a> <span class="separator" aria-hidden="true" data-astro-cid-ilhxcym7>/</span>  </li><li data-astro-cid-ilhxcym7> <span class="current" aria-current="page" data-astro-cid-ilhxcym7>Python Best Practices and Advanced Techniques: Complete Professional Guide</span> </li> </ol> </nav>  <div class="ai-disclaimer-article" data-astro-cid-rkg3zjxi> <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="flex-shrink: 0;" data-astro-cid-rkg3zjxi> <circle cx="12" cy="12" r="10" data-astro-cid-rkg3zjxi></circle> <line x1="12" y1="8" x2="12" y2="12" data-astro-cid-rkg3zjxi></line> <line x1="12" y1="16" x2="12.01" y2="16" data-astro-cid-rkg3zjxi></line> </svg> <div data-astro-cid-rkg3zjxi> <strong data-astro-cid-rkg3zjxi>AI-Generated Content:</strong> This article was created with AI assistance. Please verify important information and check original references.
</div> </div> <div class="post-layout" data-astro-cid-rkg3zjxi> <aside class="sidebar-left" data-astro-cid-rkg3zjxi> <nav class="toc" aria-label="Table of Contents" data-astro-cid-xvrfupwn> <div class="toc-title" data-astro-cid-xvrfupwn>On this page</div> <ul data-astro-cid-xvrfupwn> <li class="d-2" data-astro-cid-xvrfupwn> <a href="#table-of-contents" data-astro-cid-xvrfupwn> Table of Contents </a> </li><li class="d-2" data-astro-cid-xvrfupwn> <a href="#modern-python-features-modern-features" data-astro-cid-xvrfupwn> Modern Python Features {#modern-features} </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#1-structural-pattern-matching-python-310" data-astro-cid-xvrfupwn> 1. Structural Pattern Matching (Python 3.10+) </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#2-walrus-operator-python-38" data-astro-cid-xvrfupwn> 2. Walrus Operator (Python 3.8+) </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#3-f-strings-advanced-features" data-astro-cid-xvrfupwn> 3. F-Strings Advanced Features </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#4-data-classes-python-37" data-astro-cid-xvrfupwn> 4. Data Classes (Python 3.7+) </a> </li><li class="d-2" data-astro-cid-xvrfupwn> <a href="#type-hints-and-mypy-type-hints" data-astro-cid-xvrfupwn> Type Hints and mypy {#type-hints} </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#1-basic-type-annotations" data-astro-cid-xvrfupwn> 1. Basic Type Annotations </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#2-generic-types" data-astro-cid-xvrfupwn> 2. Generic Types </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#3-protocol-types-structural-subtyping" data-astro-cid-xvrfupwn> 3. Protocol Types (Structural Subtyping) </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#4-advanced-type-hints" data-astro-cid-xvrfupwn> 4. Advanced Type Hints </a> </li><li class="d-2" data-astro-cid-xvrfupwn> <a href="#advanced-oop-patterns-oop-patterns" data-astro-cid-xvrfupwn> Advanced OOP Patterns {#oop-patterns} </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#1-abstract-base-classes" data-astro-cid-xvrfupwn> 1. Abstract Base Classes </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#2-descriptors-and-properties" data-astro-cid-xvrfupwn> 2. Descriptors and Properties </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#3-mixins" data-astro-cid-xvrfupwn> 3. Mixins </a> </li><li class="d-2" data-astro-cid-xvrfupwn> <a href="#functional-programming-functional" data-astro-cid-xvrfupwn> Functional Programming {#functional} </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#1-higher-order-functions" data-astro-cid-xvrfupwn> 1. Higher-Order Functions </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#2-closures-and-currying" data-astro-cid-xvrfupwn> 2. Closures and Currying </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#3-itertools-and-generators" data-astro-cid-xvrfupwn> 3. Itertools and Generators </a> </li><li class="d-2" data-astro-cid-xvrfupwn> <a href="#context-managers-context-managers" data-astro-cid-xvrfupwn> Context Managers {#context-managers} </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#1-basic-context-managers" data-astro-cid-xvrfupwn> 1. Basic Context Managers </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#2-advanced-context-managers" data-astro-cid-xvrfupwn> 2. Advanced Context Managers </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#3-async-context-managers" data-astro-cid-xvrfupwn> 3. Async Context Managers </a> </li><li class="d-2" data-astro-cid-xvrfupwn> <a href="#decorators-and-metaprogramming-decorators" data-astro-cid-xvrfupwn> Decorators and Metaprogramming {#decorators} </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#1-function-decorators" data-astro-cid-xvrfupwn> 1. Function Decorators </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#2-class-decorators" data-astro-cid-xvrfupwn> 2. Class Decorators </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#3-metaclasses" data-astro-cid-xvrfupwn> 3. Metaclasses </a> </li><li class="d-2" data-astro-cid-xvrfupwn> <a href="#concurrency-and-parallelism-concurrency" data-astro-cid-xvrfupwn> Concurrency and Parallelism {#concurrency} </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#1-asyncio-basics" data-astro-cid-xvrfupwn> 1. Asyncio Basics </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#2-threading" data-astro-cid-xvrfupwn> 2. Threading </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#3-multiprocessing" data-astro-cid-xvrfupwn> 3. Multiprocessing </a> </li><li class="d-2" data-astro-cid-xvrfupwn> <a href="#performance-optimization-performance" data-astro-cid-xvrfupwn> Performance Optimization {#performance} </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#1-profiling" data-astro-cid-xvrfupwn> 1. Profiling </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#2-performance-optimization-techniques" data-astro-cid-xvrfupwn> 2. Performance Optimization Techniques </a> </li><li class="d-2" data-astro-cid-xvrfupwn> <a href="#testing-strategies-testing" data-astro-cid-xvrfupwn> Testing Strategies {#testing} </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#1-pytest-basics" data-astro-cid-xvrfupwn> 1. pytest Basics </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#2-test-organization" data-astro-cid-xvrfupwn> 2. Test Organization </a> </li><li class="d-2" data-astro-cid-xvrfupwn> <a href="#project-structure-project-structure" data-astro-cid-xvrfupwn> Project Structure {#project-structure} </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#1-standard-project-layout" data-astro-cid-xvrfupwn> 1. Standard Project Layout </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#2-configuration-management" data-astro-cid-xvrfupwn> 2. Configuration Management </a> </li><li class="d-2" data-astro-cid-xvrfupwn> <a href="#conclusion" data-astro-cid-xvrfupwn> Conclusion </a> </li><li class="d-2" data-astro-cid-xvrfupwn> <a href="#resources" data-astro-cid-xvrfupwn> Resources </a> </li> </ul> </nav>  </aside> <article class="post" data-astro-cid-rkg3zjxi> <header class="post-header" data-astro-cid-rkg3zjxi> <h1 data-astro-cid-rkg3zjxi>Python Best Practices and Advanced Techniques: Complete Professional Guide</h1> <div class="meta" data-astro-cid-rkg3zjxi> <time datetime="2025-11-01T15:00:00.000Z" data-astro-cid-rkg3zjxi>Sat Nov 01 2025</time> <span data-astro-cid-rkg3zjxi>• 19 min read</span> </div> <div class="tag-row" data-astro-cid-rkg3zjxi><a class="post-tag " href="/tags/python/" data-astro-cid-rkg3zjxi>Python</a><a class="post-tag " href="/tags/programming/" data-astro-cid-rkg3zjxi>Programming</a><a class="post-tag " href="/tags/best-practices/" data-astro-cid-rkg3zjxi>Best Practices</a><a class="post-tag " href="/tags/software-engineering/" data-astro-cid-rkg3zjxi>Software Engineering</a></div> </header> <div class="post-body prose" data-astro-cid-rkg3zjxi> <h1 id="python-best-practices-and-advanced-techniques-complete-professional-guide">Python Best Practices and Advanced Techniques: Complete Professional Guide</h1>
<p>Python’s simplicity makes it easy to start, but mastering professional Python development requires understanding advanced patterns and best practices. This comprehensive guide covers everything from type hints to performance optimization.</p>
<h2 id="table-of-contents">Table of Contents</h2>
<ol>
<li><a href="#modern-features">Modern Python Features</a></li>
<li><a href="#type-hints">Type Hints and mypy</a></li>
<li><a href="#oop-patterns">Advanced OOP Patterns</a></li>
<li><a href="#functional">Functional Programming</a></li>
<li><a href="#context-managers">Context Managers</a></li>
<li><a href="#decorators">Decorators and Metaprogramming</a></li>
<li><a href="#concurrency">Concurrency and Parallelism</a></li>
<li><a href="#performance">Performance Optimization</a></li>
<li><a href="#testing">Testing Strategies</a></li>
<li><a href="#project-structure">Project Structure</a></li>
</ol>
<h2 id="modern-python-features-modern-features">Modern Python Features {#modern-features}</h2>
<h3 id="1-structural-pattern-matching-python-310">1. Structural Pattern Matching (Python 3.10+)</h3>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token comment"># Pattern matching for complex data structures</span>
<span class="token keyword">def</span> <span class="token function">process_command</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">match</span> command<span class="token punctuation">:</span>
        <span class="token keyword">case</span> <span class="token punctuation">{</span><span class="token string">"action"</span><span class="token punctuation">:</span> <span class="token string">"create"</span><span class="token punctuation">,</span> <span class="token string">"resource"</span><span class="token punctuation">:</span> resource<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">}</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f"Creating </span><span class="token interpolation"><span class="token punctuation">{</span>resource<span class="token punctuation">}</span></span><span class="token string"> with </span><span class="token interpolation"><span class="token punctuation">{</span>kwargs<span class="token punctuation">}</span></span><span class="token string">"</span></span>
        
        <span class="token keyword">case</span> <span class="token punctuation">{</span><span class="token string">"action"</span><span class="token punctuation">:</span> <span class="token string">"delete"</span><span class="token punctuation">,</span> <span class="token string">"resource"</span><span class="token punctuation">:</span> resource<span class="token punctuation">,</span> <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token builtin">id</span><span class="token punctuation">}</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f"Deleting </span><span class="token interpolation"><span class="token punctuation">{</span>resource<span class="token punctuation">}</span></span><span class="token string"> #</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">"</span></span>
        
        <span class="token keyword">case</span> <span class="token punctuation">{</span><span class="token string">"action"</span><span class="token punctuation">:</span> <span class="token string">"update"</span><span class="token punctuation">,</span> <span class="token string">"resource"</span><span class="token punctuation">:</span> resource<span class="token punctuation">,</span> <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token builtin">id</span><span class="token punctuation">,</span> <span class="token string">"data"</span><span class="token punctuation">:</span> data<span class="token punctuation">}</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f"Updating </span><span class="token interpolation"><span class="token punctuation">{</span>resource<span class="token punctuation">}</span></span><span class="token string"> #</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string"> with </span><span class="token interpolation"><span class="token punctuation">{</span>data<span class="token punctuation">}</span></span><span class="token string">"</span></span>
        
        <span class="token keyword">case</span> <span class="token keyword">_</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token string">"Unknown command"</span>

<span class="token comment"># Pattern matching with guards</span>
<span class="token keyword">def</span> <span class="token function">categorize_number</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">match</span> n<span class="token punctuation">:</span>
        <span class="token keyword">case</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token string">"zero"</span>
        <span class="token keyword">case</span> n <span class="token keyword">if</span> n <span class="token operator">&#x3C;</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token string">"negative"</span>
        <span class="token keyword">case</span> n <span class="token keyword">if</span> n <span class="token operator">></span> <span class="token number">0</span> <span class="token keyword">and</span> n <span class="token operator">&#x3C;</span> <span class="token number">10</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token string">"single digit"</span>
        <span class="token keyword">case</span> <span class="token keyword">_</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token string">"multiple digits"</span>

<span class="token comment"># Pattern matching for parsing</span>
<span class="token keyword">def</span> <span class="token function">parse_response</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">match</span> response<span class="token punctuation">:</span>
        <span class="token keyword">case</span> <span class="token punctuation">{</span><span class="token string">"status"</span><span class="token punctuation">:</span> <span class="token string">"success"</span><span class="token punctuation">,</span> <span class="token string">"data"</span><span class="token punctuation">:</span> data<span class="token punctuation">}</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Success: </span><span class="token interpolation"><span class="token punctuation">{</span>data<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        
        <span class="token keyword">case</span> <span class="token punctuation">{</span><span class="token string">"status"</span><span class="token punctuation">:</span> <span class="token string">"error"</span><span class="token punctuation">,</span> <span class="token string">"code"</span><span class="token punctuation">:</span> code<span class="token punctuation">,</span> <span class="token string">"message"</span><span class="token punctuation">:</span> msg<span class="token punctuation">}</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Error </span><span class="token interpolation"><span class="token punctuation">{</span>code<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>msg<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        
        <span class="token keyword">case</span> <span class="token punctuation">{</span><span class="token string">"status"</span><span class="token punctuation">:</span> <span class="token string">"pending"</span><span class="token punctuation">}</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Request pending..."</span><span class="token punctuation">)</span>
        
        <span class="token keyword">case</span> <span class="token keyword">_</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Invalid response"</span><span class="token punctuation">)</span>
</code></pre>
<h3 id="2-walrus-operator-python-38">2. Walrus Operator (Python 3.8+)</h3>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token comment"># ❌ Bad: Multiple calls or assignments</span>
<span class="token keyword">def</span> <span class="token function">process_data</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> expensive_computation<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token keyword">if</span> result<span class="token punctuation">:</span>
        <span class="token keyword">return</span> result
    <span class="token keyword">return</span> <span class="token boolean">None</span>

<span class="token comment"># ✅ Good: Walrus operator</span>
<span class="token keyword">def</span> <span class="token function">process_data</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> result <span class="token operator">:=</span> expensive_computation<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> result
    <span class="token keyword">return</span> <span class="token boolean">None</span>

<span class="token comment"># List comprehension with walrus</span>
filtered_data <span class="token operator">=</span> <span class="token punctuation">[</span>
    result
    <span class="token keyword">for</span> item <span class="token keyword">in</span> data
    <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">:=</span> process<span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span>
<span class="token punctuation">]</span>

<span class="token comment"># While loop with walrus</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>line <span class="token operator">:=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    process_line<span class="token punctuation">(</span>line<span class="token punctuation">)</span>

<span class="token comment"># Complex example</span>
<span class="token keyword">def</span> <span class="token function">find_first_match</span><span class="token punctuation">(</span>items<span class="token punctuation">,</span> condition<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">next</span><span class="token punctuation">(</span>
        <span class="token punctuation">(</span>item <span class="token keyword">for</span> item <span class="token keyword">in</span> items <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">:=</span> condition<span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">and</span> result <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token boolean">None</span>
    <span class="token punctuation">)</span>
</code></pre>
<h3 id="3-f-strings-advanced-features">3. F-Strings Advanced Features</h3>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token comment"># Debugging with f-strings (Python 3.8+)</span>
name <span class="token operator">=</span> <span class="token string">"John"</span>
age <span class="token operator">=</span> <span class="token number">30</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token operator">=</span><span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{</span>age<span class="token operator">=</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>  <span class="token comment"># name='John', age=30</span>

<span class="token comment"># Formatting numbers</span>
price <span class="token operator">=</span> <span class="token number">1234.5678</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>price<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>     <span class="token comment"># 1234.57</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>price<span class="token punctuation">:</span><span class="token format-spec">,.2f</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>    <span class="token comment"># 1,234.57</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>price<span class="token punctuation">:</span><span class="token format-spec">>10.2f</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>  <span class="token comment"># Right-align, width 10</span>

<span class="token comment"># Date formatting</span>
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
now <span class="token operator">=</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>now<span class="token punctuation">:</span><span class="token operator">%</span>Y<span class="token operator">-</span><span class="token operator">%</span>m<span class="token operator">-</span><span class="token operator">%</span>d <span class="token operator">%</span>H<span class="token punctuation">:</span><span class="token operator">%</span>M<span class="token punctuation">:</span><span class="token format-spec">%S</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token comment"># Nested f-strings</span>
data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"Alice"</span><span class="token punctuation">,</span> <span class="token string">"score"</span><span class="token punctuation">:</span> <span class="token number">95</span><span class="token punctuation">}</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>data<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token format-spec">>10</span><span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>data<span class="token punctuation">[</span><span class="token string">'score'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token format-spec">.1f</span><span class="token punctuation">}</span></span><span class="token string">%"</span></span><span class="token punctuation">)</span>

<span class="token comment"># Multi-line f-strings</span>
message <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"""
User: </span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string">
Age: </span><span class="token interpolation"><span class="token punctuation">{</span>age<span class="token punctuation">}</span></span><span class="token string">
Status: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token string">'Active'</span> <span class="token keyword">if</span> age <span class="token operator">></span> <span class="token number">18</span> <span class="token keyword">else</span> <span class="token string">'Minor'</span><span class="token punctuation">}</span></span><span class="token string">
"""</span></span>
</code></pre>
<h3 id="4-data-classes-python-37">4. Data Classes (Python 3.7+)</h3>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token keyword">from</span> dataclasses <span class="token keyword">import</span> dataclass<span class="token punctuation">,</span> field
<span class="token keyword">from</span> typing <span class="token keyword">import</span> List
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime

<span class="token comment"># Basic dataclass</span>
<span class="token decorator annotation punctuation">@dataclass</span>
<span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">:</span>
    name<span class="token punctuation">:</span> <span class="token builtin">str</span>
    email<span class="token punctuation">:</span> <span class="token builtin">str</span>
    age<span class="token punctuation">:</span> <span class="token builtin">int</span>
    created_at<span class="token punctuation">:</span> datetime <span class="token operator">=</span> field<span class="token punctuation">(</span>default_factory<span class="token operator">=</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">)</span>
    
<span class="token comment"># Frozen (immutable) dataclass</span>
<span class="token decorator annotation punctuation">@dataclass</span><span class="token punctuation">(</span>frozen<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">Point</span><span class="token punctuation">:</span>
    x<span class="token punctuation">:</span> <span class="token builtin">float</span>
    y<span class="token punctuation">:</span> <span class="token builtin">float</span>
    
    <span class="token keyword">def</span> <span class="token function">distance_from_origin</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">float</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>x<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>y<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">0.5</span>

<span class="token comment"># Dataclass with complex defaults</span>
<span class="token decorator annotation punctuation">@dataclass</span>
<span class="token keyword">class</span> <span class="token class-name">ShoppingCart</span><span class="token punctuation">:</span>
    user_id<span class="token punctuation">:</span> <span class="token builtin">str</span>
    items<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span> <span class="token operator">=</span> field<span class="token punctuation">(</span>default_factory<span class="token operator">=</span><span class="token builtin">list</span><span class="token punctuation">)</span>
    total<span class="token punctuation">:</span> <span class="token builtin">float</span> <span class="token operator">=</span> <span class="token number">0.0</span>
    
    <span class="token keyword">def</span> <span class="token function">add_item</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> item<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> price<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>items<span class="token punctuation">.</span>append<span class="token punctuation">(</span>item<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>total <span class="token operator">+=</span> price

<span class="token comment"># Dataclass with post-init processing</span>
<span class="token decorator annotation punctuation">@dataclass</span>
<span class="token keyword">class</span> <span class="token class-name">Rectangle</span><span class="token punctuation">:</span>
    width<span class="token punctuation">:</span> <span class="token builtin">float</span>
    height<span class="token punctuation">:</span> <span class="token builtin">float</span>
    area<span class="token punctuation">:</span> <span class="token builtin">float</span> <span class="token operator">=</span> field<span class="token punctuation">(</span>init<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">__post_init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>area <span class="token operator">=</span> self<span class="token punctuation">.</span>width <span class="token operator">*</span> self<span class="token punctuation">.</span>height

<span class="token comment"># Advanced: Ordering and comparison</span>
<span class="token decorator annotation punctuation">@dataclass</span><span class="token punctuation">(</span>order<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">Product</span><span class="token punctuation">:</span>
    sort_index<span class="token punctuation">:</span> <span class="token builtin">float</span> <span class="token operator">=</span> field<span class="token punctuation">(</span>init<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token builtin">repr</span><span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    name<span class="token punctuation">:</span> <span class="token builtin">str</span>
    price<span class="token punctuation">:</span> <span class="token builtin">float</span>
    
    <span class="token keyword">def</span> <span class="token function">__post_init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>sort_index <span class="token operator">=</span> self<span class="token punctuation">.</span>price

products <span class="token operator">=</span> <span class="token punctuation">[</span>
    Product<span class="token punctuation">(</span><span class="token string">"Laptop"</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Product<span class="token punctuation">(</span><span class="token string">"Mouse"</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Product<span class="token punctuation">(</span><span class="token string">"Keyboard"</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
sorted_products <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>products<span class="token punctuation">)</span>  <span class="token comment"># Sorted by price</span>
</code></pre>
<h2 id="type-hints-and-mypy-type-hints">Type Hints and mypy {#type-hints}</h2>
<h3 id="1-basic-type-annotations">1. Basic Type Annotations</h3>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token keyword">from</span> typing <span class="token keyword">import</span> List<span class="token punctuation">,</span> Dict<span class="token punctuation">,</span> Tuple<span class="token punctuation">,</span> Set<span class="token punctuation">,</span> Optional<span class="token punctuation">,</span> Union<span class="token punctuation">,</span> Any

<span class="token comment"># Function annotations</span>
<span class="token keyword">def</span> <span class="token function">greet</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> age<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f"Hello </span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string">, you are </span><span class="token interpolation"><span class="token punctuation">{</span>age<span class="token punctuation">}</span></span><span class="token string"> years old"</span></span>

<span class="token comment"># Variable annotations</span>
count<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">0</span>
names<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Alice"</span><span class="token punctuation">,</span> <span class="token string">"Bob"</span><span class="token punctuation">]</span>
config<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> Any<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"timeout"</span><span class="token punctuation">:</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token string">"retry"</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">}</span>

<span class="token comment"># Optional types</span>
<span class="token keyword">def</span> <span class="token function">find_user</span><span class="token punctuation">(</span>user_id<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Optional<span class="token punctuation">[</span>User<span class="token punctuation">]</span><span class="token punctuation">:</span>
    <span class="token comment"># Returns User or None</span>
    <span class="token keyword">return</span> database<span class="token punctuation">.</span>get<span class="token punctuation">(</span>user_id<span class="token punctuation">)</span>

<span class="token comment"># Union types</span>
<span class="token keyword">def</span> <span class="token function">process_id</span><span class="token punctuation">(</span>id_value<span class="token punctuation">:</span> Union<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">str</span><span class="token punctuation">(</span>id_value<span class="token punctuation">)</span>

<span class="token comment"># Multiple return types</span>
<span class="token keyword">def</span> <span class="token function">parse_value</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Union<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">float</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
    <span class="token keyword">except</span> ValueError<span class="token punctuation">:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token builtin">float</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
        <span class="token keyword">except</span> ValueError<span class="token punctuation">:</span>
            <span class="token keyword">return</span> s
</code></pre>
<h3 id="2-generic-types">2. Generic Types</h3>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token keyword">from</span> typing <span class="token keyword">import</span> TypeVar<span class="token punctuation">,</span> Generic<span class="token punctuation">,</span> List<span class="token punctuation">,</span> Dict

<span class="token comment"># Type variables</span>
T <span class="token operator">=</span> TypeVar<span class="token punctuation">(</span><span class="token string">'T'</span><span class="token punctuation">)</span>
K <span class="token operator">=</span> TypeVar<span class="token punctuation">(</span><span class="token string">'K'</span><span class="token punctuation">)</span>
V <span class="token operator">=</span> TypeVar<span class="token punctuation">(</span><span class="token string">'V'</span><span class="token punctuation">)</span>

<span class="token comment"># Generic function</span>
<span class="token keyword">def</span> <span class="token function">first</span><span class="token punctuation">(</span>items<span class="token punctuation">:</span> List<span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Optional<span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> items<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">if</span> items <span class="token keyword">else</span> <span class="token boolean">None</span>

<span class="token comment"># Generic class</span>
<span class="token keyword">class</span> <span class="token class-name">Container</span><span class="token punctuation">(</span>Generic<span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>_items<span class="token punctuation">:</span> List<span class="token punctuation">[</span>T<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    
    <span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> item<span class="token punctuation">:</span> T<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>_items<span class="token punctuation">.</span>append<span class="token punctuation">(</span>item<span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> index<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> T<span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_items<span class="token punctuation">[</span>index<span class="token punctuation">]</span>
    
    <span class="token keyword">def</span> <span class="token function">all</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> List<span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_items<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Usage</span>
numbers<span class="token punctuation">:</span> Container<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span> <span class="token operator">=</span> Container<span class="token punctuation">(</span><span class="token punctuation">)</span>
numbers<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
numbers<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

strings<span class="token punctuation">:</span> Container<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span> <span class="token operator">=</span> Container<span class="token punctuation">(</span><span class="token punctuation">)</span>
strings<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span>

<span class="token comment"># Generic with constraints</span>
<span class="token keyword">from</span> typing <span class="token keyword">import</span> Protocol

<span class="token keyword">class</span> <span class="token class-name">Comparable</span><span class="token punctuation">(</span>Protocol<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__lt__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">:</span> Any<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">bool</span><span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

T_comparable <span class="token operator">=</span> TypeVar<span class="token punctuation">(</span><span class="token string">'T_comparable'</span><span class="token punctuation">,</span> bound<span class="token operator">=</span>Comparable<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">find_min</span><span class="token punctuation">(</span>items<span class="token punctuation">:</span> List<span class="token punctuation">[</span>T_comparable<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> T_comparable<span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">min</span><span class="token punctuation">(</span>items<span class="token punctuation">)</span>

<span class="token comment"># Generic repository pattern</span>
<span class="token keyword">class</span> <span class="token class-name">Repository</span><span class="token punctuation">(</span>Generic<span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>_storage<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> T<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">save</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> item<span class="token punctuation">:</span> T<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>_storage<span class="token punctuation">[</span><span class="token builtin">id</span><span class="token punctuation">]</span> <span class="token operator">=</span> item
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">find_by_id</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Optional<span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_storage<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">find_all</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> List<span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">list</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>_storage<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@dataclass</span>
<span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">:</span>
    <span class="token builtin">id</span><span class="token punctuation">:</span> <span class="token builtin">str</span>
    name<span class="token punctuation">:</span> <span class="token builtin">str</span>
    email<span class="token punctuation">:</span> <span class="token builtin">str</span>

user_repo<span class="token punctuation">:</span> Repository<span class="token punctuation">[</span>User<span class="token punctuation">]</span> <span class="token operator">=</span> Repository<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<h3 id="3-protocol-types-structural-subtyping">3. Protocol Types (Structural Subtyping)</h3>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token keyword">from</span> typing <span class="token keyword">import</span> Protocol<span class="token punctuation">,</span> runtime_checkable

<span class="token comment"># Define protocol</span>
<span class="token decorator annotation punctuation">@runtime_checkable</span>
<span class="token keyword">class</span> <span class="token class-name">Drawable</span><span class="token punctuation">(</span>Protocol<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">draw</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

<span class="token keyword">class</span> <span class="token class-name">Circle</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">draw</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Drawing circle"</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">Square</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">draw</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Drawing square"</span><span class="token punctuation">)</span>

<span class="token comment"># Works with any class that implements draw()</span>
<span class="token keyword">def</span> <span class="token function">render</span><span class="token punctuation">(</span>shape<span class="token punctuation">:</span> Drawable<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    shape<span class="token punctuation">.</span>draw<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Both work without inheritance</span>
render<span class="token punctuation">(</span>Circle<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
render<span class="token punctuation">(</span>Square<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Complex protocol example</span>
<span class="token keyword">class</span> <span class="token class-name">SupportsClose</span><span class="token punctuation">(</span>Protocol<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">close</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

<span class="token keyword">class</span> <span class="token class-name">SupportsRead</span><span class="token punctuation">(</span>Protocol<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">read</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> n<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">bytes</span><span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

<span class="token keyword">class</span> <span class="token class-name">Reader</span><span class="token punctuation">(</span>SupportsClose<span class="token punctuation">,</span> SupportsRead<span class="token punctuation">,</span> Protocol<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Anything that can be read and closed"""</span>
    <span class="token keyword">pass</span>

<span class="token keyword">def</span> <span class="token function">process_file</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">:</span> Reader<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        data <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> data
    <span class="token keyword">finally</span><span class="token punctuation">:</span>
        <span class="token builtin">file</span><span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<h3 id="4-advanced-type-hints">4. Advanced Type Hints</h3>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token keyword">from</span> typing <span class="token keyword">import</span> <span class="token punctuation">(</span>
    Callable<span class="token punctuation">,</span> Literal<span class="token punctuation">,</span> TypedDict<span class="token punctuation">,</span> Final<span class="token punctuation">,</span>
    Annotated<span class="token punctuation">,</span> overload<span class="token punctuation">,</span> cast
<span class="token punctuation">)</span>

<span class="token comment"># Callable types</span>
<span class="token keyword">def</span> <span class="token function">execute</span><span class="token punctuation">(</span>callback<span class="token punctuation">:</span> Callable<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">bool</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> callback<span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">,</span> <span class="token string">"test"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>

<span class="token comment"># Literal types for strict values</span>
Mode <span class="token operator">=</span> Literal<span class="token punctuation">[</span><span class="token string">"read"</span><span class="token punctuation">,</span> <span class="token string">"write"</span><span class="token punctuation">,</span> <span class="token string">"append"</span><span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">open_file</span><span class="token punctuation">(</span>path<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> mode<span class="token punctuation">:</span> Mode<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    <span class="token comment"># mode can only be "read", "write", or "append"</span>
    <span class="token keyword">pass</span>

<span class="token comment"># TypedDict for structured dictionaries</span>
<span class="token keyword">class</span> <span class="token class-name">UserDict</span><span class="token punctuation">(</span>TypedDict<span class="token punctuation">)</span><span class="token punctuation">:</span>
    name<span class="token punctuation">:</span> <span class="token builtin">str</span>
    age<span class="token punctuation">:</span> <span class="token builtin">int</span>
    email<span class="token punctuation">:</span> <span class="token builtin">str</span>

<span class="token keyword">def</span> <span class="token function">create_user</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> UserDict<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> User<span class="token punctuation">:</span>
    <span class="token keyword">return</span> User<span class="token punctuation">(</span><span class="token operator">**</span>data<span class="token punctuation">)</span>

<span class="token comment"># Final for constants</span>
MAX_CONNECTIONS<span class="token punctuation">:</span> Final <span class="token operator">=</span> <span class="token number">100</span>

<span class="token comment"># Annotated for metadata</span>
<span class="token keyword">from</span> typing <span class="token keyword">import</span> Annotated

UserId <span class="token operator">=</span> Annotated<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token string">"Unique user identifier"</span><span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">get_user</span><span class="token punctuation">(</span>user_id<span class="token punctuation">:</span> UserId<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> User<span class="token punctuation">:</span>
    <span class="token keyword">pass</span>

<span class="token comment"># Function overloading</span>
<span class="token decorator annotation punctuation">@overload</span>
<span class="token keyword">def</span> <span class="token function">process</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">int</span><span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

<span class="token decorator annotation punctuation">@overload</span>
<span class="token keyword">def</span> <span class="token function">process</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

<span class="token keyword">def</span> <span class="token function">process</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> Union<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Union<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> data <span class="token operator">*</span> <span class="token number">2</span>
    <span class="token keyword">return</span> data<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Type casting</span>
<span class="token keyword">def</span> <span class="token function">get_value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Any<span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">"hello"</span>

value <span class="token operator">=</span> cast<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">,</span> get_value<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># Tell mypy it's a str</span>
</code></pre>
<h2 id="advanced-oop-patterns-oop-patterns">Advanced OOP Patterns {#oop-patterns}</h2>
<h3 id="1-abstract-base-classes">1. Abstract Base Classes</h3>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token keyword">from</span> abc <span class="token keyword">import</span> ABC<span class="token punctuation">,</span> abstractmethod
<span class="token keyword">from</span> typing <span class="token keyword">import</span> List

<span class="token comment"># Define abstract interface</span>
<span class="token keyword">class</span> <span class="token class-name">Repository</span><span class="token punctuation">(</span>ABC<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token decorator annotation punctuation">@abstractmethod</span>
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">save</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> entity<span class="token punctuation">:</span> Any<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""Save entity to storage"""</span>
        <span class="token keyword">pass</span>
    
    <span class="token decorator annotation punctuation">@abstractmethod</span>
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">find_by_id</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Optional<span class="token punctuation">[</span>Any<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""Find entity by ID"""</span>
        <span class="token keyword">pass</span>
    
    <span class="token decorator annotation punctuation">@abstractmethod</span>
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">find_all</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> List<span class="token punctuation">[</span>Any<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""Get all entities"""</span>
        <span class="token keyword">pass</span>

<span class="token comment"># Concrete implementation</span>
<span class="token keyword">class</span> <span class="token class-name">UserRepository</span><span class="token punctuation">(</span>Repository<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>_storage<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> User<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">save</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> user<span class="token punctuation">:</span> User<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>_storage<span class="token punctuation">[</span>user<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">]</span> <span class="token operator">=</span> user
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">find_by_id</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Optional<span class="token punctuation">[</span>User<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_storage<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">find_all</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> List<span class="token punctuation">[</span>User<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">list</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>_storage<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Abstract property</span>
<span class="token keyword">class</span> <span class="token class-name">Shape</span><span class="token punctuation">(</span>ABC<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token decorator annotation punctuation">@property</span>
    <span class="token decorator annotation punctuation">@abstractmethod</span>
    <span class="token keyword">def</span> <span class="token function">area</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">float</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>
    
    <span class="token decorator annotation punctuation">@property</span>
    <span class="token decorator annotation punctuation">@abstractmethod</span>
    <span class="token keyword">def</span> <span class="token function">perimeter</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">float</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

<span class="token keyword">class</span> <span class="token class-name">Circle</span><span class="token punctuation">(</span>Shape<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> radius<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>radius <span class="token operator">=</span> radius
    
    <span class="token decorator annotation punctuation">@property</span>
    <span class="token keyword">def</span> <span class="token function">area</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">float</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">3.14159</span> <span class="token operator">*</span> self<span class="token punctuation">.</span>radius <span class="token operator">**</span> <span class="token number">2</span>
    
    <span class="token decorator annotation punctuation">@property</span>
    <span class="token keyword">def</span> <span class="token function">perimeter</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">float</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token number">3.14159</span> <span class="token operator">*</span> self<span class="token punctuation">.</span>radius
</code></pre>
<h3 id="2-descriptors-and-properties">2. Descriptors and Properties</h3>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token comment"># Descriptor protocol</span>
<span class="token keyword">class</span> <span class="token class-name">Validator</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> min_value<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">,</span> max_value<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>min_value <span class="token operator">=</span> min_value
        self<span class="token punctuation">.</span>max_value <span class="token operator">=</span> max_value
    
    <span class="token keyword">def</span> <span class="token function">__set_name__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> owner<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"_</span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string">"</span></span>
    
    <span class="token keyword">def</span> <span class="token function">__get__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> instance<span class="token punctuation">,</span> owner<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> instance <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> self
        <span class="token keyword">return</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>instance<span class="token punctuation">,</span> self<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">__set__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> instance<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>min_value <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">and</span> value <span class="token operator">&#x3C;</span> self<span class="token punctuation">.</span>min_value<span class="token punctuation">:</span>
            <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span><span class="token string"> must be >= </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>min_value<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>max_value <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">and</span> value <span class="token operator">></span> self<span class="token punctuation">.</span>max_value<span class="token punctuation">:</span>
            <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span><span class="token string"> must be &#x3C;= </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>max_value<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token builtin">setattr</span><span class="token punctuation">(</span>instance<span class="token punctuation">,</span> self<span class="token punctuation">.</span>name<span class="token punctuation">,</span> value<span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">:</span>
    age <span class="token operator">=</span> Validator<span class="token punctuation">(</span>min_value<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> max_value<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> age<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>age <span class="token operator">=</span> age

<span class="token comment"># Property with getter, setter, deleter</span>
<span class="token keyword">class</span> <span class="token class-name">Temperature</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> celsius<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>_celsius <span class="token operator">=</span> celsius
    
    <span class="token decorator annotation punctuation">@property</span>
    <span class="token keyword">def</span> <span class="token function">celsius</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">float</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_celsius
    
    <span class="token decorator annotation punctuation">@celsius<span class="token punctuation">.</span>setter</span>
    <span class="token keyword">def</span> <span class="token function">celsius</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> value <span class="token operator">&#x3C;</span> <span class="token operator">-</span><span class="token number">273.15</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">"Temperature below absolute zero"</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>_celsius <span class="token operator">=</span> value
    
    <span class="token decorator annotation punctuation">@property</span>
    <span class="token keyword">def</span> <span class="token function">fahrenheit</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">float</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_celsius <span class="token operator">*</span> <span class="token number">9</span><span class="token operator">/</span><span class="token number">5</span> <span class="token operator">+</span> <span class="token number">32</span>
    
    <span class="token decorator annotation punctuation">@fahrenheit<span class="token punctuation">.</span>setter</span>
    <span class="token keyword">def</span> <span class="token function">fahrenheit</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>celsius <span class="token operator">=</span> <span class="token punctuation">(</span>value <span class="token operator">-</span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">5</span><span class="token operator">/</span><span class="token number">9</span>

<span class="token comment"># Cached property</span>
<span class="token keyword">from</span> functools <span class="token keyword">import</span> cached_property

<span class="token keyword">class</span> <span class="token class-name">DataProcessor</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>_data <span class="token operator">=</span> data
    
    <span class="token decorator annotation punctuation">@cached_property</span>
    <span class="token keyword">def</span> <span class="token function">statistics</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token builtin">float</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token comment"># Computed once, then cached</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token string">"mean"</span><span class="token punctuation">:</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>_data<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>_data<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">"min"</span><span class="token punctuation">:</span> <span class="token builtin">min</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>_data<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">"max"</span><span class="token punctuation">:</span> <span class="token builtin">max</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>_data<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
</code></pre>
<h3 id="3-mixins">3. Mixins</h3>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token comment"># Mixin classes for composition</span>
<span class="token keyword">class</span> <span class="token class-name">JSONMixin</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">to_json</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token keyword">import</span> json
        <span class="token keyword">return</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>self<span class="token punctuation">.</span>__dict__<span class="token punctuation">)</span>
    
    <span class="token decorator annotation punctuation">@classmethod</span>
    <span class="token keyword">def</span> <span class="token function">from_json</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> json_str<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">import</span> json
        data <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>json_str<span class="token punctuation">)</span>
        <span class="token keyword">return</span> cls<span class="token punctuation">(</span><span class="token operator">**</span>data<span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">TimestampMixin</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>created_at <span class="token operator">=</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>updated_at <span class="token operator">=</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">touch</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>updated_at <span class="token operator">=</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">ReprMixin</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__repr__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        attrs <span class="token operator">=</span> <span class="token string">", "</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>
            <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>k<span class="token punctuation">}</span></span><span class="token string">=</span><span class="token interpolation"><span class="token punctuation">{</span>v<span class="token conversion-option punctuation">!r</span><span class="token punctuation">}</span></span><span class="token string">"</span></span>
            <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> self<span class="token punctuation">.</span>__dict__<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token keyword">not</span> k<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">"_"</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__name__<span class="token punctuation">}</span></span><span class="token string">(</span><span class="token interpolation"><span class="token punctuation">{</span>attrs<span class="token punctuation">}</span></span><span class="token string">)"</span></span>

<span class="token comment"># Combine mixins</span>
<span class="token decorator annotation punctuation">@dataclass</span>
<span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">(</span>JSONMixin<span class="token punctuation">,</span> TimestampMixin<span class="token punctuation">,</span> ReprMixin<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">id</span><span class="token punctuation">:</span> <span class="token builtin">str</span>
    name<span class="token punctuation">:</span> <span class="token builtin">str</span>
    email<span class="token punctuation">:</span> <span class="token builtin">str</span>

user <span class="token operator">=</span> User<span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token string">"John"</span><span class="token punctuation">,</span> <span class="token string">"john@example.com"</span><span class="token punctuation">)</span>
json_str <span class="token operator">=</span> user<span class="token punctuation">.</span>to_json<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">repr</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<h2 id="functional-programming-functional">Functional Programming {#functional}</h2>
<h3 id="1-higher-order-functions">1. Higher-Order Functions</h3>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token keyword">from</span> typing <span class="token keyword">import</span> Callable<span class="token punctuation">,</span> Iterable<span class="token punctuation">,</span> TypeVar

T <span class="token operator">=</span> TypeVar<span class="token punctuation">(</span><span class="token string">'T'</span><span class="token punctuation">)</span>
U <span class="token operator">=</span> TypeVar<span class="token punctuation">(</span><span class="token string">'U'</span><span class="token punctuation">)</span>

<span class="token comment"># Map, filter, reduce</span>
<span class="token keyword">def</span> <span class="token function">map_values</span><span class="token punctuation">(</span>fn<span class="token punctuation">:</span> Callable<span class="token punctuation">[</span><span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">,</span> U<span class="token punctuation">]</span><span class="token punctuation">,</span> items<span class="token punctuation">:</span> Iterable<span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> List<span class="token punctuation">[</span>U<span class="token punctuation">]</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span>fn<span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token keyword">for</span> item <span class="token keyword">in</span> items<span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">filter_values</span><span class="token punctuation">(</span>predicate<span class="token punctuation">:</span> Callable<span class="token punctuation">[</span><span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">bool</span><span class="token punctuation">]</span><span class="token punctuation">,</span> items<span class="token punctuation">:</span> Iterable<span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> List<span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span>item <span class="token keyword">for</span> item <span class="token keyword">in</span> items <span class="token keyword">if</span> predicate<span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token keyword">from</span> functools <span class="token keyword">import</span> <span class="token builtin">reduce</span>

<span class="token keyword">def</span> <span class="token function">sum_values</span><span class="token punctuation">(</span>items<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">int</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">reduce</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> acc<span class="token punctuation">,</span> x<span class="token punctuation">:</span> acc <span class="token operator">+</span> x<span class="token punctuation">,</span> items<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>

<span class="token comment"># Compose functions</span>
<span class="token keyword">def</span> <span class="token function">compose</span><span class="token punctuation">(</span><span class="token operator">*</span>functions<span class="token punctuation">:</span> Callable<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Callable<span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">inner</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">:</span>
        result <span class="token operator">=</span> arg
        <span class="token keyword">for</span> fn <span class="token keyword">in</span> <span class="token builtin">reversed</span><span class="token punctuation">(</span>functions<span class="token punctuation">)</span><span class="token punctuation">:</span>
            result <span class="token operator">=</span> fn<span class="token punctuation">(</span>result<span class="token punctuation">)</span>
        <span class="token keyword">return</span> result
    <span class="token keyword">return</span> inner

<span class="token keyword">def</span> <span class="token function">add_one</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">int</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> <span class="token number">1</span>

<span class="token keyword">def</span> <span class="token function">double</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">int</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x <span class="token operator">*</span> <span class="token number">2</span>

<span class="token keyword">def</span> <span class="token function">square</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">int</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x <span class="token operator">**</span> <span class="token number">2</span>

<span class="token comment"># Compose: square(double(add_one(x)))</span>
process <span class="token operator">=</span> compose<span class="token punctuation">(</span>square<span class="token punctuation">,</span> double<span class="token punctuation">,</span> add_one<span class="token punctuation">)</span>
result <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>  <span class="token comment"># ((5 + 1) * 2) ** 2 = 144</span>

<span class="token comment"># Partial application</span>
<span class="token keyword">from</span> functools <span class="token keyword">import</span> partial

<span class="token keyword">def</span> <span class="token function">power</span><span class="token punctuation">(</span>base<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">,</span> exponent<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">float</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> base <span class="token operator">**</span> exponent

square <span class="token operator">=</span> partial<span class="token punctuation">(</span>power<span class="token punctuation">,</span> exponent<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
cube <span class="token operator">=</span> partial<span class="token punctuation">(</span>power<span class="token punctuation">,</span> exponent<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>square<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 25</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>cube<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># 125</span>
</code></pre>
<h3 id="2-closures-and-currying">2. Closures and Currying</h3>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token comment"># Closure example</span>
<span class="token keyword">def</span> <span class="token function">make_multiplier</span><span class="token punctuation">(</span>factor<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Callable<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">multiply</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">int</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> x <span class="token operator">*</span> factor
    <span class="token keyword">return</span> multiply

double <span class="token operator">=</span> make_multiplier<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
triple <span class="token operator">=</span> make_multiplier<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>double<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 10</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>triple<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 15</span>

<span class="token comment"># Counter with closure</span>
<span class="token keyword">def</span> <span class="token function">make_counter</span><span class="token punctuation">(</span>start<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Callable<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    count <span class="token operator">=</span> start
    
    <span class="token keyword">def</span> <span class="token function">counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">int</span><span class="token punctuation">:</span>
        <span class="token keyword">nonlocal</span> count
        count <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">return</span> count
    
    <span class="token keyword">return</span> counter

counter1 <span class="token operator">=</span> make_counter<span class="token punctuation">(</span><span class="token punctuation">)</span>
counter2 <span class="token operator">=</span> make_counter<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>counter1<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>counter1<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 2</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>counter2<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 101</span>

<span class="token comment"># Currying</span>
<span class="token keyword">def</span> <span class="token function">curry</span><span class="token punctuation">(</span>fn<span class="token punctuation">:</span> Callable<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Callable<span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">curried</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span> <span class="token operator">>=</span> fn<span class="token punctuation">.</span>__code__<span class="token punctuation">.</span>co_argcount<span class="token punctuation">:</span>
            <span class="token keyword">return</span> fn<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token keyword">lambda</span> <span class="token operator">*</span>more_args<span class="token punctuation">:</span> curried<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>args <span class="token operator">+</span> more_args<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> curried

<span class="token decorator annotation punctuation">@curry</span>
<span class="token keyword">def</span> <span class="token function">add_three</span><span class="token punctuation">(</span>a<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> b<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> c<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">int</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> a <span class="token operator">+</span> b <span class="token operator">+</span> c

<span class="token keyword">print</span><span class="token punctuation">(</span>add_three<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>     <span class="token comment"># 6</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>add_three<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>     <span class="token comment"># 6</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>add_three<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>     <span class="token comment"># 6</span>

<span class="token comment"># Memoization</span>
<span class="token keyword">from</span> functools <span class="token keyword">import</span> lru_cache

<span class="token decorator annotation punctuation">@lru_cache</span><span class="token punctuation">(</span>maxsize<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">fibonacci</span><span class="token punctuation">(</span>n<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">int</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> n <span class="token operator">&#x3C;</span> <span class="token number">2</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> n
    <span class="token keyword">return</span> fibonacci<span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> fibonacci<span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># Custom memoization</span>
<span class="token keyword">def</span> <span class="token function">memoize</span><span class="token punctuation">(</span>fn<span class="token punctuation">:</span> Callable<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Callable<span class="token punctuation">:</span>
    cache <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    
    <span class="token keyword">def</span> <span class="token function">memoized</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> args <span class="token keyword">not</span> <span class="token keyword">in</span> cache<span class="token punctuation">:</span>
            cache<span class="token punctuation">[</span>args<span class="token punctuation">]</span> <span class="token operator">=</span> fn<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">)</span>
        <span class="token keyword">return</span> cache<span class="token punctuation">[</span>args<span class="token punctuation">]</span>
    
    <span class="token keyword">return</span> memoized

<span class="token decorator annotation punctuation">@memoize</span>
<span class="token keyword">def</span> <span class="token function">expensive_computation</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">int</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Computing </span><span class="token interpolation"><span class="token punctuation">{</span>x<span class="token punctuation">}</span></span><span class="token string"> + </span><span class="token interpolation"><span class="token punctuation">{</span>y<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y

<span class="token keyword">print</span><span class="token punctuation">(</span>expensive_computation<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># Computes</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>expensive_computation<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># Uses cache</span>
</code></pre>
<h3 id="3-itertools-and-generators">3. Itertools and Generators</h3>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token keyword">from</span> itertools <span class="token keyword">import</span> <span class="token punctuation">(</span>
    chain<span class="token punctuation">,</span> combinations<span class="token punctuation">,</span> permutations<span class="token punctuation">,</span>
    product<span class="token punctuation">,</span> groupby<span class="token punctuation">,</span> islice<span class="token punctuation">,</span> cycle
<span class="token punctuation">)</span>

<span class="token comment"># Chain iterables</span>
list1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
list2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span>
chained <span class="token operator">=</span> chain<span class="token punctuation">(</span>list1<span class="token punctuation">,</span> list2<span class="token punctuation">)</span>  <span class="token comment"># [1, 2, 3, 4, 5, 6]</span>

<span class="token comment"># Combinations and permutations</span>
items <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
combos <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>combinations<span class="token punctuation">(</span>items<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>     <span class="token comment"># [(1,2), (1,3), (2,3)]</span>
perms <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>permutations<span class="token punctuation">(</span>items<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>      <span class="token comment"># [(1,2), (1,3), (2,1), (2,3), (3,1), (3,2)]</span>

<span class="token comment"># Cartesian product</span>
colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token string">'blue'</span><span class="token punctuation">]</span>
sizes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'S'</span><span class="token punctuation">,</span> <span class="token string">'M'</span><span class="token punctuation">,</span> <span class="token string">'L'</span><span class="token punctuation">]</span>
products <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>product<span class="token punctuation">(</span>colors<span class="token punctuation">,</span> sizes<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># [('red','S'), ('red','M'), ('red','L'), ('blue','S'), ('blue','M'), ('blue','L')]</span>

<span class="token comment"># Group by</span>
data <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span><span class="token string">'category'</span><span class="token punctuation">:</span> <span class="token string">'fruit'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'apple'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">'category'</span><span class="token punctuation">:</span> <span class="token string">'fruit'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'banana'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">'category'</span><span class="token punctuation">:</span> <span class="token string">'vegetable'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'carrot'</span><span class="token punctuation">}</span>
<span class="token punctuation">]</span>

sorted_data <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token string">'category'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> category<span class="token punctuation">,</span> items <span class="token keyword">in</span> groupby<span class="token punctuation">(</span>sorted_data<span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token string">'category'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>category<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">list</span><span class="token punctuation">(</span>items<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token comment"># Generator functions</span>
<span class="token keyword">def</span> <span class="token function">fibonacci_gen</span><span class="token punctuation">(</span>n<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    a<span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span>
    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">yield</span> a
        a<span class="token punctuation">,</span> b <span class="token operator">=</span> b<span class="token punctuation">,</span> a <span class="token operator">+</span> b

<span class="token comment"># Generator expression</span>
squares <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token operator">**</span><span class="token number">2</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Infinite generator</span>
<span class="token keyword">def</span> <span class="token function">infinite_counter</span><span class="token punctuation">(</span>start<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        <span class="token keyword">yield</span> start
        start <span class="token operator">+=</span> <span class="token number">1</span>

<span class="token comment"># Take first 10 from infinite sequence</span>
counter <span class="token operator">=</span> infinite_counter<span class="token punctuation">(</span><span class="token punctuation">)</span>
first_ten <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>islice<span class="token punctuation">(</span>counter<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Pipeline with generators</span>
<span class="token keyword">def</span> <span class="token function">read_file</span><span class="token punctuation">(</span>filename<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        <span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>
            <span class="token keyword">yield</span> line<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">filter_comments</span><span class="token punctuation">(</span>lines<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> line <span class="token keyword">in</span> lines<span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> line<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'#'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">yield</span> line

<span class="token keyword">def</span> <span class="token function">parse_line</span><span class="token punctuation">(</span>lines<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> line <span class="token keyword">in</span> lines<span class="token punctuation">:</span>
        parts <span class="token operator">=</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span>
        <span class="token keyword">yield</span> <span class="token punctuation">{</span><span class="token string">'name'</span><span class="token punctuation">:</span> parts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">:</span> parts<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">}</span>

<span class="token comment"># Chain generators</span>
pipeline <span class="token operator">=</span> parse_line<span class="token punctuation">(</span>filter_comments<span class="token punctuation">(</span>read_file<span class="token punctuation">(</span><span class="token string">'data.csv'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> item <span class="token keyword">in</span> pipeline<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
</code></pre>
<h2 id="context-managers-context-managers">Context Managers {#context-managers}</h2>
<h3 id="1-basic-context-managers">1. Basic Context Managers</h3>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token keyword">from</span> contextlib <span class="token keyword">import</span> contextmanager
<span class="token keyword">from</span> typing <span class="token keyword">import</span> Generator

<span class="token comment"># Class-based context manager</span>
<span class="token keyword">class</span> <span class="token class-name">FileManager</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> filename<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> mode<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>filename <span class="token operator">=</span> filename
        self<span class="token punctuation">.</span>mode <span class="token operator">=</span> mode
        self<span class="token punctuation">.</span><span class="token builtin">file</span> <span class="token operator">=</span> <span class="token boolean">None</span>
    
    <span class="token keyword">def</span> <span class="token function">__enter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span><span class="token builtin">file</span> <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>filename<span class="token punctuation">,</span> self<span class="token punctuation">.</span>mode<span class="token punctuation">)</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span><span class="token builtin">file</span>
    
    <span class="token keyword">def</span> <span class="token function">__exit__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> exc_type<span class="token punctuation">,</span> exc_val<span class="token punctuation">,</span> exc_tb<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span><span class="token builtin">file</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span><span class="token builtin">file</span><span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># Return False to propagate exceptions</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span>

<span class="token comment"># Usage</span>
<span class="token keyword">with</span> FileManager<span class="token punctuation">(</span><span class="token string">'data.txt'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'Hello, World!'</span><span class="token punctuation">)</span>

<span class="token comment"># Function-based context manager</span>
<span class="token decorator annotation punctuation">@contextmanager</span>
<span class="token keyword">def</span> <span class="token function">file_manager</span><span class="token punctuation">(</span>filename<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> mode<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Generator<span class="token punctuation">:</span>
    <span class="token builtin">file</span> <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> mode<span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">yield</span> <span class="token builtin">file</span>
    <span class="token keyword">finally</span><span class="token punctuation">:</span>
        <span class="token builtin">file</span><span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">with</span> file_manager<span class="token punctuation">(</span><span class="token string">'data.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    content <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<h3 id="2-advanced-context-managers">2. Advanced Context Managers</h3>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token keyword">import</span> time
<span class="token keyword">from</span> contextlib <span class="token keyword">import</span> contextmanager

<span class="token comment"># Timer context manager</span>
<span class="token decorator annotation punctuation">@contextmanager</span>
<span class="token keyword">def</span> <span class="token function">timer</span><span class="token punctuation">(</span>operation<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">yield</span>
    <span class="token keyword">finally</span><span class="token punctuation">:</span>
        end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>operation<span class="token punctuation">}</span></span><span class="token string"> took </span><span class="token interpolation"><span class="token punctuation">{</span>end <span class="token operator">-</span> start<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string"> seconds"</span></span><span class="token punctuation">)</span>

<span class="token keyword">with</span> timer<span class="token punctuation">(</span><span class="token string">"Database query"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># Expensive operation</span>
    result <span class="token operator">=</span> expensive_query<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Database transaction context manager</span>
<span class="token decorator annotation punctuation">@contextmanager</span>
<span class="token keyword">def</span> <span class="token function">transaction</span><span class="token punctuation">(</span>connection<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">yield</span> connection
        connection<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
        connection<span class="token punctuation">.</span>rollback<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">raise</span>

<span class="token keyword">with</span> transaction<span class="token punctuation">(</span>db_connection<span class="token punctuation">)</span> <span class="token keyword">as</span> conn<span class="token punctuation">:</span>
    conn<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">"INSERT INTO users VALUES (...)"</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">"UPDATE accounts SET balance = ..."</span><span class="token punctuation">)</span>

<span class="token comment"># Temporary directory context manager</span>
<span class="token keyword">import</span> tempfile
<span class="token keyword">import</span> shutil

<span class="token decorator annotation punctuation">@contextmanager</span>
<span class="token keyword">def</span> <span class="token function">temporary_directory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    temp_dir <span class="token operator">=</span> tempfile<span class="token punctuation">.</span>mkdtemp<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">yield</span> temp_dir
    <span class="token keyword">finally</span><span class="token punctuation">:</span>
        shutil<span class="token punctuation">.</span>rmtree<span class="token punctuation">(</span>temp_dir<span class="token punctuation">)</span>

<span class="token keyword">with</span> temporary_directory<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> temp_dir<span class="token punctuation">:</span>
    <span class="token comment"># Work with temporary files</span>
    file_path <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>temp_dir<span class="token punctuation">}</span></span><span class="token string">/temp.txt"</span></span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"Temporary data"</span><span class="token punctuation">)</span>
<span class="token comment"># Directory is automatically deleted</span>

<span class="token comment"># Multiple context managers</span>
<span class="token keyword">with</span> <span class="token punctuation">(</span>
    <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'input.txt'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> infile<span class="token punctuation">,</span>
    <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'output.txt'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> outfile<span class="token punctuation">,</span>
    timer<span class="token punctuation">(</span><span class="token string">"File processing"</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> line <span class="token keyword">in</span> infile<span class="token punctuation">:</span>
        outfile<span class="token punctuation">.</span>write<span class="token punctuation">(</span>line<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<h3 id="3-async-context-managers">3. Async Context Managers</h3>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token keyword">from</span> contextlib <span class="token keyword">import</span> asynccontextmanager
<span class="token keyword">import</span> asyncio

<span class="token comment"># Async context manager class</span>
<span class="token keyword">class</span> <span class="token class-name">AsyncDatabaseConnection</span><span class="token punctuation">:</span>
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">__aenter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>connection <span class="token operator">=</span> <span class="token keyword">await</span> connect_to_database<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>connection
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">__aexit__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> exc_type<span class="token punctuation">,</span> exc_val<span class="token punctuation">,</span> exc_tb<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">await</span> self<span class="token punctuation">.</span>connection<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span>

<span class="token keyword">async</span> <span class="token keyword">with</span> AsyncDatabaseConnection<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> conn<span class="token punctuation">:</span>
    result <span class="token operator">=</span> <span class="token keyword">await</span> conn<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">"SELECT * FROM users"</span><span class="token punctuation">)</span>

<span class="token comment"># Async context manager function</span>
<span class="token decorator annotation punctuation">@asynccontextmanager</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">async_timer</span><span class="token punctuation">(</span>operation<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">yield</span>
    <span class="token keyword">finally</span><span class="token punctuation">:</span>
        end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>operation<span class="token punctuation">}</span></span><span class="token string"> took </span><span class="token interpolation"><span class="token punctuation">{</span>end <span class="token operator">-</span> start<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string"> seconds"</span></span><span class="token punctuation">)</span>

<span class="token keyword">async</span> <span class="token keyword">with</span> async_timer<span class="token punctuation">(</span><span class="token string">"API call"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> <span class="token keyword">await</span> fetch_data<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Async resource pool</span>
<span class="token decorator annotation punctuation">@asynccontextmanager</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">get_connection</span><span class="token punctuation">(</span>pool<span class="token punctuation">)</span><span class="token punctuation">:</span>
    connection <span class="token operator">=</span> <span class="token keyword">await</span> pool<span class="token punctuation">.</span>acquire<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">yield</span> connection
    <span class="token keyword">finally</span><span class="token punctuation">:</span>
        <span class="token keyword">await</span> pool<span class="token punctuation">.</span>release<span class="token punctuation">(</span>connection<span class="token punctuation">)</span>

<span class="token keyword">async</span> <span class="token keyword">with</span> get_connection<span class="token punctuation">(</span>db_pool<span class="token punctuation">)</span> <span class="token keyword">as</span> conn<span class="token punctuation">:</span>
    data <span class="token operator">=</span> <span class="token keyword">await</span> conn<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token string">"SELECT * FROM users"</span><span class="token punctuation">)</span>
</code></pre>
<h2 id="decorators-and-metaprogramming-decorators">Decorators and Metaprogramming {#decorators}</h2>
<h3 id="1-function-decorators">1. Function Decorators</h3>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token keyword">from</span> functools <span class="token keyword">import</span> wraps
<span class="token keyword">from</span> typing <span class="token keyword">import</span> Callable
<span class="token keyword">import</span> time

<span class="token comment"># Basic decorator</span>
<span class="token keyword">def</span> <span class="token function">timer</span><span class="token punctuation">(</span>func<span class="token punctuation">:</span> Callable<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Callable<span class="token punctuation">:</span>
    <span class="token decorator annotation punctuation">@wraps</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">wrapper</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        result <span class="token operator">=</span> func<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
        end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>func<span class="token punctuation">.</span>__name__<span class="token punctuation">}</span></span><span class="token string"> took </span><span class="token interpolation"><span class="token punctuation">{</span>end <span class="token operator">-</span> start<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">s"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> result
    <span class="token keyword">return</span> wrapper

<span class="token decorator annotation punctuation">@timer</span>
<span class="token keyword">def</span> <span class="token function">slow_function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">"Done"</span>

<span class="token comment"># Decorator with arguments</span>
<span class="token keyword">def</span> <span class="token function">retry</span><span class="token punctuation">(</span>max_attempts<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> delay<span class="token punctuation">:</span> <span class="token builtin">float</span> <span class="token operator">=</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">decorator</span><span class="token punctuation">(</span>func<span class="token punctuation">:</span> Callable<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Callable<span class="token punctuation">:</span>
        <span class="token decorator annotation punctuation">@wraps</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span>
        <span class="token keyword">def</span> <span class="token function">wrapper</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> attempt <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>max_attempts<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">try</span><span class="token punctuation">:</span>
                    <span class="token keyword">return</span> func<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
                <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
                    <span class="token keyword">if</span> attempt <span class="token operator">==</span> max_attempts <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">:</span>
                        <span class="token keyword">raise</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Attempt </span><span class="token interpolation"><span class="token punctuation">{</span>attempt <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string"> failed: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>delay<span class="token punctuation">)</span>
        <span class="token keyword">return</span> wrapper
    <span class="token keyword">return</span> decorator

<span class="token decorator annotation punctuation">@retry</span><span class="token punctuation">(</span>max_attempts<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> delay<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">unreliable_api_call</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># May fail, will retry</span>
    <span class="token keyword">return</span> make_request<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Decorator for caching</span>
<span class="token keyword">from</span> functools <span class="token keyword">import</span> lru_cache

<span class="token decorator annotation punctuation">@lru_cache</span><span class="token punctuation">(</span>maxsize<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">fibonacci</span><span class="token punctuation">(</span>n<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">int</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> n <span class="token operator">&#x3C;</span> <span class="token number">2</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> n
    <span class="token keyword">return</span> fibonacci<span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> fibonacci<span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># Decorator for validation</span>
<span class="token keyword">def</span> <span class="token function">validate_types</span><span class="token punctuation">(</span><span class="token operator">**</span>type_hints<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">decorator</span><span class="token punctuation">(</span>func<span class="token punctuation">:</span> Callable<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Callable<span class="token punctuation">:</span>
        <span class="token decorator annotation punctuation">@wraps</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span>
        <span class="token keyword">def</span> <span class="token function">wrapper</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># Validate argument types</span>
            <span class="token keyword">for</span> name<span class="token punctuation">,</span> expected_type <span class="token keyword">in</span> type_hints<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                value <span class="token operator">=</span> kwargs<span class="token punctuation">.</span>get<span class="token punctuation">(</span>name<span class="token punctuation">)</span>
                <span class="token keyword">if</span> value <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">and</span> <span class="token keyword">not</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> expected_type<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    <span class="token keyword">raise</span> TypeError<span class="token punctuation">(</span>
                        <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string"> must be </span><span class="token interpolation"><span class="token punctuation">{</span>expected_type<span class="token punctuation">}</span></span><span class="token string">, got </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">type</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span>
                    <span class="token punctuation">)</span>
            <span class="token keyword">return</span> func<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
        <span class="token keyword">return</span> wrapper
    <span class="token keyword">return</span> decorator

<span class="token decorator annotation punctuation">@validate_types</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">,</span> age<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">create_user</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> age<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> User<span class="token punctuation">(</span>name<span class="token operator">=</span>name<span class="token punctuation">,</span> age<span class="token operator">=</span>age<span class="token punctuation">)</span>
</code></pre>
<h3 id="2-class-decorators">2. Class Decorators</h3>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token comment"># Class decorator for singleton</span>
<span class="token keyword">def</span> <span class="token function">singleton</span><span class="token punctuation">(</span>cls<span class="token punctuation">)</span><span class="token punctuation">:</span>
    instances <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    
    <span class="token decorator annotation punctuation">@wraps</span><span class="token punctuation">(</span>cls<span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">get_instance</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> cls <span class="token keyword">not</span> <span class="token keyword">in</span> instances<span class="token punctuation">:</span>
            instances<span class="token punctuation">[</span>cls<span class="token punctuation">]</span> <span class="token operator">=</span> cls<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
        <span class="token keyword">return</span> instances<span class="token punctuation">[</span>cls<span class="token punctuation">]</span>
    
    <span class="token keyword">return</span> get_instance

<span class="token decorator annotation punctuation">@singleton</span>
<span class="token keyword">class</span> <span class="token class-name">Database</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>connection <span class="token operator">=</span> connect<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Class decorator for adding methods</span>
<span class="token keyword">def</span> <span class="token function">add_repr</span><span class="token punctuation">(</span>cls<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__repr__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        attrs <span class="token operator">=</span> <span class="token string">", "</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>
            <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>k<span class="token punctuation">}</span></span><span class="token string">=</span><span class="token interpolation"><span class="token punctuation">{</span>v<span class="token conversion-option punctuation">!r</span><span class="token punctuation">}</span></span><span class="token string">"</span></span>
            <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> self<span class="token punctuation">.</span>__dict__<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>cls<span class="token punctuation">.</span>__name__<span class="token punctuation">}</span></span><span class="token string">(</span><span class="token interpolation"><span class="token punctuation">{</span>attrs<span class="token punctuation">}</span></span><span class="token string">)"</span></span>
    
    cls<span class="token punctuation">.</span>__repr__ <span class="token operator">=</span> __repr__
    <span class="token keyword">return</span> cls

<span class="token decorator annotation punctuation">@add_repr</span>
<span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> email<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name
        self<span class="token punctuation">.</span>email <span class="token operator">=</span> email

<span class="token comment"># Class decorator for registration</span>
_handlers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">def</span> <span class="token function">register_handler</span><span class="token punctuation">(</span>event_type<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">decorator</span><span class="token punctuation">(</span>cls<span class="token punctuation">)</span><span class="token punctuation">:</span>
        _handlers<span class="token punctuation">[</span>event_type<span class="token punctuation">]</span> <span class="token operator">=</span> cls
        <span class="token keyword">return</span> cls
    <span class="token keyword">return</span> decorator

<span class="token decorator annotation punctuation">@register_handler</span><span class="token punctuation">(</span><span class="token string">"user.created"</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">UserCreatedHandler</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">handle</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> event<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"User created: </span><span class="token interpolation"><span class="token punctuation">{</span>event<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">get_handler</span><span class="token punctuation">(</span>event_type<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> _handlers<span class="token punctuation">.</span>get<span class="token punctuation">(</span>event_type<span class="token punctuation">)</span>
</code></pre>
<h3 id="3-metaclasses">3. Metaclasses</h3>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token comment"># Basic metaclass</span>
<span class="token keyword">class</span> <span class="token class-name">SingletonMeta</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    _instances <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    
    <span class="token keyword">def</span> <span class="token function">__call__</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> cls <span class="token keyword">not</span> <span class="token keyword">in</span> cls<span class="token punctuation">.</span>_instances<span class="token punctuation">:</span>
            cls<span class="token punctuation">.</span>_instances<span class="token punctuation">[</span>cls<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__call__<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
        <span class="token keyword">return</span> cls<span class="token punctuation">.</span>_instances<span class="token punctuation">[</span>cls<span class="token punctuation">]</span>

<span class="token keyword">class</span> <span class="token class-name">Database</span><span class="token punctuation">(</span>metaclass<span class="token operator">=</span>SingletonMeta<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>connection <span class="token operator">=</span> <span class="token string">"Connected"</span>

db1 <span class="token operator">=</span> Database<span class="token punctuation">(</span><span class="token punctuation">)</span>
db2 <span class="token operator">=</span> Database<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>db1 <span class="token keyword">is</span> db2<span class="token punctuation">)</span>  <span class="token comment"># True</span>

<span class="token comment"># Metaclass for automatic registration</span>
<span class="token keyword">class</span> <span class="token class-name">PluginMeta</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    plugins <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    
    <span class="token keyword">def</span> <span class="token function">__new__</span><span class="token punctuation">(</span>mcs<span class="token punctuation">,</span> name<span class="token punctuation">,</span> bases<span class="token punctuation">,</span> attrs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        cls <span class="token operator">=</span> <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__new__<span class="token punctuation">(</span>mcs<span class="token punctuation">,</span> name<span class="token punctuation">,</span> bases<span class="token punctuation">,</span> attrs<span class="token punctuation">)</span>
        <span class="token keyword">if</span> name <span class="token operator">!=</span> <span class="token string">'Plugin'</span><span class="token punctuation">:</span>  <span class="token comment"># Don't register base class</span>
            mcs<span class="token punctuation">.</span>plugins<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> cls
        <span class="token keyword">return</span> cls

<span class="token keyword">class</span> <span class="token class-name">Plugin</span><span class="token punctuation">(</span>metaclass<span class="token operator">=</span>PluginMeta<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>

<span class="token keyword">class</span> <span class="token class-name">EmailPlugin</span><span class="token punctuation">(</span>Plugin<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">send</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Sending email: </span><span class="token interpolation"><span class="token punctuation">{</span>message<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">SMSPlugin</span><span class="token punctuation">(</span>Plugin<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">send</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Sending SMS: </span><span class="token interpolation"><span class="token punctuation">{</span>message<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token comment"># Access all registered plugins</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>PluginMeta<span class="token punctuation">.</span>plugins<span class="token punctuation">)</span>  <span class="token comment"># {'EmailPlugin': ..., 'SMSPlugin': ...}</span>

<span class="token comment"># Metaclass for validation</span>
<span class="token keyword">class</span> <span class="token class-name">ValidatedMeta</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__new__</span><span class="token punctuation">(</span>mcs<span class="token punctuation">,</span> name<span class="token punctuation">,</span> bases<span class="token punctuation">,</span> attrs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># Validate required methods</span>
        required_methods <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'validate'</span><span class="token punctuation">,</span> <span class="token string">'save'</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> method <span class="token keyword">in</span> required_methods<span class="token punctuation">:</span>
            <span class="token keyword">if</span> method <span class="token keyword">not</span> <span class="token keyword">in</span> attrs<span class="token punctuation">:</span>
                <span class="token keyword">raise</span> TypeError<span class="token punctuation">(</span>
                    <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string"> must implement </span><span class="token interpolation"><span class="token punctuation">{</span>method<span class="token punctuation">}</span></span><span class="token string"> method"</span></span>
                <span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__new__<span class="token punctuation">(</span>mcs<span class="token punctuation">,</span> name<span class="token punctuation">,</span> bases<span class="token punctuation">,</span> attrs<span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">Model</span><span class="token punctuation">(</span>metaclass<span class="token operator">=</span>ValidatedMeta<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">validate</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>
    
    <span class="token keyword">def</span> <span class="token function">save</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>
</code></pre>
<h2 id="concurrency-and-parallelism-concurrency">Concurrency and Parallelism {#concurrency}</h2>
<h3 id="1-asyncio-basics">1. Asyncio Basics</h3>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token keyword">import</span> asyncio
<span class="token keyword">from</span> typing <span class="token keyword">import</span> List

<span class="token comment"># Basic async function</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">fetch_data</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">dict</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Fetching </span><span class="token interpolation"><span class="token punctuation">{</span>url<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># Simulate network delay</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">"url"</span><span class="token punctuation">:</span> url<span class="token punctuation">,</span> <span class="token string">"data"</span><span class="token punctuation">:</span> <span class="token string">"..."</span><span class="token punctuation">}</span>

<span class="token comment"># Run async function</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> <span class="token keyword">await</span> fetch_data<span class="token punctuation">(</span><span class="token string">"https://api.example.com"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>

asyncio<span class="token punctuation">.</span>run<span class="token punctuation">(</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Concurrent execution</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">fetch_all</span><span class="token punctuation">(</span>urls<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> List<span class="token punctuation">[</span><span class="token builtin">dict</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    tasks <span class="token operator">=</span> <span class="token punctuation">[</span>fetch_data<span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token keyword">for</span> url <span class="token keyword">in</span> urls<span class="token punctuation">]</span>
    results <span class="token operator">=</span> <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>gather<span class="token punctuation">(</span><span class="token operator">*</span>tasks<span class="token punctuation">)</span>
    <span class="token keyword">return</span> results

urls <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">"https://api.example.com/1"</span><span class="token punctuation">,</span>
    <span class="token string">"https://api.example.com/2"</span><span class="token punctuation">,</span>
    <span class="token string">"https://api.example.com/3"</span>
<span class="token punctuation">]</span>

results <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>run<span class="token punctuation">(</span>fetch_all<span class="token punctuation">(</span>urls<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># With timeout</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">fetch_with_timeout</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> timeout<span class="token punctuation">:</span> <span class="token builtin">float</span> <span class="token operator">=</span> <span class="token number">5.0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>wait_for<span class="token punctuation">(</span>
            fetch_data<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">,</span>
            timeout<span class="token operator">=</span>timeout
        <span class="token punctuation">)</span>
    <span class="token keyword">except</span> asyncio<span class="token punctuation">.</span>TimeoutError<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Timeout fetching </span><span class="token interpolation"><span class="token punctuation">{</span>url<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">None</span>

<span class="token comment"># Async context manager for connection pool</span>
<span class="token keyword">class</span> <span class="token class-name">AsyncConnectionPool</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> max_connections<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>_semaphore <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>Semaphore<span class="token punctuation">(</span>max_connections<span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">acquire</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">await</span> self<span class="token punctuation">.</span>_semaphore<span class="token punctuation">.</span>acquire<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> Connection<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">release</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> connection<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">await</span> connection<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>_semaphore<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span>

pool <span class="token operator">=</span> AsyncConnectionPool<span class="token punctuation">(</span>max_connections<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>

<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">make_request</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    connection <span class="token operator">=</span> <span class="token keyword">await</span> pool<span class="token punctuation">.</span>acquire<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        result <span class="token operator">=</span> <span class="token keyword">await</span> connection<span class="token punctuation">.</span>fetch<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
        <span class="token keyword">return</span> result
    <span class="token keyword">finally</span><span class="token punctuation">:</span>
        <span class="token keyword">await</span> pool<span class="token punctuation">.</span>release<span class="token punctuation">(</span>connection<span class="token punctuation">)</span>
</code></pre>
<h3 id="2-threading">2. Threading</h3>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token keyword">import</span> threading
<span class="token keyword">from</span> queue <span class="token keyword">import</span> Queue
<span class="token keyword">from</span> typing <span class="token keyword">import</span> Callable

<span class="token comment"># Basic threading</span>
<span class="token keyword">def</span> <span class="token function">worker</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Worker </span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string"> starting"</span></span><span class="token punctuation">)</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Worker </span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string"> finished"</span></span><span class="token punctuation">)</span>

threads <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    t <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>worker<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"#</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    t<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
    threads<span class="token punctuation">.</span>append<span class="token punctuation">(</span>t<span class="token punctuation">)</span>

<span class="token keyword">for</span> t <span class="token keyword">in</span> threads<span class="token punctuation">:</span>
    t<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Thread pool</span>
<span class="token keyword">from</span> concurrent<span class="token punctuation">.</span>futures <span class="token keyword">import</span> ThreadPoolExecutor

<span class="token keyword">def</span> <span class="token function">process_item</span><span class="token punctuation">(</span>item<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">int</span><span class="token punctuation">:</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> item <span class="token operator">**</span> <span class="token number">2</span>

<span class="token keyword">with</span> ThreadPoolExecutor<span class="token punctuation">(</span>max_workers<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">as</span> executor<span class="token punctuation">:</span>
    items <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
    results <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>executor<span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span>process_item<span class="token punctuation">,</span> items<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Thread-safe queue</span>
task_queue <span class="token operator">=</span> Queue<span class="token punctuation">(</span><span class="token punctuation">)</span>
result_queue <span class="token operator">=</span> Queue<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">worker_thread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        item <span class="token operator">=</span> task_queue<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> item <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            <span class="token keyword">break</span>
        result <span class="token operator">=</span> process_item<span class="token punctuation">(</span>item<span class="token punctuation">)</span>
        result_queue<span class="token punctuation">.</span>put<span class="token punctuation">(</span>result<span class="token punctuation">)</span>
        task_queue<span class="token punctuation">.</span>task_done<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Start workers</span>
num_workers <span class="token operator">=</span> <span class="token number">4</span>
workers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_workers<span class="token punctuation">)</span><span class="token punctuation">:</span>
    t <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>worker_thread<span class="token punctuation">)</span>
    t<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
    workers<span class="token punctuation">.</span>append<span class="token punctuation">(</span>t<span class="token punctuation">)</span>

<span class="token comment"># Add tasks</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    task_queue<span class="token punctuation">.</span>put<span class="token punctuation">(</span>i<span class="token punctuation">)</span>

<span class="token comment"># Wait for completion</span>
task_queue<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Stop workers</span>
<span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_workers<span class="token punctuation">)</span><span class="token punctuation">:</span>
    task_queue<span class="token punctuation">.</span>put<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> t <span class="token keyword">in</span> workers<span class="token punctuation">:</span>
    t<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Collect results</span>
results <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">while</span> <span class="token keyword">not</span> result_queue<span class="token punctuation">.</span>empty<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    results<span class="token punctuation">.</span>append<span class="token punctuation">(</span>result_queue<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<h3 id="3-multiprocessing">3. Multiprocessing</h3>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token keyword">from</span> multiprocessing <span class="token keyword">import</span> Pool<span class="token punctuation">,</span> Process<span class="token punctuation">,</span> Queue<span class="token punctuation">,</span> Manager
<span class="token keyword">import</span> os

<span class="token comment"># Basic multiprocessing</span>
<span class="token keyword">def</span> <span class="token function">compute</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">int</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x <span class="token operator">**</span> <span class="token number">2</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> Pool<span class="token punctuation">(</span>processes<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">as</span> pool<span class="token punctuation">:</span>
        results <span class="token operator">=</span> pool<span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span>compute<span class="token punctuation">,</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span>

<span class="token comment"># Process with shared state</span>
<span class="token keyword">from</span> multiprocessing <span class="token keyword">import</span> Value<span class="token punctuation">,</span> Array

<span class="token keyword">def</span> <span class="token function">increment_counter</span><span class="token punctuation">(</span>counter<span class="token punctuation">,</span> lock<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">with</span> lock<span class="token punctuation">:</span>
            counter<span class="token punctuation">.</span>value <span class="token operator">+=</span> <span class="token number">1</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    counter <span class="token operator">=</span> Value<span class="token punctuation">(</span><span class="token string">'i'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    lock <span class="token operator">=</span> threading<span class="token punctuation">.</span>Lock<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    processes <span class="token operator">=</span> <span class="token punctuation">[</span>
        Process<span class="token punctuation">(</span>target<span class="token operator">=</span>increment_counter<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>counter<span class="token punctuation">,</span> lock<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
    
    <span class="token keyword">for</span> p <span class="token keyword">in</span> processes<span class="token punctuation">:</span>
        p<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">for</span> p <span class="token keyword">in</span> processes<span class="token punctuation">:</span>
        p<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Final count: </span><span class="token interpolation"><span class="token punctuation">{</span>counter<span class="token punctuation">.</span>value<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token comment"># Manager for complex data structures</span>
<span class="token keyword">def</span> <span class="token function">worker</span><span class="token punctuation">(</span>shared_dict<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
    shared_dict<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> Manager<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> manager<span class="token punctuation">:</span>
        shared_dict <span class="token operator">=</span> manager<span class="token punctuation">.</span><span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        processes <span class="token operator">=</span> <span class="token punctuation">[</span>
            Process<span class="token punctuation">(</span>target<span class="token operator">=</span>worker<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>shared_dict<span class="token punctuation">,</span> i<span class="token punctuation">,</span> i<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span>
        
        <span class="token keyword">for</span> p <span class="token keyword">in</span> processes<span class="token punctuation">:</span>
            p<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token keyword">for</span> p <span class="token keyword">in</span> processes<span class="token punctuation">:</span>
            p<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">dict</span><span class="token punctuation">(</span>shared_dict<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<h2 id="performance-optimization-performance">Performance Optimization {#performance}</h2>
<h3 id="1-profiling">1. Profiling</h3>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token keyword">import</span> cProfile
<span class="token keyword">import</span> pstats
<span class="token keyword">from</span> line_profiler <span class="token keyword">import</span> LineProfiler

<span class="token comment"># cProfile for function-level profiling</span>
<span class="token keyword">def</span> <span class="token function">slow_function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    total <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        total <span class="token operator">+=</span> i
    <span class="token keyword">return</span> total

<span class="token comment"># Profile execution</span>
cProfile<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token string">'slow_function()'</span><span class="token punctuation">)</span>

<span class="token comment"># Save profile data</span>
cProfile<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token string">'slow_function()'</span><span class="token punctuation">,</span> <span class="token string">'profile_stats'</span><span class="token punctuation">)</span>

<span class="token comment"># Analyze profile data</span>
stats <span class="token operator">=</span> pstats<span class="token punctuation">.</span>Stats<span class="token punctuation">(</span><span class="token string">'profile_stats'</span><span class="token punctuation">)</span>
stats<span class="token punctuation">.</span>sort_stats<span class="token punctuation">(</span><span class="token string">'cumulative'</span><span class="token punctuation">)</span>
stats<span class="token punctuation">.</span>print_stats<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>

<span class="token comment"># Line-by-line profiling</span>
profiler <span class="token operator">=</span> LineProfiler<span class="token punctuation">(</span><span class="token punctuation">)</span>
profiler<span class="token punctuation">.</span>add_function<span class="token punctuation">(</span>slow_function<span class="token punctuation">)</span>
profiler<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token string">'slow_function()'</span><span class="token punctuation">)</span>
profiler<span class="token punctuation">.</span>print_stats<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Memory profiling</span>
<span class="token keyword">from</span> memory_profiler <span class="token keyword">import</span> profile

<span class="token decorator annotation punctuation">@profile</span>
<span class="token keyword">def</span> <span class="token function">memory_intensive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    large_list <span class="token operator">=</span> <span class="token punctuation">[</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>large_list<span class="token punctuation">)</span>

memory_intensive<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<h3 id="2-performance-optimization-techniques">2. Performance Optimization Techniques</h3>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token comment"># ❌ Bad: List concatenation in loop</span>
<span class="token keyword">def</span> <span class="token function">bad_concatenation</span><span class="token punctuation">(</span>items<span class="token punctuation">)</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">for</span> item <span class="token keyword">in</span> items<span class="token punctuation">:</span>
        result <span class="token operator">+=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>  <span class="token comment"># Creates new string each time</span>
    <span class="token keyword">return</span> result

<span class="token comment"># ✅ Good: Join strings</span>
<span class="token keyword">def</span> <span class="token function">good_concatenation</span><span class="token punctuation">(</span>items<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token keyword">for</span> item <span class="token keyword">in</span> items<span class="token punctuation">)</span>

<span class="token comment"># ❌ Bad: Unnecessary list creation</span>
<span class="token keyword">def</span> <span class="token function">bad_sum</span><span class="token punctuation">(</span>items<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">[</span>x <span class="token operator">**</span> <span class="token number">2</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> items<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># ✅ Good: Generator expression</span>
<span class="token keyword">def</span> <span class="token function">good_sum</span><span class="token punctuation">(</span>items<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>x <span class="token operator">**</span> <span class="token number">2</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> items<span class="token punctuation">)</span>

<span class="token comment"># ❌ Bad: Multiple passes over data</span>
<span class="token keyword">def</span> <span class="token function">bad_processing</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    filtered <span class="token operator">=</span> <span class="token punctuation">[</span>x <span class="token keyword">for</span> x <span class="token keyword">in</span> data <span class="token keyword">if</span> x <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">]</span>
    squared <span class="token operator">=</span> <span class="token punctuation">[</span>x <span class="token operator">**</span> <span class="token number">2</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> filtered<span class="token punctuation">]</span>
    summed <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>squared<span class="token punctuation">)</span>
    <span class="token keyword">return</span> summed

<span class="token comment"># ✅ Good: Single pass</span>
<span class="token keyword">def</span> <span class="token function">good_processing</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>x <span class="token operator">**</span> <span class="token number">2</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> data <span class="token keyword">if</span> x <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>

<span class="token comment"># Using __slots__ for memory optimization</span>
<span class="token keyword">class</span> <span class="token class-name">RegularPoint</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>x <span class="token operator">=</span> x
        self<span class="token punctuation">.</span>y <span class="token operator">=</span> y

<span class="token keyword">class</span> <span class="token class-name">OptimizedPoint</span><span class="token punctuation">:</span>
    __slots__ <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'x'</span><span class="token punctuation">,</span> <span class="token string">'y'</span><span class="token punctuation">]</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>x <span class="token operator">=</span> x
        self<span class="token punctuation">.</span>y <span class="token operator">=</span> y

<span class="token comment"># OptimizedPoint uses ~40% less memory</span>

<span class="token comment"># Lazy evaluation with generators</span>
<span class="token keyword">def</span> <span class="token function">read_large_file</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        <span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>
            <span class="token comment"># Process line-by-line without loading entire file</span>
            <span class="token keyword">yield</span> process_line<span class="token punctuation">(</span>line<span class="token punctuation">)</span>

<span class="token comment"># Use sets for membership testing</span>
<span class="token comment"># ❌ Bad: O(n) lookup in list</span>
items_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span>
<span class="token keyword">if</span> x <span class="token keyword">in</span> items_list<span class="token punctuation">:</span>  <span class="token comment"># Slow for large lists</span>
    <span class="token keyword">pass</span>

<span class="token comment"># ✅ Good: O(1) lookup in set</span>
items_set <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span>
<span class="token keyword">if</span> x <span class="token keyword">in</span> items_set<span class="token punctuation">:</span>  <span class="token comment"># Fast</span>
    <span class="token keyword">pass</span>
</code></pre>
<h2 id="testing-strategies-testing">Testing Strategies {#testing}</h2>
<h3 id="1-pytest-basics">1. pytest Basics</h3>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token keyword">import</span> pytest
<span class="token keyword">from</span> typing <span class="token keyword">import</span> List

<span class="token comment"># Basic test</span>
<span class="token keyword">def</span> <span class="token function">test_addition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">assert</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">==</span> <span class="token number">2</span>

<span class="token comment"># Test with fixtures</span>
<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>fixture</span>
<span class="token keyword">def</span> <span class="token function">sample_data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">test_sum</span><span class="token punctuation">(</span>sample_data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">assert</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>sample_data<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">15</span>

<span class="token comment"># Parametrized tests</span>
<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>mark<span class="token punctuation">.</span>parametrize</span><span class="token punctuation">(</span><span class="token string">"input,expected"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
    <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">test_double</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">,</span> expected<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">assert</span> <span class="token builtin">input</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">==</span> expected

<span class="token comment"># Test exceptions</span>
<span class="token keyword">def</span> <span class="token function">test_division_by_zero</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> pytest<span class="token punctuation">.</span>raises<span class="token punctuation">(</span>ZeroDivisionError<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token number">1</span> <span class="token operator">/</span> <span class="token number">0</span>

<span class="token comment"># Async tests</span>
<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>mark<span class="token punctuation">.</span>asyncio</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">test_async_function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> <span class="token keyword">await</span> async_fetch_data<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">assert</span> result <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span>

<span class="token comment"># Mocking</span>
<span class="token keyword">from</span> unittest<span class="token punctuation">.</span>mock <span class="token keyword">import</span> Mock<span class="token punctuation">,</span> patch

<span class="token keyword">def</span> <span class="token function">test_with_mock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    mock_db <span class="token operator">=</span> Mock<span class="token punctuation">(</span><span class="token punctuation">)</span>
    mock_db<span class="token punctuation">.</span>get_user<span class="token punctuation">.</span>return_value <span class="token operator">=</span> User<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token string">"1"</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"Test"</span><span class="token punctuation">)</span>
    
    service <span class="token operator">=</span> UserService<span class="token punctuation">(</span>mock_db<span class="token punctuation">)</span>
    user <span class="token operator">=</span> service<span class="token punctuation">.</span>find_user<span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span>
    
    <span class="token keyword">assert</span> user<span class="token punctuation">.</span>name <span class="token operator">==</span> <span class="token string">"Test"</span>
    mock_db<span class="token punctuation">.</span>get_user<span class="token punctuation">.</span>assert_called_once_with<span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span>

<span class="token comment"># Patching</span>
<span class="token decorator annotation punctuation">@patch</span><span class="token punctuation">(</span><span class="token string">'module.external_api_call'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">test_with_patch</span><span class="token punctuation">(</span>mock_api<span class="token punctuation">)</span><span class="token punctuation">:</span>
    mock_api<span class="token punctuation">.</span>return_value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"status"</span><span class="token punctuation">:</span> <span class="token string">"success"</span><span class="token punctuation">}</span>
    
    result <span class="token operator">=</span> process_api_data<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">assert</span> result<span class="token punctuation">[</span><span class="token string">"status"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"success"</span>
</code></pre>
<h3 id="2-test-organization">2. Test Organization</h3>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token comment"># tests/conftest.py - Shared fixtures</span>
<span class="token keyword">import</span> pytest

<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>fixture</span><span class="token punctuation">(</span>scope<span class="token operator">=</span><span class="token string">"session"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    db <span class="token operator">=</span> create_test_database<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">yield</span> db
    db<span class="token punctuation">.</span>cleanup<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>fixture</span>
<span class="token keyword">def</span> <span class="token function">user</span><span class="token punctuation">(</span>database<span class="token punctuation">)</span><span class="token punctuation">:</span>
    user <span class="token operator">=</span> User<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"Test"</span><span class="token punctuation">,</span> email<span class="token operator">=</span><span class="token string">"test@example.com"</span><span class="token punctuation">)</span>
    database<span class="token punctuation">.</span>save<span class="token punctuation">(</span>user<span class="token punctuation">)</span>
    <span class="token keyword">yield</span> user
    database<span class="token punctuation">.</span>delete<span class="token punctuation">(</span>user<span class="token punctuation">)</span>

<span class="token comment"># tests/test_user_service.py</span>
<span class="token keyword">class</span> <span class="token class-name">TestUserService</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">test_create_user</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> database<span class="token punctuation">)</span><span class="token punctuation">:</span>
        service <span class="token operator">=</span> UserService<span class="token punctuation">(</span>database<span class="token punctuation">)</span>
        user <span class="token operator">=</span> service<span class="token punctuation">.</span>create_user<span class="token punctuation">(</span><span class="token string">"John"</span><span class="token punctuation">,</span> <span class="token string">"john@example.com"</span><span class="token punctuation">)</span>
        <span class="token keyword">assert</span> user<span class="token punctuation">.</span>name <span class="token operator">==</span> <span class="token string">"John"</span>
    
    <span class="token keyword">def</span> <span class="token function">test_find_user</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> database<span class="token punctuation">,</span> user<span class="token punctuation">)</span><span class="token punctuation">:</span>
        service <span class="token operator">=</span> UserService<span class="token punctuation">(</span>database<span class="token punctuation">)</span>
        found <span class="token operator">=</span> service<span class="token punctuation">.</span>find_user<span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">)</span>
        <span class="token keyword">assert</span> found<span class="token punctuation">.</span><span class="token builtin">id</span> <span class="token operator">==</span> user<span class="token punctuation">.</span><span class="token builtin">id</span>
    
    <span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>mark<span class="token punctuation">.</span>slow</span>
    <span class="token keyword">def</span> <span class="token function">test_expensive_operation</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># Long-running test</span>
        <span class="token keyword">pass</span>

<span class="token comment"># Run specific tests</span>
<span class="token comment"># pytest tests/test_user_service.py</span>
<span class="token comment"># pytest -k "test_create"</span>
<span class="token comment"># pytest -m "not slow"</span>
</code></pre>
<h2 id="project-structure-project-structure">Project Structure {#project-structure}</h2>
<h3 id="1-standard-project-layout">1. Standard Project Layout</h3>
<pre class="language-plaintext" data-language="plaintext"><code is:raw="" class="language-plaintext">my_project/
├── src/
│   └── my_package/
│       ├── __init__.py
│       ├── __main__.py
│       ├── core/
│       │   ├── __init__.py
│       │   └── models.py
│       ├── services/
│       │   ├── __init__.py
│       │   └── user_service.py
│       └── utils/
│           ├── __init__.py
│           └── helpers.py
├── tests/
│   ├── __init__.py
│   ├── conftest.py
│   ├── unit/
│   │   └── test_models.py
│   └── integration/
│       └── test_user_service.py
├── docs/
│   └── README.md
├── pyproject.toml
├── setup.py
├── requirements.txt
├── requirements-dev.txt
├── .gitignore
├── .pre-commit-config.yaml
└── README.md
</code></pre>
<h3 id="2-configuration-management">2. Configuration Management</h3>
<pre class="language-python" data-language="python"><code is:raw="" class="language-python"><span class="token comment"># config.py</span>
<span class="token keyword">from</span> pydantic <span class="token keyword">import</span> BaseSettings<span class="token punctuation">,</span> Field
<span class="token keyword">from</span> typing <span class="token keyword">import</span> Optional

<span class="token keyword">class</span> <span class="token class-name">Settings</span><span class="token punctuation">(</span>BaseSettings<span class="token punctuation">)</span><span class="token punctuation">:</span>
    app_name<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">"My App"</span>
    debug<span class="token punctuation">:</span> <span class="token builtin">bool</span> <span class="token operator">=</span> <span class="token boolean">False</span>
    database_url<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> Field<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> env<span class="token operator">=</span><span class="token string">"DATABASE_URL"</span><span class="token punctuation">)</span>
    redis_url<span class="token punctuation">:</span> Optional<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">None</span>
    api_key<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> Field<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> env<span class="token operator">=</span><span class="token string">"API_KEY"</span><span class="token punctuation">)</span>
    
    <span class="token keyword">class</span> <span class="token class-name">Config</span><span class="token punctuation">:</span>
        env_file <span class="token operator">=</span> <span class="token string">".env"</span>
        env_file_encoding <span class="token operator">=</span> <span class="token string">"utf-8"</span>

settings <span class="token operator">=</span> Settings<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># .env file</span>
<span class="token comment"># DATABASE_URL=postgresql://localhost/mydb</span>
<span class="token comment"># API_KEY=secret_key_here</span>
</code></pre>
<h2 id="conclusion">Conclusion</h2>
<p>Professional Python development requires mastering these patterns and practices:</p>
<ol>
<li><strong>Type Hints</strong> - Make code self-documenting and catch bugs early</li>
<li><strong>Async/Await</strong> - Handle I/O-bound operations efficiently</li>
<li><strong>Testing</strong> - Ensure code quality and prevent regressions</li>
<li><strong>Performance</strong> - Profile before optimizing, optimize bottlenecks</li>
<li><strong>Project Structure</strong> - Organize code for maintainability</li>
</ol>
<p><strong>Remember</strong>: Write Python code that others (and future you) will thank you for.</p>
<h2 id="resources">Resources</h2>
<ul>
<li><a href="https://docs.python.org/">Python Documentation</a></li>
<li><a href="https://realpython.com/">Real Python</a></li>
<li><a href="https://peps.python.org/pep-0484/">Python Type Hints</a></li>
<li><a href="https://effectivepython.com/">Effective Python</a></li>
</ul>
<hr>
<p><em>What Python patterns do you use most in production? Share your experience!</em></p> </div>  <section class="related-posts" data-astro-cid-dpgbfi7r> <h2 data-astro-cid-dpgbfi7r>Related Posts</h2> <div class="related-posts-grid" data-astro-cid-dpgbfi7r> <article class="related-post-card" data-astro-cid-dpgbfi7r> <a href="/ai-news/2025-11-01-typescript-advanced-patterns-best-practices/" class="related-post-link" data-astro-cid-dpgbfi7r> <h3 data-astro-cid-dpgbfi7r>TypeScript Advanced Patterns and Best Practices: Complete Guide</h3> <p class="related-excerpt" data-astro-cid-dpgbfi7r>TypeScript Advanced Patterns and Best Practices: Complete Guide TypeScript has become the de facto standard for…</p> <div class="related-meta" data-astro-cid-dpgbfi7r> <time datetime="2025-11-01T14:00:00.000Z" data-astro-cid-dpgbfi7r> Nov 1, 2025 </time> <span data-astro-cid-dpgbfi7r>•</span> <span data-astro-cid-dpgbfi7r>23 min read</span> </div> </a> </article><article class="related-post-card" data-astro-cid-dpgbfi7r> <a href="/stock-weather-ai/" class="related-post-link" data-astro-cid-dpgbfi7r> <h3 data-astro-cid-dpgbfi7r>Stock Weather AI</h3> <p class="related-excerpt" data-astro-cid-dpgbfi7r>Stock Weather AI — Reading the Market&#39;s Forecast Imagine a weather report for the markets: a short, clear summary about…</p> <div class="related-meta" data-astro-cid-dpgbfi7r> <time datetime="2025-10-03T23:00:00.000Z" data-astro-cid-dpgbfi7r> Oct 3, 2025 </time> <span data-astro-cid-dpgbfi7r>•</span> <span data-astro-cid-dpgbfi7r>3 min read</span> </div> </a> </article><article class="related-post-card" data-astro-cid-dpgbfi7r> <a href="/ai-news/2025-10-27-podcast-effective-error-handling-a-uniform-strategy-for-heterogeneous-distributed-systems/" class="related-post-link" data-astro-cid-dpgbfi7r> <h3 data-astro-cid-dpgbfi7r>Effective Error Handling: A Uniform Strategy for Heterogeneous Distributed Systems</h3> <p class="related-excerpt" data-astro-cid-dpgbfi7r>Main Heading This conversation with Jenish Shah from Netflix delves into the complexities of error handling in…</p> <div class="related-meta" data-astro-cid-dpgbfi7r> <time datetime="2025-10-27T00:00:00.000Z" data-astro-cid-dpgbfi7r> Oct 27, 2025 </time> <span data-astro-cid-dpgbfi7r>•</span> <span data-astro-cid-dpgbfi7r>3 min read</span> </div> </a> </article> </div> </section>  </article> </div> <div class="back-link" data-astro-cid-rkg3zjxi><a href="/ai-news/" data-astro-cid-rkg3zjxi>← Back to AI News</a></div>  </main> <!-- Site Footer --> <footer class="site-footer container"> <p>
© 2025 AREZKI El Mehdi •
<a href="https://github.com/earezki">GitHub</a> •
<a href="/rss.xml">RSS</a> •
<a href="/sitemap-index.xml">Sitemap</a> </p> </footer> <!-- Theme Toggle Script -->  <!-- Article Read/Unread Tracking --> <script>
      /**
       * Tracks which articles have been read using localStorage
       * Updates post card styling on list pages
       */
      (function() {
        const STORAGE_KEY = 'readArticles';
        
        /**
         * Gets list of read article URLs from localStorage
         */
        function getReadArticles() {
          try {
            const data = localStorage.getItem(STORAGE_KEY);
            return data ? JSON.parse(data) : [];
          } catch (e) {
            console.error('Failed to get read articles:', e);
            return [];
          }
        }
        
        /**
         * Marks an article URL as read
         */
        function markArticleAsRead(url) {
          try {
            const readArticles = getReadArticles();
            if (!readArticles.includes(url)) {
              readArticles.push(url);
              localStorage.setItem(STORAGE_KEY, JSON.stringify(readArticles));
            }
          } catch (e) {
            console.error('Failed to mark article as read:', e);
          }
        }
        
        /**
         * Checks if an article has been read
         */
        function isArticleRead(url) {
          const readArticles = getReadArticles();
          return readArticles.includes(url);
        }
        
        /**
         * Updates post card styling on list pages based on read status
         */
        function updatePostCards() {
          const postCards = document.querySelectorAll('.post-card[data-article-url]');
          
          postCards.forEach(function(card) {
            const url = card.getAttribute('data-article-url');
            if (!url) return;
            
            if (isArticleRead(url)) {
              card.classList.add('read');
              card.classList.remove('unread');
            } else {
              card.classList.add('unread');
              card.classList.remove('read');
            }
          });
        }
        
        /**
         * Marks current article as read (on article detail pages)
         */
        function markCurrentArticleAsRead() {
          const isArticlePage = document.querySelector('.post-body');
          if (isArticlePage) {
            const currentPath = window.location.pathname;
            markArticleAsRead(currentPath);
          }
        }
        
        /**
         * Initialize tracking system
         */
        function init() {
          updatePostCards();
          markCurrentArticleAsRead();
        }
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', init);
        
        // Handle back/forward navigation (bfcache)
        window.addEventListener('pageshow', function(event) {
          if (event.persisted) {
            init();
          }
        });
      })();
    </script> <!-- Code Copy Functionality --> <script>
      /**
       * Adds copy buttons to all code blocks
       */
      (function() {
        /**
         * Creates a copy button element
         */
        function createCopyButton() {
          const button = document.createElement('button');
          button.className = 'copy-code-button';
          button.setAttribute('aria-label', 'Copy code to clipboard');
          button.innerHTML = `
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
              <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
            </svg>
            <span>Copy</span>
          `;
          return button;
        }
        
        /**
         * Creates a success checkmark icon
         */
        function createCheckIcon() {
          return `
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
            <span>Copied!</span>
          `;
        }
        
        /**
         * Copies text to clipboard
         */
        async function copyToClipboard(text) {
          try {
            await navigator.clipboard.writeText(text);
            return true;
          } catch (err) {
            // Fallback for older browsers
            const textArea = document.createElement('textarea');
            textArea.value = text;
            textArea.style.position = 'fixed';
            textArea.style.left = '-999999px';
            document.body.appendChild(textArea);
            textArea.select();
            try {
              document.execCommand('copy');
              document.body.removeChild(textArea);
              return true;
            } catch (e) {
              document.body.removeChild(textArea);
              return false;
            }
          }
        }
        
        /**
         * Handles copy button click
         */
        async function handleCopyClick(button, codeBlock) {
          const code = codeBlock.textContent || '';
          const success = await copyToClipboard(code);
          
          if (success) {
            const originalHTML = button.innerHTML;
            button.classList.add('copied');
            button.innerHTML = createCheckIcon();
            
            setTimeout(function() {
              button.classList.remove('copied');
              button.innerHTML = originalHTML;
            }, 2000);
          }
        }
        
        /**
         * Adds copy buttons to all code blocks
         */
        function addCopyButtons() {
          const codeBlocks = document.querySelectorAll('.post-body pre');
          
          codeBlocks.forEach(function(pre) {
            // Skip if button already exists
            if (pre.querySelector('.copy-code-button')) {
              return;
            }
            
            const button = createCopyButton();
            const codeBlock = pre.querySelector('code');
            
            if (codeBlock) {
              button.addEventListener('click', function() {
                handleCopyClick(button, codeBlock);
              });
              
              pre.appendChild(button);
            }
          });
        }
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', addCopyButtons);
      })();
    </script> </body> </html> 