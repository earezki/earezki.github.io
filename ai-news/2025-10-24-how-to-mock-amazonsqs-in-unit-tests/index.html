<!DOCTYPE html><html lang="en" data-theme="dark"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>How to Mock Amazon SQS in Unit Tests with Dependency Injection and Mockito • Dev|Journal</title><meta name="description" content="Main Heading This article explains how to mock Amazon SQS (Simple Queue Service) in unit tests using dependency injection and Mockito. The approach ensures…"><meta property="og:title" content="How to Mock Amazon SQS in Unit Tests with Dependency Injection and Mockito • Dev|Journal"><meta property="og:site_name" content="Dev|Journal"><meta property="og:description" content="Main Heading This article explains how to mock Amazon SQS (Simple Queue Service) in unit tests using dependency injection and Mockito. The approach ensures…"><link rel="canonical" href="https://earezki.com/ai-news/2025-10-24-how-to-mock-amazonsqs-in-unit-tests/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="How to Mock Amazon SQS in Unit Tests with Dependency Injection and Mockito • Dev|Journal"><meta name="twitter:description" content="Main Heading This article explains how to mock Amazon SQS (Simple Queue Service) in unit tests using dependency injection and Mockito. The approach ensures…"><link rel="alternate" type="application/rss+xml" title="RSS" href="/rss.xml"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-161447264-1"></script><script defer src="https://cloud.umami.is/script.js" data-website-id="4a26531d-1053-4f79-97a6-06a1366aff91"></script><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"How to Mock Amazon SQS in Unit Tests with Dependency Injection and Mockito","datePublished":"2025-10-24T00:00:00.000Z","dateModified":"2025-10-24T00:00:00.000Z","author":{"@type":"Person","name":"AREZKI El Mehdi"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://earezki.com/ai-news/2025-10-24-how-to-mock-amazonsqs-in-unit-tests/"},"description":"Main Heading This article explains how to mock Amazon SQS (Simple Queue Service) in unit tests using dependency injection and Mockito. The approach ensures…"}</script><link rel="stylesheet" href="/_astro/_slug_.Cydfb2eQ.css">
<style>.post-layout[data-astro-cid-rkg3zjxi]{display:grid;grid-template-columns:260px 1fr;gap:2.5rem}.sidebar-left[data-astro-cid-rkg3zjxi]{position:relative}@media (max-width: 1080px){.post-layout[data-astro-cid-rkg3zjxi]{grid-template-columns:1fr}}.ai-disclaimer-article[data-astro-cid-rkg3zjxi]{display:flex;gap:.75rem;padding:.9rem 1.1rem;margin:0 auto 2rem;max-width:780px;background:linear-gradient(135deg,#667eea1a,#764ba21a,#f093fb1a);border:2px solid transparent;border-radius:var(--radius-md);position:relative;background-clip:padding-box;font-size:.85rem}.ai-disclaimer-article[data-astro-cid-rkg3zjxi]:before{content:"";position:absolute;inset:-2px;border-radius:var(--radius-md);padding:2px;background:var(--ai-gradient-border);background-size:200% 200%;animation:gradient-rotate 3s linear infinite;-webkit-mask:linear-gradient(#fff 0 0) content-box,linear-gradient(#fff 0 0);-webkit-mask-composite:xor;mask:linear-gradient(#fff 0 0) content-box,linear-gradient(#fff 0 0);mask-composite:exclude;pointer-events:none}html[data-theme=dark] .ai-disclaimer-article[data-astro-cid-rkg3zjxi]{background:linear-gradient(135deg,#667eea26,#764ba226,#f093fb26)}.ai-disclaimer-article[data-astro-cid-rkg3zjxi] svg[data-astro-cid-rkg3zjxi]{margin-top:.15rem}.ai-disclaimer-article[data-astro-cid-rkg3zjxi] strong[data-astro-cid-rkg3zjxi]{color:var(--color-text);display:block;margin-bottom:.15rem}.ai-disclaimer-article[data-astro-cid-rkg3zjxi] div[data-astro-cid-rkg3zjxi]{line-height:1.5;color:var(--color-text-alt)}
.toc[data-astro-cid-xvrfupwn]{position:sticky;top:90px;max-height:calc(100vh - 120px);overflow:auto;padding:1rem 1rem 1.2rem;background:var(--color-bg-alt);border:1px solid var(--color-border);border-radius:var(--radius-md);font-size:.8rem;line-height:1.3}.toc-title[data-astro-cid-xvrfupwn]{font-weight:600;font-size:.75rem;text-transform:uppercase;letter-spacing:.08em;margin-bottom:.6rem;color:var(--color-text-alt)}.toc[data-astro-cid-xvrfupwn] ul[data-astro-cid-xvrfupwn]{list-style:none;margin:0;padding:0;display:flex;flex-direction:column;gap:.35rem}.toc[data-astro-cid-xvrfupwn] a[data-astro-cid-xvrfupwn]{text-decoration:none;color:var(--color-text-alt)}.toc[data-astro-cid-xvrfupwn] a[data-astro-cid-xvrfupwn]:hover{color:var(--color-accent)}.toc[data-astro-cid-xvrfupwn] li[data-astro-cid-xvrfupwn][class*=d-3]{margin-left:.75rem}.toc[data-astro-cid-xvrfupwn] li[data-astro-cid-xvrfupwn][class*=d-4]{margin-left:1.4rem}@media (max-width: 1080px){.toc[data-astro-cid-xvrfupwn]{display:none}}
</style><script type="module" src="/_astro/hoisted.CwSnpN4J.js"></script></head> <body> <div id="readingProgress" style="position:fixed;left:0;top:0;height:3px;background:linear-gradient(90deg,#2563eb,#9333ea);width:0;z-index:999;transition:width .15s ease;"></div>  <header class="site-header container"> <div class="logo-wrap"> <a class="logo" href="/">Dev|Journal</a> </div> <nav class="main-nav"> <a href="/"> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: -2px; margin-right: 4px;"> <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path> <polyline points="9 22 9 12 15 12 15 22"></polyline> </svg>
Home
</a> <a href="/ai-news/" class="ai-news-link"> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: -2px; margin-right: 4px;"> <path d="M12 2a2 2 0 0 1 2 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 0 1 7 7h-9.5a.5.5 0 0 0-.5.5.5.5 0 0 1-1 0 .5.5 0 0 0-.5-.5H1a7 7 0 0 1 7-7h1V5.73c-.6-.34-1-.99-1-1.73a2 2 0 0 1 2-2z"></path> <path d="M7 15v4a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-4"></path> </svg>
AI News
</a> <a href="/tags/"> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: -2px; margin-right: 4px;"> <path d="M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2z"></path> <circle cx="7" cy="7" r="1.5"></circle> </svg>
Tags
</a> <a href="/about/"> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: -2px; margin-right: 4px;"> <circle cx="12" cy="12" r="10"></circle> <path d="M12 16v-4"></path> <path d="M12 8h.01"></path> </svg>
About
</a> <button id="themeToggle" class="theme-toggle" aria-label="Toggle dark mode"> <span class="theme-icon">☾</span> <span class="theme-text">dark</span> </button> </nav> </header> <main class="container content-area">  <div class="ai-disclaimer-article" data-astro-cid-rkg3zjxi> <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="flex-shrink: 0;" data-astro-cid-rkg3zjxi> <circle cx="12" cy="12" r="10" data-astro-cid-rkg3zjxi></circle> <line x1="12" y1="8" x2="12" y2="12" data-astro-cid-rkg3zjxi></line> <line x1="12" y1="16" x2="12.01" y2="16" data-astro-cid-rkg3zjxi></line> </svg> <div data-astro-cid-rkg3zjxi> <strong data-astro-cid-rkg3zjxi>AI-Generated Content:</strong> This article was created with AI assistance. Please verify important information and check original references.
</div> </div> <div class="post-layout" data-astro-cid-rkg3zjxi> <aside class="sidebar-left" data-astro-cid-rkg3zjxi> <nav class="toc" aria-label="Table of Contents" data-astro-cid-xvrfupwn> <div class="toc-title" data-astro-cid-xvrfupwn>On this page</div> <ul data-astro-cid-xvrfupwn> <li class="d-2" data-astro-cid-xvrfupwn><a href="#main-heading" data-astro-cid-xvrfupwn>Main Heading</a></li><li class="d-3" data-astro-cid-xvrfupwn><a href="#key-concepts-and-implementation" data-astro-cid-xvrfupwn>Key Concepts and Implementation</a></li><li class="d-4" data-astro-cid-xvrfupwn><a href="#1-why-mock-amazon-sqs" data-astro-cid-xvrfupwn>1. **Why Mock Amazon SQS?**</a></li><li class="d-4" data-astro-cid-xvrfupwn><a href="#2-dependencies" data-astro-cid-xvrfupwn>2. **Dependencies**</a></li><li class="d-4" data-astro-cid-xvrfupwn><a href="#3-service-under-test" data-astro-cid-xvrfupwn>3. **Service Under Test**</a></li><li class="d-4" data-astro-cid-xvrfupwn><a href="#4-mocking-synchronous-sqsclient" data-astro-cid-xvrfupwn>4. **Mocking Synchronous `SqsClient`**</a></li><li class="d-4" data-astro-cid-xvrfupwn><a href="#5-mocking-asynchronous-sqsasyncclient" data-astro-cid-xvrfupwn>5. **Mocking Asynchronous `SqsAsyncClient`**</a></li><li class="d-4" data-astro-cid-xvrfupwn><a href="#6-integration-testing-considerations" data-astro-cid-xvrfupwn>6. **Integration Testing Considerations**</a></li><li class="d-4" data-astro-cid-xvrfupwn><a href="#7-conclusion" data-astro-cid-xvrfupwn>7. **Conclusion**</a></li><li class="d-2" data-astro-cid-xvrfupwn><a href="#working-example" data-astro-cid-xvrfupwn>Working Example</a></li><li class="d-3" data-astro-cid-xvrfupwn><a href="#synchronous-test-example" data-astro-cid-xvrfupwn>Synchronous Test Example</a></li><li class="d-2" data-astro-cid-xvrfupwn><a href="#recommendations" data-astro-cid-xvrfupwn>Recommendations</a></li> </ul> </nav>  </aside> <article class="post" data-astro-cid-rkg3zjxi> <header class="post-header" data-astro-cid-rkg3zjxi> <h1 data-astro-cid-rkg3zjxi>How to Mock Amazon SQS in Unit Tests with Dependency Injection and Mockito</h1> <div class="meta" data-astro-cid-rkg3zjxi> <time datetime="2025-10-24T00:00:00.000Z" data-astro-cid-rkg3zjxi>Fri Oct 24 2025</time> <span data-astro-cid-rkg3zjxi>• 3 min read</span> </div> <div class="tag-row" data-astro-cid-rkg3zjxi><a class="tag ai-news-tag" href="/ai-news/" data-astro-cid-rkg3zjxi>AI News</a><span class="tag" data-astro-cid-rkg3zjxi>Cloud</span><span class="tag" data-astro-cid-rkg3zjxi>Testing</span></div> </header> <div class="post-body prose" data-astro-cid-rkg3zjxi> <h2 id="main-heading">Main Heading</h2>
<p>This article explains how to mock Amazon SQS (Simple Queue Service) in unit tests using dependency injection and Mockito. The approach ensures tests are fast, deterministic, and do not require real AWS credentials, while verifying that code constructs the correct requests without interacting with actual SQS endpoints.</p>
<h3 id="key-concepts-and-implementation">Key Concepts and Implementation</h3>
<h4 id="1-why-mock-amazon-sqs">1. <strong>Why Mock Amazon SQS?</strong></h4>
<ul>
<li><strong>Purpose</strong>: Avoid network dependencies, reduce test execution time, and ensure consistent test results.</li>
<li><strong>Impact</strong>: Eliminates reliance on real AWS infrastructure, making tests more reliable and faster.</li>
<li><strong>Benefits</strong>:
<ul>
<li>No need for AWS credentials or internet connectivity.</li>
<li>Enables focused testing of business logic without external service interactions.</li>
</ul>
</li>
</ul>
<h4 id="2-dependencies">2. <strong>Dependencies</strong></h4>
<ul>
<li><strong>AWS SDK for Java</strong>: Required for interacting with SQS.
<ul>
<li>Version used: <code>2.35.10</code></li>
<li>Provides classes like <code>SqsClient</code>, <code>SqsAsyncClient</code>, and request/response models.</li>
</ul>
</li>
<li><strong>Testing Libraries</strong>:
<ul>
<li><strong>JUnit 5</strong>: For writing and running tests.</li>
<li><strong>Mockito</strong>: For creating mock objects and stubbing behavior.</li>
<li><strong>AssertJ</strong>: For assertions in tests.</li>
</ul>
</li>
</ul>
<h4 id="3-service-under-test">3. <strong>Service Under Test</strong></h4>
<ul>
<li><strong>Class</strong>: <code>SqsMessagePublisher</code>
<ul>
<li><strong>Responsibility</strong>: Sends messages to an SQS queue.</li>
<li><strong>Design</strong>: Uses <strong>dependency injection</strong> to accept an <code>SqsClient</code> via constructor.</li>
<li><strong>Code Example</strong>:
<pre class="astro-code github-dark-default" style="background-color:#0d1117;color:#e6edf3; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="java"><code><span class="line"><span style="color:#FF7B72">public</span><span style="color:#FF7B72"> class</span><span style="color:#FFA657"> SqsMessagePublisher</span><span style="color:#E6EDF3"> {</span></span>
<span class="line"><span style="color:#FF7B72">    private</span><span style="color:#FF7B72"> final</span><span style="color:#E6EDF3"> SqsClient</span><span style="color:#E6EDF3"> sqsClient;</span></span>
<span class="line"><span style="color:#FF7B72">    public</span><span style="color:#D2A8FF"> SqsMessagePublisher</span><span style="color:#E6EDF3">(SqsClient </span><span style="color:#FFA657">sqsClient</span><span style="color:#E6EDF3">) {</span></span>
<span class="line"><span style="color:#79C0FF">        this</span><span style="color:#E6EDF3">.sqsClient </span><span style="color:#FF7B72">=</span><span style="color:#E6EDF3"> sqsClient;</span></span>
<span class="line"><span style="color:#E6EDF3">    }</span></span>
<span class="line"><span style="color:#FF7B72">    public</span><span style="color:#E6EDF3"> String </span><span style="color:#D2A8FF">publishMessage</span><span style="color:#E6EDF3">(String </span><span style="color:#FFA657">queueUrl</span><span style="color:#E6EDF3">, String </span><span style="color:#FFA657">messageBody</span><span style="color:#E6EDF3">) {</span></span>
<span class="line"><span style="color:#E6EDF3">        SendMessageRequest</span><span style="color:#E6EDF3"> request</span><span style="color:#FF7B72"> =</span><span style="color:#E6EDF3"> SendMessageRequest.</span><span style="color:#D2A8FF">builder</span><span style="color:#E6EDF3">()</span></span>
<span class="line"><span style="color:#E6EDF3">            .</span><span style="color:#D2A8FF">queueUrl</span><span style="color:#E6EDF3">(queueUrl)</span></span>
<span class="line"><span style="color:#E6EDF3">            .</span><span style="color:#D2A8FF">messageBody</span><span style="color:#E6EDF3">(messageBody)</span></span>
<span class="line"><span style="color:#E6EDF3">            .</span><span style="color:#D2A8FF">build</span><span style="color:#E6EDF3">();</span></span>
<span class="line"><span style="color:#E6EDF3">        SendMessageResponse</span><span style="color:#E6EDF3"> response</span><span style="color:#FF7B72"> =</span><span style="color:#E6EDF3"> sqsClient.</span><span style="color:#D2A8FF">sendMessage</span><span style="color:#E6EDF3">(request);</span></span>
<span class="line"><span style="color:#FF7B72">        return</span><span style="color:#E6EDF3"> response.</span><span style="color:#D2A8FF">messageId</span><span style="color:#E6EDF3">();</span></span>
<span class="line"><span style="color:#E6EDF3">    }</span></span>
<span class="line"><span style="color:#E6EDF3">}</span></span>
<span class="line"></span></code></pre>
</li>
<li><strong>Key Design Principle</strong>: Decouples business logic from the concrete SQS client implementation, enabling easy substitution with a mock in tests.</li>
</ul>
</li>
</ul>
<h4 id="4-mocking-synchronous-sqsclient">4. <strong>Mocking Synchronous <code>SqsClient</code></strong></h4>
<ul>
<li><strong>Test Setup</strong>:
<ul>
<li>Use <code>@Mock</code> to create a mock <code>SqsClient</code>.</li>
<li>Use <code>@InjectMocks</code> to inject the mock into the service under test.</li>
<li>Example:
<pre class="astro-code github-dark-default" style="background-color:#0d1117;color:#e6edf3; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="java"><code><span class="line"><span style="color:#E6EDF3">@</span><span style="color:#FF7B72">ExtendWith</span><span style="color:#E6EDF3">(MockitoExtension.class)</span></span>
<span class="line"><span style="color:#FF7B72">class</span><span style="color:#FFA657"> SqsMessagePublisherUnitTest</span><span style="color:#E6EDF3"> {</span></span>
<span class="line"><span style="color:#E6EDF3">    @</span><span style="color:#FF7B72">Mock</span></span>
<span class="line"><span style="color:#FF7B72">    private</span><span style="color:#E6EDF3"> SqsClient</span><span style="color:#E6EDF3"> sqsClient;</span></span>
<span class="line"><span style="color:#E6EDF3">    @</span><span style="color:#FF7B72">InjectMocks</span></span>
<span class="line"><span style="color:#FF7B72">    private</span><span style="color:#E6EDF3"> SqsMessagePublisher</span><span style="color:#E6EDF3"> messagePublisher;</span></span>
<span class="line"><span style="color:#E6EDF3">}</span></span>
<span class="line"></span></code></pre>
</li>
</ul>
</li>
<li><strong>Test Implementation</strong>:
<ul>
<li><strong>Arrange</strong>:
<ul>
<li>Stub the <code>sendMessage</code> method to return a predefined response.</li>
<li>Example:
<pre class="astro-code github-dark-default" style="background-color:#0d1117;color:#e6edf3; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="java"><code><span class="line"><span style="color:#D2A8FF">when</span><span style="color:#E6EDF3">(sqsClient.</span><span style="color:#D2A8FF">sendMessage</span><span style="color:#E6EDF3">(</span><span style="color:#D2A8FF">any</span><span style="color:#E6EDF3">(SendMessageRequest.class)))</span></span>
<span class="line"><span style="color:#E6EDF3">    .</span><span style="color:#D2A8FF">thenReturn</span><span style="color:#E6EDF3">(mockResponse);</span></span>
<span class="line"></span></code></pre>
</li>
</ul>
</li>
<li><strong>Act</strong>:
<ul>
<li>Call <code>publishMessage</code> to trigger the method under test.</li>
</ul>
</li>
<li><strong>Assert</strong>:
<ul>
<li>Use <code>ArgumentCaptor</code> to verify the <code>SendMessageRequest</code> parameters.</li>
<li>Example:
<pre class="astro-code github-dark-default" style="background-color:#0d1117;color:#e6edf3; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="java"><code><span class="line"><span style="color:#E6EDF3">ArgumentCaptor</span><span style="color:#FFA657">&#x3C;</span><span style="color:#FF7B72">SendMessageRequest</span><span style="color:#FFA657">> </span><span style="color:#E6EDF3">requestCaptor</span><span style="color:#FF7B72"> =</span><span style="color:#E6EDF3"> </span></span>
<span class="line"><span style="color:#E6EDF3">    ArgumentCaptor.</span><span style="color:#D2A8FF">forClass</span><span style="color:#E6EDF3">(SendMessageRequest.class);</span></span>
<span class="line"><span style="color:#D2A8FF">verify</span><span style="color:#E6EDF3">(sqsClient).</span><span style="color:#D2A8FF">sendMessage</span><span style="color:#E6EDF3">(requestCaptor.</span><span style="color:#D2A8FF">capture</span><span style="color:#E6EDF3">());</span></span>
<span class="line"><span style="color:#E6EDF3">SendMessageRequest</span><span style="color:#E6EDF3"> capturedRequest</span><span style="color:#FF7B72"> =</span><span style="color:#E6EDF3"> requestCaptor.</span><span style="color:#D2A8FF">getValue</span><span style="color:#E6EDF3">();</span></span>
<span class="line"><span style="color:#D2A8FF">assertThat</span><span style="color:#E6EDF3">(capturedRequest.</span><span style="color:#D2A8FF">queueUrl</span><span style="color:#E6EDF3">()).</span><span style="color:#D2A8FF">isEqualTo</span><span style="color:#E6EDF3">(queueUrl);</span></span>
<span class="line"><span style="color:#D2A8FF">assertThat</span><span style="color:#E6EDF3">(capturedRequest.</span><span style="color:#D2A8FF">messageBody</span><span style="color:#E6EDF3">()).</span><span style="color:#D2A8FF">isEqualTo</span><span style="color:#E6EDF3">(messageBody);</span></span>
<span class="line"></span></code></pre>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="5-mocking-asynchronous-sqsasyncclient">5. <strong>Mocking Asynchronous <code>SqsAsyncClient</code></strong></h4>
<ul>
<li><strong>Service Class</strong>: <code>SqsAsyncMessagePublisher</code>
<ul>
<li>Uses <code>SqsAsyncClient</code> and returns a <code>CompletableFuture&#x3C;String></code>.</li>
</ul>
</li>
<li><strong>Test Adjustments</strong>:
<ul>
<li>Stub the <code>sendMessage</code> method to return a <code>CompletableFuture</code> wrapped around a mock response.</li>
<li>Example:
<pre class="astro-code github-dark-default" style="background-color:#0d1117;color:#e6edf3; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="java"><code><span class="line"><span style="color:#D2A8FF">when</span><span style="color:#E6EDF3">(sqsAsyncClient.</span><span style="color:#D2A8FF">sendMessage</span><span style="color:#E6EDF3">(</span><span style="color:#D2A8FF">any</span><span style="color:#E6EDF3">(SendMessageRequest.class)))</span></span>
<span class="line"><span style="color:#E6EDF3">    .</span><span style="color:#D2A8FF">thenReturn</span><span style="color:#E6EDF3">(CompletableFuture.</span><span style="color:#D2A8FF">completedFuture</span><span style="color:#E6EDF3">(mockResponse));</span></span>
<span class="line"></span></code></pre>
</li>
<li>Use <code>.get()</code> on the <code>CompletableFuture</code> to retrieve the result synchronously during assertions.</li>
</ul>
</li>
</ul>
<h4 id="6-integration-testing-considerations">6. <strong>Integration Testing Considerations</strong></h4>
<ul>
<li><strong>Limitation of Unit Tests</strong>: Cannot validate IAM permissions, network connectivity, or real queue configurations.</li>
<li><strong>Solution</strong>: Use <strong>Testcontainers</strong> with <strong>LocalStack</strong> to emulate AWS services locally.
<ul>
<li>Allows testing against a real SQS endpoint without actual AWS credentials.</li>
</ul>
</li>
</ul>
<h4 id="7-conclusion">7. <strong>Conclusion</strong></h4>
<ul>
<li><strong>Summary</strong>: Mocking Amazon SQS with Mockito and dependency injection enables fast, reliable unit tests that focus on business logic.</li>
<li><strong>Best Practices</strong>:
<ul>
<li>Always use dependency injection for external services.</li>
<li>Validate request parameters using <code>ArgumentCaptor</code>.</li>
<li>Use <code>CompletableFuture</code> for async clients.</li>
</ul>
</li>
<li><strong>Real-World Use Cases</strong>:
<ul>
<li>Testing message publishing logic in microservices.</li>
<li>Validating error handling for malformed requests.</li>
<li>Ensuring queue URLs and message bodies are correctly formatted.</li>
</ul>
</li>
</ul>
<hr>
<h2 id="working-example">Working Example</h2>
<h3 id="synchronous-test-example">Synchronous Test Example</h3>
<pre class="astro-code github-dark-default" style="background-color:#0d1117;color:#e6edf3; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="java"><code><span class="line"><span style="color:#E6EDF3">@</span><span style="color:#FF7B72">Test</span></span>
<span class="line"><span style="color:#FF7B72">void</span><span style="color:#D2A8FF"> whenPublishMessage_thenMessageIsSentWithCorrectParameters</span><span style="color:#E6EDF3">() {</span></span>
<span class="line"><span style="color:#8B949E">    // Arrange</span></span>
<span class="line"><span style="color:#E6EDF3">    String</span><span style="color:#E6EDF3"> queueUrl</span><span style="color:#FF7B72"> =</span><span style="color:#A5D6FF"> "https://sqs.us-east-1.amazonaws.com/123456789012/MyQueue"</span><span style="color:#E6EDF3">;</span></span>
<span class="line"><span style="color:#E6EDF3">    String</span><span style="color:#E6EDF3"> messageBody</span><span style="color:#FF7B72"> =</span><span style="color:#A5D6FF"> "Hello, SQS!"</span><span style="color:#E6EDF3">;</span></span>
<span class="line"><span style="color:#E6EDF3">    String</span><span style="color:#E6EDF3"> expectedMessageId</span><span style="color:#FF7B72"> =</span><span style="color:#A5D6FF"> "test-message-id-123"</span><span style="color:#E6EDF3">;</span></span>
<span class="line"><span style="color:#E6EDF3">    SendMessageResponse</span><span style="color:#E6EDF3"> mockResponse</span><span style="color:#FF7B72"> =</span><span style="color:#E6EDF3"> SendMessageResponse.</span><span style="color:#D2A8FF">builder</span><span style="color:#E6EDF3">()</span></span>
<span class="line"><span style="color:#E6EDF3">        .</span><span style="color:#D2A8FF">messageId</span><span style="color:#E6EDF3">(expectedMessageId)</span></span>
<span class="line"><span style="color:#E6EDF3">        .</span><span style="color:#D2A8FF">build</span><span style="color:#E6EDF3">();</span></span>
<span class="line"><span style="color:#D2A8FF">    when</span><span style="color:#E6EDF3">(sqsClient.</span><span style="color:#D2A8FF">sendMessage</span><span style="color:#E6EDF3">(</span><span style="color:#D2A8FF">any</span><span style="color:#E6EDF3">(SendMessageRequest.class))).</span><span style="color:#D2A8FF">thenReturn</span><span style="color:#E6EDF3">(mockResponse);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E">    // Act</span></span>
<span class="line"><span style="color:#E6EDF3">    String</span><span style="color:#E6EDF3"> actualMessageId</span><span style="color:#FF7B72"> =</span><span style="color:#E6EDF3"> messagePublisher.</span><span style="color:#D2A8FF">publishMessage</span><span style="color:#E6EDF3">(queueUrl, messageBody);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E">    // Assert</span></span>
<span class="line"><span style="color:#D2A8FF">    assertThat</span><span style="color:#E6EDF3">(actualMessageId).</span><span style="color:#D2A8FF">isEqualTo</span><span style="color:#E6EDF3">(expectedMessageId);</span></span>
<span class="line"><span style="color:#E6EDF3">    ArgumentCaptor</span><span style="color:#FFA657">&#x3C;</span><span style="color:#FF7B72">SendMessageRequest</span><span style="color:#FFA657">> </span><span style="color:#E6EDF3">requestCaptor</span><span style="color:#FF7B72"> =</span><span style="color:#E6EDF3"> </span></span>
<span class="line"><span style="color:#E6EDF3">        ArgumentCaptor.</span><span style="color:#D2A8FF">forClass</span><span style="color:#E6EDF3">(SendMessageRequest.class);</span></span>
<span class="line"><span style="color:#D2A8FF">    verify</span><span style="color:#E6EDF3">(sqsClient).</span><span style="color:#D2A8FF">sendMessage</span><span style="color:#E6EDF3">(requestCaptor.</span><span style="color:#D2A8FF">capture</span><span style="color:#E6EDF3">());</span></span>
<span class="line"><span style="color:#E6EDF3">    SendMessageRequest</span><span style="color:#E6EDF3"> capturedRequest</span><span style="color:#FF7B72"> =</span><span style="color:#E6EDF3"> requestCaptor.</span><span style="color:#D2A8FF">getValue</span><span style="color:#E6EDF3">();</span></span>
<span class="line"><span style="color:#D2A8FF">    assertThat</span><span style="color:#E6EDF3">(capturedRequest.</span><span style="color:#D2A8FF">queueUrl</span><span style="color:#E6EDF3">()).</span><span style="color:#D2A8FF">isEqualTo</span><span style="color:#E6EDF3">(queueUrl);</span></span>
<span class="line"><span style="color:#D2A8FF">    assertThat</span><span style="color:#E6EDF3">(capturedRequest.</span><span style="color:#D2A8FF">messageBody</span><span style="color:#E6EDF3">()).</span><span style="color:#D2A8FF">isEqualTo</span><span style="color:#E6EDF3">(messageBody);</span></span>
<span class="line"><span style="color:#E6EDF3">}</span></span>
<span class="line"></span></code></pre>
<hr>
<h2 id="recommendations">Recommendations</h2>
<ul>
<li><strong>When to Use This Approach</strong>:
<ul>
<li>When testing code that interacts with external services like SQS.</li>
<li>When you need to isolate business logic from infrastructure dependencies.</li>
</ul>
</li>
<li><strong>Best Practices</strong>:
<ul>
<li>Always mock external services to avoid network latency.</li>
<li>Use <code>ArgumentCaptor</code> to inspect request parameters.</li>
<li>For async clients, ensure <code>CompletableFuture</code> is properly stubbed.</li>
</ul>
</li>
<li><strong>Pitfalls to Avoid</strong>:
<ul>
<li>Forgetting to mock dependencies, leading to real service calls.</li>
<li>Not verifying request parameters, resulting in incomplete test coverage.</li>
<li>Using hardcoded values instead of dynamic mocking for flexibility.</li>
</ul>
</li>
</ul>
<hr>
<p><strong>Reference</strong>: <a href="https://www.baeldung.com/java-mock-amazonsqs-unit-tests">How to Mock AmazonSQS in Unit Tests | Baeldung</a></p> </div> </article> </div> <div class="back-link" data-astro-cid-rkg3zjxi><a href="/ai-news/" data-astro-cid-rkg3zjxi>← Back to AI News</a></div>  </main> <footer class="site-footer container"> <p>© 2025 AREZKI El Mehdi • <a href="https://github.com/earezki">GitHub</a> • <a href="/rss.xml">RSS</a></p> </footer>  <script>
      // Read/Unread article tracking
      (function() {
        const STORAGE_KEY = 'readArticles';
        
        function getReadArticles() {
          try {
            const data = localStorage.getItem(STORAGE_KEY);
            return data ? JSON.parse(data) : [];
          } catch (e) {
            return [];
          }
        }
        
        function markArticleAsRead(url) {
          try {
            const readArticles = getReadArticles();
            if (!readArticles.includes(url)) {
              readArticles.push(url);
              localStorage.setItem(STORAGE_KEY, JSON.stringify(readArticles));
            }
          } catch (e) {
            console.error('Failed to mark article as read:', e);
          }
        }
        
        function isArticleRead(url) {
          const readArticles = getReadArticles();
          return readArticles.includes(url);
        }
        
        // Update post cards on list pages
        function updatePostCards() {
          const postCards = document.querySelectorAll('.post-card[data-article-url]');
          postCards.forEach(function(card) {
            const url = card.getAttribute('data-article-url');
            if (url) {
              if (isArticleRead(url)) {
                card.classList.add('read');
                card.classList.remove('unread');
              } else {
                card.classList.add('unread');
                card.classList.remove('read');
              }
            }
          });
        }
        
        // Mark current article as read (on article pages)
        function markCurrentArticleAsRead() {
          const isArticlePage = document.querySelector('.post-body');
          if (isArticlePage) {
            const currentPath = window.location.pathname;
            markArticleAsRead(currentPath);
          }
        }
        
        // Initialize function
        function init() {
          updatePostCards();
          markCurrentArticleAsRead();
        }
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', init);
        
        // Handle back/forward navigation (bfcache)
        window.addEventListener('pageshow', function(event) {
          // If page is loaded from cache, update the cards
          if (event.persisted) {
            init();
          }
        });
      })();
    </script> </body> </html> 