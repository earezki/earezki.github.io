<!DOCTYPE html><html lang="en" data-theme="dark"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><!-- Primary Meta Tags --><title>How to Mock Amazon SQS in Unit Tests with Dependency Injection and Mockito • Dev|Journal</title><meta name="description" content="Main Heading This article explains how to mock Amazon SQS (Simple Queue Service) in unit tests using dependency injection and Mockito. The approach ensures…"><meta name="keywords" content="software architecture, backend development, microservices, Java, Python, Spring Boot, technical blog"><meta name="author" content="El Mehdi Arezki"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://earezki.com/ai-news/2025-10-24-how-to-mock-amazonsqs-in-unit-tests/"><meta property="og:title" content="How to Mock Amazon SQS in Unit Tests with Dependency Injection and Mockito • Dev|Journal"><meta property="og:site_name" content="Dev|Journal"><meta property="og:description" content="Main Heading This article explains how to mock Amazon SQS (Simple Queue Service) in unit tests using dependency injection and Mockito. The approach ensures…"><meta property="og:image" content="https://earezki.com/assets/og-image-default.jpg"><!-- Twitter --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:url" content="https://earezki.com/ai-news/2025-10-24-how-to-mock-amazonsqs-in-unit-tests/"><meta name="twitter:title" content="How to Mock Amazon SQS in Unit Tests with Dependency Injection and Mockito • Dev|Journal"><meta name="twitter:description" content="Main Heading This article explains how to mock Amazon SQS (Simple Queue Service) in unit tests using dependency injection and Mockito. The approach ensures…"><meta name="twitter:image" content="https://earezki.com/assets/og-image-default.jpg"><meta name="twitter:creator" content="@earezki"><!-- Canonical and Indexing --><link rel="canonical" href="https://earezki.com/ai-news/2025-10-24-how-to-mock-amazonsqs-in-unit-tests/"><!-- Favicons --><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="icon" type="image/x-icon" href="/favicon.ico"><!-- RSS Feed --><link rel="alternate" type="application/rss+xml" title="RSS" href="/rss.xml"><!-- Analytics: Google Analytics (Legacy UA) --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-161447264-1"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);} 
      gtag('js', new Date()); 
      gtag('config', 'UA-161447264-1');
    </script><!-- Analytics: Umami --><script defer src="https://cloud.umami.is/script.js" data-website-id="4a26531d-1053-4f79-97a6-06a1366aff91"></script><!-- Theme Persistence (runs before page render to prevent flash) --><script>
      (function() {
        const theme = localStorage.getItem('theme');
        if (theme) { 
          document.documentElement.setAttribute('data-theme', theme); 
        }
      })();
    </script><!-- Structured Data (JSON-LD) --><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"How to Mock Amazon SQS in Unit Tests with Dependency Injection and Mockito","datePublished":"2025-10-24T00:00:00.000Z","dateModified":"2025-10-24T00:00:00.000Z","author":{"@type":"Person","name":"AREZKI El Mehdi"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://earezki.com/ai-news/2025-10-24-how-to-mock-amazonsqs-in-unit-tests/"},"description":"Main Heading This article explains how to mock Amazon SQS (Simple Queue Service) in unit tests using dependency injection and Mockito. The approach ensures…"}</script><link rel="stylesheet" href="/_astro/_slug_.DxE91F05.css">
<style>.toc[data-astro-cid-xvrfupwn]{position:sticky;top:90px;max-height:calc(100vh - 120px);overflow:auto;padding:1rem 1rem 1.2rem;background:var(--color-bg-alt);border:1px solid var(--color-border);border-radius:var(--radius-md);font-size:.8rem;line-height:1.3}.toc-title[data-astro-cid-xvrfupwn]{font-weight:600;font-size:.75rem;text-transform:uppercase;letter-spacing:.08em;margin-bottom:.6rem;color:var(--color-text-alt)}.toc[data-astro-cid-xvrfupwn] ul[data-astro-cid-xvrfupwn]{list-style:none;margin:0;padding:0;display:flex;flex-direction:column;gap:.35rem}.toc[data-astro-cid-xvrfupwn] a[data-astro-cid-xvrfupwn]{text-decoration:none;color:var(--color-text-alt);transition:color var(--transition)}.toc[data-astro-cid-xvrfupwn] a[data-astro-cid-xvrfupwn]:hover{color:var(--color-accent)}.toc[data-astro-cid-xvrfupwn] li[data-astro-cid-xvrfupwn][class*=d-3]{margin-left:.75rem}.toc[data-astro-cid-xvrfupwn] li[data-astro-cid-xvrfupwn][class*=d-4]{margin-left:1.4rem}@media (max-width: 1080px){.toc[data-astro-cid-xvrfupwn]{display:none}}.breadcrumbs[data-astro-cid-ilhxcym7]{margin:0 0 1.5rem;font-size:.85rem}.breadcrumbs[data-astro-cid-ilhxcym7] ol[data-astro-cid-ilhxcym7]{list-style:none;padding:0;margin:0;display:flex;flex-wrap:wrap;align-items:center;gap:.5rem}.breadcrumbs[data-astro-cid-ilhxcym7] li[data-astro-cid-ilhxcym7]{display:flex;align-items:center;gap:.5rem}.breadcrumbs[data-astro-cid-ilhxcym7] a[data-astro-cid-ilhxcym7]{color:var(--color-text-alt);text-decoration:none;transition:color var(--transition)}.breadcrumbs[data-astro-cid-ilhxcym7] a[data-astro-cid-ilhxcym7]:hover{color:var(--color-accent);text-decoration:underline}.breadcrumbs[data-astro-cid-ilhxcym7] .separator[data-astro-cid-ilhxcym7]{color:var(--color-text-alt);opacity:.5;user-select:none}.breadcrumbs[data-astro-cid-ilhxcym7] .current[data-astro-cid-ilhxcym7]{color:var(--color-text);font-weight:500}.related-posts[data-astro-cid-dpgbfi7r]{margin:3rem 0;padding-top:2rem;border-top:2px solid var(--color-border)}.related-posts[data-astro-cid-dpgbfi7r] h2[data-astro-cid-dpgbfi7r]{font-size:1.5rem;margin:0 0 1.5rem;color:var(--color-text)}.related-posts-grid[data-astro-cid-dpgbfi7r]{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1.5rem}.related-post-card[data-astro-cid-dpgbfi7r]{background:var(--color-bg-alt);border:1px solid var(--color-border);border-radius:var(--radius-md);padding:1.25rem;transition:all var(--transition)}.related-post-card[data-astro-cid-dpgbfi7r]:hover{border-color:var(--color-accent);transform:translateY(-2px);box-shadow:var(--shadow-md)}.related-post-link[data-astro-cid-dpgbfi7r]{text-decoration:none;color:inherit;display:block}.related-post-card[data-astro-cid-dpgbfi7r] h3[data-astro-cid-dpgbfi7r]{margin:0 0 .75rem;font-size:1.1rem;font-weight:600;color:var(--color-text);line-height:1.3}.related-post-link[data-astro-cid-dpgbfi7r]:hover h3[data-astro-cid-dpgbfi7r]{color:var(--color-accent)}.related-excerpt[data-astro-cid-dpgbfi7r]{font-size:.85rem;color:var(--color-text-alt);line-height:1.5;margin:0 0 .75rem}.related-meta[data-astro-cid-dpgbfi7r]{font-size:.75rem;color:var(--color-text-alt);display:flex;gap:.5rem;align-items:center}@media (max-width: 680px){.related-posts-grid[data-astro-cid-dpgbfi7r]{grid-template-columns:1fr}}
.post-layout[data-astro-cid-rkg3zjxi]{display:grid;grid-template-columns:260px 1fr;gap:2.5rem}.sidebar-left[data-astro-cid-rkg3zjxi]{position:relative}@media (max-width: 1080px){.post-layout[data-astro-cid-rkg3zjxi]{grid-template-columns:1fr}}.ai-disclaimer-article[data-astro-cid-rkg3zjxi]{display:flex;gap:.75rem;padding:.9rem 1.1rem;margin:0 auto 2rem;max-width:780px;background:linear-gradient(135deg,#667eea1a,#764ba21a,#f093fb1a);border:2px solid transparent;border-radius:var(--radius-md);position:relative;background-clip:padding-box;font-size:.85rem}.ai-disclaimer-article[data-astro-cid-rkg3zjxi]:before{content:"";position:absolute;inset:-2px;border-radius:var(--radius-md);padding:2px;background:var(--ai-gradient-border);background-size:200% 200%;animation:gradient-rotate 3s linear infinite;-webkit-mask:linear-gradient(#fff 0 0) content-box,linear-gradient(#fff 0 0);-webkit-mask-composite:xor;mask:linear-gradient(#fff 0 0) content-box,linear-gradient(#fff 0 0);mask-composite:exclude;pointer-events:none}html[data-theme=dark] .ai-disclaimer-article[data-astro-cid-rkg3zjxi]{background:linear-gradient(135deg,#667eea26,#764ba226,#f093fb26)}.ai-disclaimer-article[data-astro-cid-rkg3zjxi] svg[data-astro-cid-rkg3zjxi]{margin-top:.15rem}.ai-disclaimer-article[data-astro-cid-rkg3zjxi] strong[data-astro-cid-rkg3zjxi]{color:var(--color-text);display:block;margin-bottom:.15rem}.ai-disclaimer-article[data-astro-cid-rkg3zjxi] div[data-astro-cid-rkg3zjxi]{line-height:1.5;color:var(--color-text-alt)}
</style><script type="module" src="/_astro/hoisted.2U5tn40l.js"></script></head> <body> <div id="readingProgress" role="progressbar" aria-label="Reading progress" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="position:fixed;left:0;top:0;height:3px;background:linear-gradient(90deg,#2563eb,#9333ea);width:0;z-index:999;transition:width .15s ease;"></div>  <!-- Site Header --> <header class="site-header container"> <div class="logo-wrap"> <a class="logo" href="/" aria-label="Dev|Journal Home">
Dev|Journal
</a> </div> <nav class="main-nav" aria-label="Main navigation"> <a href="/"> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" style="vertical-align: -2px; margin-right: 4px;"> <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path> <polyline points="9 22 9 12 15 12 15 22"></polyline> </svg>
Home
</a> <a href="/ai-news/" class="ai-news-link"> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" style="vertical-align: -2px; margin-right: 4px;"> <path d="M12 2a2 2 0 0 1 2 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 0 1 7 7h-9.5a.5.5 0 0 0-.5.5.5.5 0 0 1-1 0 .5.5 0 0 0-.5-.5H1a7 7 0 0 1 7-7h1V5.73c-.6-.34-1-.99-1-1.73a2 2 0 0 1 2-2z"></path> <path d="M7 15v4a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-4"></path> </svg>
AI News
</a> <a href="/tags/"> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" style="vertical-align: -2px; margin-right: 4px;"> <path d="M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2z"></path> <circle cx="7" cy="7" r="1.5"></circle> </svg>
Tags
</a> <a href="/about/"> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" style="vertical-align: -2px; margin-right: 4px;"> <circle cx="12" cy="12" r="10"></circle> <path d="M12 16v-4"></path> <path d="M12 8h.01"></path> </svg>
About
</a> <button id="themeToggle" class="theme-toggle" aria-label="Toggle dark mode"> <span class="theme-icon" aria-hidden="true">☾</span> <span class="theme-text">dark</span> </button> </nav> </header> <!-- Main Content --> <main class="container content-area">  <nav class="breadcrumbs" aria-label="Breadcrumb" data-astro-cid-ilhxcym7> <ol data-astro-cid-ilhxcym7> <li data-astro-cid-ilhxcym7>  <a href="/" data-astro-cid-ilhxcym7>Home</a> <span class="separator" aria-hidden="true" data-astro-cid-ilhxcym7>/</span>  </li><li data-astro-cid-ilhxcym7>  <a href="/ai-news/" data-astro-cid-ilhxcym7>Ai News</a> <span class="separator" aria-hidden="true" data-astro-cid-ilhxcym7>/</span>  </li><li data-astro-cid-ilhxcym7> <span class="current" aria-current="page" data-astro-cid-ilhxcym7>How to Mock Amazon SQS in Unit Tests with Dependency Injection and Mockito</span> </li> </ol> </nav>  <div class="ai-disclaimer-article" data-astro-cid-rkg3zjxi> <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="flex-shrink: 0;" data-astro-cid-rkg3zjxi> <circle cx="12" cy="12" r="10" data-astro-cid-rkg3zjxi></circle> <line x1="12" y1="8" x2="12" y2="12" data-astro-cid-rkg3zjxi></line> <line x1="12" y1="16" x2="12.01" y2="16" data-astro-cid-rkg3zjxi></line> </svg> <div data-astro-cid-rkg3zjxi> <strong data-astro-cid-rkg3zjxi>AI-Generated Content:</strong> This article was created with AI assistance. Please verify important information and check original references.
</div> </div> <div class="post-layout" data-astro-cid-rkg3zjxi> <aside class="sidebar-left" data-astro-cid-rkg3zjxi> <nav class="toc" aria-label="Table of Contents" data-astro-cid-xvrfupwn> <div class="toc-title" data-astro-cid-xvrfupwn>On this page</div> <ul data-astro-cid-xvrfupwn> <li class="d-2" data-astro-cid-xvrfupwn> <a href="#main-heading" data-astro-cid-xvrfupwn> Main Heading </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#key-concepts-and-implementation" data-astro-cid-xvrfupwn> Key Concepts and Implementation </a> </li><li class="d-4" data-astro-cid-xvrfupwn> <a href="#1-why-mock-amazon-sqs" data-astro-cid-xvrfupwn> 1. **Why Mock Amazon SQS?** </a> </li><li class="d-4" data-astro-cid-xvrfupwn> <a href="#2-dependencies" data-astro-cid-xvrfupwn> 2. **Dependencies** </a> </li><li class="d-4" data-astro-cid-xvrfupwn> <a href="#3-service-under-test" data-astro-cid-xvrfupwn> 3. **Service Under Test** </a> </li><li class="d-4" data-astro-cid-xvrfupwn> <a href="#4-mocking-synchronous-sqsclient" data-astro-cid-xvrfupwn> 4. **Mocking Synchronous `SqsClient`** </a> </li><li class="d-4" data-astro-cid-xvrfupwn> <a href="#5-mocking-asynchronous-sqsasyncclient" data-astro-cid-xvrfupwn> 5. **Mocking Asynchronous `SqsAsyncClient`** </a> </li><li class="d-4" data-astro-cid-xvrfupwn> <a href="#6-integration-testing-considerations" data-astro-cid-xvrfupwn> 6. **Integration Testing Considerations** </a> </li><li class="d-4" data-astro-cid-xvrfupwn> <a href="#7-conclusion" data-astro-cid-xvrfupwn> 7. **Conclusion** </a> </li><li class="d-2" data-astro-cid-xvrfupwn> <a href="#working-example" data-astro-cid-xvrfupwn> Working Example </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#synchronous-test-example" data-astro-cid-xvrfupwn> Synchronous Test Example </a> </li><li class="d-2" data-astro-cid-xvrfupwn> <a href="#recommendations" data-astro-cid-xvrfupwn> Recommendations </a> </li> </ul> </nav>  </aside> <article class="post" data-astro-cid-rkg3zjxi> <header class="post-header" data-astro-cid-rkg3zjxi> <h1 data-astro-cid-rkg3zjxi>How to Mock Amazon SQS in Unit Tests with Dependency Injection and Mockito</h1> <div class="meta" data-astro-cid-rkg3zjxi> <time datetime="2025-10-24T00:00:00.000Z" data-astro-cid-rkg3zjxi>Fri Oct 24 2025</time> <span data-astro-cid-rkg3zjxi>• 3 min read</span> </div> <div class="tag-row" data-astro-cid-rkg3zjxi><a class="tag ai-news-tag" href="/tags/ai-news/" data-astro-cid-rkg3zjxi>AI News</a><a class="tag " href="/tags/cloud/" data-astro-cid-rkg3zjxi>Cloud</a><a class="tag " href="/tags/testing/" data-astro-cid-rkg3zjxi>Testing</a></div> </header> <div class="post-body prose" data-astro-cid-rkg3zjxi> <h2 id="main-heading">Main Heading</h2>
<p>This article explains how to mock Amazon SQS (Simple Queue Service) in unit tests using dependency injection and Mockito. The approach ensures tests are fast, deterministic, and do not require real AWS credentials, while verifying that code constructs the correct requests without interacting with actual SQS endpoints.</p>
<h3 id="key-concepts-and-implementation">Key Concepts and Implementation</h3>
<h4 id="1-why-mock-amazon-sqs">1. <strong>Why Mock Amazon SQS?</strong></h4>
<ul>
<li><strong>Purpose</strong>: Avoid network dependencies, reduce test execution time, and ensure consistent test results.</li>
<li><strong>Impact</strong>: Eliminates reliance on real AWS infrastructure, making tests more reliable and faster.</li>
<li><strong>Benefits</strong>:
<ul>
<li>No need for AWS credentials or internet connectivity.</li>
<li>Enables focused testing of business logic without external service interactions.</li>
</ul>
</li>
</ul>
<h4 id="2-dependencies">2. <strong>Dependencies</strong></h4>
<ul>
<li><strong>AWS SDK for Java</strong>: Required for interacting with SQS.
<ul>
<li>Version used: <code>2.35.10</code></li>
<li>Provides classes like <code>SqsClient</code>, <code>SqsAsyncClient</code>, and request/response models.</li>
</ul>
</li>
<li><strong>Testing Libraries</strong>:
<ul>
<li><strong>JUnit 5</strong>: For writing and running tests.</li>
<li><strong>Mockito</strong>: For creating mock objects and stubbing behavior.</li>
<li><strong>AssertJ</strong>: For assertions in tests.</li>
</ul>
</li>
</ul>
<h4 id="3-service-under-test">3. <strong>Service Under Test</strong></h4>
<ul>
<li><strong>Class</strong>: <code>SqsMessagePublisher</code>
<ul>
<li><strong>Responsibility</strong>: Sends messages to an SQS queue.</li>
<li><strong>Design</strong>: Uses <strong>dependency injection</strong> to accept an <code>SqsClient</code> via constructor.</li>
<li><strong>Code Example</strong>:
<pre class="language-java" data-language="java"><code is:raw="" class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SqsMessagePublisher</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">SqsClient</span> sqsClient<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">SqsMessagePublisher</span><span class="token punctuation">(</span><span class="token class-name">SqsClient</span> sqsClient<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>sqsClient <span class="token operator">=</span> sqsClient<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">publishMessage</span><span class="token punctuation">(</span><span class="token class-name">String</span> queueUrl<span class="token punctuation">,</span> <span class="token class-name">String</span> messageBody<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SendMessageRequest</span> request <span class="token operator">=</span> <span class="token class-name">SendMessageRequest</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">queueUrl</span><span class="token punctuation">(</span>queueUrl<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">messageBody</span><span class="token punctuation">(</span>messageBody<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SendMessageResponse</span> response <span class="token operator">=</span> sqsClient<span class="token punctuation">.</span><span class="token function">sendMessage</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> response<span class="token punctuation">.</span><span class="token function">messageId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</li>
<li><strong>Key Design Principle</strong>: Decouples business logic from the concrete SQS client implementation, enabling easy substitution with a mock in tests.</li>
</ul>
</li>
</ul>
<h4 id="4-mocking-synchronous-sqsclient">4. <strong>Mocking Synchronous <code>SqsClient</code></strong></h4>
<ul>
<li><strong>Test Setup</strong>:
<ul>
<li>Use <code>@Mock</code> to create a mock <code>SqsClient</code>.</li>
<li>Use <code>@InjectMocks</code> to inject the mock into the service under test.</li>
<li>Example:
<pre class="language-java" data-language="java"><code is:raw="" class="language-java"><span class="token annotation punctuation">@ExtendWith</span><span class="token punctuation">(</span><span class="token class-name">MockitoExtension</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">SqsMessagePublisherUnitTest</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Mock</span>
    <span class="token keyword">private</span> <span class="token class-name">SqsClient</span> sqsClient<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@InjectMocks</span>
    <span class="token keyword">private</span> <span class="token class-name">SqsMessagePublisher</span> messagePublisher<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</li>
</ul>
</li>
<li><strong>Test Implementation</strong>:
<ul>
<li><strong>Arrange</strong>:
<ul>
<li>Stub the <code>sendMessage</code> method to return a predefined response.</li>
<li>Example:
<pre class="language-java" data-language="java"><code is:raw="" class="language-java"><span class="token function">when</span><span class="token punctuation">(</span>sqsClient<span class="token punctuation">.</span><span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token class-name">SendMessageRequest</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">thenReturn</span><span class="token punctuation">(</span>mockResponse<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
</li>
</ul>
</li>
<li><strong>Act</strong>:
<ul>
<li>Call <code>publishMessage</code> to trigger the method under test.</li>
</ul>
</li>
<li><strong>Assert</strong>:
<ul>
<li>Use <code>ArgumentCaptor</code> to verify the <code>SendMessageRequest</code> parameters.</li>
<li>Example:
<pre class="language-java" data-language="java"><code is:raw="" class="language-java"><span class="token class-name">ArgumentCaptor</span><span class="token generics"><span class="token punctuation">&#x3C;</span><span class="token class-name">SendMessageRequest</span><span class="token punctuation">></span></span> requestCaptor <span class="token operator">=</span> 
    <span class="token class-name">ArgumentCaptor</span><span class="token punctuation">.</span><span class="token function">forClass</span><span class="token punctuation">(</span><span class="token class-name">SendMessageRequest</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">verify</span><span class="token punctuation">(</span>sqsClient<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendMessage</span><span class="token punctuation">(</span>requestCaptor<span class="token punctuation">.</span><span class="token function">capture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">SendMessageRequest</span> capturedRequest <span class="token operator">=</span> requestCaptor<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">assertThat</span><span class="token punctuation">(</span>capturedRequest<span class="token punctuation">.</span><span class="token function">queueUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isEqualTo</span><span class="token punctuation">(</span>queueUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">assertThat</span><span class="token punctuation">(</span>capturedRequest<span class="token punctuation">.</span><span class="token function">messageBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isEqualTo</span><span class="token punctuation">(</span>messageBody<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="5-mocking-asynchronous-sqsasyncclient">5. <strong>Mocking Asynchronous <code>SqsAsyncClient</code></strong></h4>
<ul>
<li><strong>Service Class</strong>: <code>SqsAsyncMessagePublisher</code>
<ul>
<li>Uses <code>SqsAsyncClient</code> and returns a <code>CompletableFuture&#x3C;String></code>.</li>
</ul>
</li>
<li><strong>Test Adjustments</strong>:
<ul>
<li>Stub the <code>sendMessage</code> method to return a <code>CompletableFuture</code> wrapped around a mock response.</li>
<li>Example:
<pre class="language-java" data-language="java"><code is:raw="" class="language-java"><span class="token function">when</span><span class="token punctuation">(</span>sqsAsyncClient<span class="token punctuation">.</span><span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token class-name">SendMessageRequest</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">thenReturn</span><span class="token punctuation">(</span><span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">completedFuture</span><span class="token punctuation">(</span>mockResponse<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
</li>
<li>Use <code>.get()</code> on the <code>CompletableFuture</code> to retrieve the result synchronously during assertions.</li>
</ul>
</li>
</ul>
<h4 id="6-integration-testing-considerations">6. <strong>Integration Testing Considerations</strong></h4>
<ul>
<li><strong>Limitation of Unit Tests</strong>: Cannot validate IAM permissions, network connectivity, or real queue configurations.</li>
<li><strong>Solution</strong>: Use <strong>Testcontainers</strong> with <strong>LocalStack</strong> to emulate AWS services locally.
<ul>
<li>Allows testing against a real SQS endpoint without actual AWS credentials.</li>
</ul>
</li>
</ul>
<h4 id="7-conclusion">7. <strong>Conclusion</strong></h4>
<ul>
<li><strong>Summary</strong>: Mocking Amazon SQS with Mockito and dependency injection enables fast, reliable unit tests that focus on business logic.</li>
<li><strong>Best Practices</strong>:
<ul>
<li>Always use dependency injection for external services.</li>
<li>Validate request parameters using <code>ArgumentCaptor</code>.</li>
<li>Use <code>CompletableFuture</code> for async clients.</li>
</ul>
</li>
<li><strong>Real-World Use Cases</strong>:
<ul>
<li>Testing message publishing logic in microservices.</li>
<li>Validating error handling for malformed requests.</li>
<li>Ensuring queue URLs and message bodies are correctly formatted.</li>
</ul>
</li>
</ul>
<hr>
<h2 id="working-example">Working Example</h2>
<h3 id="synchronous-test-example">Synchronous Test Example</h3>
<pre class="language-java" data-language="java"><code is:raw="" class="language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token function">whenPublishMessage_thenMessageIsSentWithCorrectParameters</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Arrange</span>
    <span class="token class-name">String</span> queueUrl <span class="token operator">=</span> <span class="token string">"https://sqs.us-east-1.amazonaws.com/123456789012/MyQueue"</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> messageBody <span class="token operator">=</span> <span class="token string">"Hello, SQS!"</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> expectedMessageId <span class="token operator">=</span> <span class="token string">"test-message-id-123"</span><span class="token punctuation">;</span>
    <span class="token class-name">SendMessageResponse</span> mockResponse <span class="token operator">=</span> <span class="token class-name">SendMessageResponse</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">messageId</span><span class="token punctuation">(</span>expectedMessageId<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">when</span><span class="token punctuation">(</span>sqsClient<span class="token punctuation">.</span><span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token class-name">SendMessageRequest</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">thenReturn</span><span class="token punctuation">(</span>mockResponse<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Act</span>
    <span class="token class-name">String</span> actualMessageId <span class="token operator">=</span> messagePublisher<span class="token punctuation">.</span><span class="token function">publishMessage</span><span class="token punctuation">(</span>queueUrl<span class="token punctuation">,</span> messageBody<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Assert</span>
    <span class="token function">assertThat</span><span class="token punctuation">(</span>actualMessageId<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isEqualTo</span><span class="token punctuation">(</span>expectedMessageId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">ArgumentCaptor</span><span class="token generics"><span class="token punctuation">&#x3C;</span><span class="token class-name">SendMessageRequest</span><span class="token punctuation">></span></span> requestCaptor <span class="token operator">=</span> 
        <span class="token class-name">ArgumentCaptor</span><span class="token punctuation">.</span><span class="token function">forClass</span><span class="token punctuation">(</span><span class="token class-name">SendMessageRequest</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">verify</span><span class="token punctuation">(</span>sqsClient<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendMessage</span><span class="token punctuation">(</span>requestCaptor<span class="token punctuation">.</span><span class="token function">capture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">SendMessageRequest</span> capturedRequest <span class="token operator">=</span> requestCaptor<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">assertThat</span><span class="token punctuation">(</span>capturedRequest<span class="token punctuation">.</span><span class="token function">queueUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isEqualTo</span><span class="token punctuation">(</span>queueUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">assertThat</span><span class="token punctuation">(</span>capturedRequest<span class="token punctuation">.</span><span class="token function">messageBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isEqualTo</span><span class="token punctuation">(</span>messageBody<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<hr>
<h2 id="recommendations">Recommendations</h2>
<ul>
<li><strong>When to Use This Approach</strong>:
<ul>
<li>When testing code that interacts with external services like SQS.</li>
<li>When you need to isolate business logic from infrastructure dependencies.</li>
</ul>
</li>
<li><strong>Best Practices</strong>:
<ul>
<li>Always mock external services to avoid network latency.</li>
<li>Use <code>ArgumentCaptor</code> to inspect request parameters.</li>
<li>For async clients, ensure <code>CompletableFuture</code> is properly stubbed.</li>
</ul>
</li>
<li><strong>Pitfalls to Avoid</strong>:
<ul>
<li>Forgetting to mock dependencies, leading to real service calls.</li>
<li>Not verifying request parameters, resulting in incomplete test coverage.</li>
<li>Using hardcoded values instead of dynamic mocking for flexibility.</li>
</ul>
</li>
</ul>
<hr>
<p><strong>Reference</strong>: <a href="https://www.baeldung.com/java-mock-amazonsqs-unit-tests">How to Mock AmazonSQS in Unit Tests | Baeldung</a></p> </div>  <section class="related-posts" data-astro-cid-dpgbfi7r> <h2 data-astro-cid-dpgbfi7r>Related Posts</h2> <div class="related-posts-grid" data-astro-cid-dpgbfi7r> <article class="related-post-card" data-astro-cid-dpgbfi7r> <a href="/ai-news/2025-10-20-article-a-plan-do-check-act-framework-for-ai-code-generation/" class="related-post-link" data-astro-cid-dpgbfi7r> <h3 data-astro-cid-dpgbfi7r>A Plan-Do-Check-Act Framework for AI Code Generation</h3> <p class="related-excerpt" data-astro-cid-dpgbfi7r>Summary: A Structured Approach to AI Code Generation with PDCA This article introduces a Plan-Do-Check-Act (PDCA)…</p> <div class="related-meta" data-astro-cid-dpgbfi7r> <time datetime="2025-10-20T00:00:00.000Z" data-astro-cid-dpgbfi7r> Oct 20, 2025 </time> <span data-astro-cid-dpgbfi7r>•</span> <span data-astro-cid-dpgbfi7r>4 min read</span> </div> </a> </article><article class="related-post-card" data-astro-cid-dpgbfi7r> <a href="/ai-news/2025-10-27-vercel-ship-ai-2025-key-announcements-and-technical-updates/" class="related-post-link" data-astro-cid-dpgbfi7r> <h3 data-astro-cid-dpgbfi7r>Vercel Ship AI 2025: AI SDK 6 Beta, Marketplace Updates, and Workflow for TypeScript</h3> <p class="related-excerpt" data-astro-cid-dpgbfi7r>Vercel Ship AI 2025: Key AI Tool Announcements Vercel recently held its Ship AI 2025 event, during which it unveiled…</p> <div class="related-meta" data-astro-cid-dpgbfi7r> <time datetime="2025-10-27T00:00:00.000Z" data-astro-cid-dpgbfi7r> Oct 27, 2025 </time> <span data-astro-cid-dpgbfi7r>•</span> <span data-astro-cid-dpgbfi7r>3 min read</span> </div> </a> </article><article class="related-post-card" data-astro-cid-dpgbfi7r> <a href="/ai-news/2025-10-20-disaggregated-scheduled-fabric-scaling-metas-ai-journey/" class="related-post-link" data-astro-cid-dpgbfi7r> <h3 data-astro-cid-dpgbfi7r>Disaggregated Scheduled Fabric (DSF): Scaling Meta’s AI Infrastructure</h3> <p class="related-excerpt" data-astro-cid-dpgbfi7r>Summary: Meta&#39;s Disaggregated Scheduled Fabric (DSF) for Scalable AI Training Meta has developed Disaggregated…</p> <div class="related-meta" data-astro-cid-dpgbfi7r> <time datetime="2025-10-20T00:00:00.000Z" data-astro-cid-dpgbfi7r> Oct 20, 2025 </time> <span data-astro-cid-dpgbfi7r>•</span> <span data-astro-cid-dpgbfi7r>4 min read</span> </div> </a> </article> </div> </section>  </article> </div> <div class="back-link" data-astro-cid-rkg3zjxi><a href="/ai-news/" data-astro-cid-rkg3zjxi>← Back to AI News</a></div>  </main> <!-- Site Footer --> <footer class="site-footer container"> <p>
© 2025 AREZKI El Mehdi •
<a href="https://github.com/earezki">GitHub</a> •
<a href="/rss.xml">RSS</a> •
<a href="/sitemap-index.xml">Sitemap</a> </p> </footer> <!-- Theme Toggle Script -->  <!-- Article Read/Unread Tracking --> <script>
      /**
       * Tracks which articles have been read using localStorage
       * Updates post card styling on list pages
       */
      (function() {
        const STORAGE_KEY = 'readArticles';
        
        /**
         * Gets list of read article URLs from localStorage
         */
        function getReadArticles() {
          try {
            const data = localStorage.getItem(STORAGE_KEY);
            return data ? JSON.parse(data) : [];
          } catch (e) {
            console.error('Failed to get read articles:', e);
            return [];
          }
        }
        
        /**
         * Marks an article URL as read
         */
        function markArticleAsRead(url) {
          try {
            const readArticles = getReadArticles();
            if (!readArticles.includes(url)) {
              readArticles.push(url);
              localStorage.setItem(STORAGE_KEY, JSON.stringify(readArticles));
            }
          } catch (e) {
            console.error('Failed to mark article as read:', e);
          }
        }
        
        /**
         * Checks if an article has been read
         */
        function isArticleRead(url) {
          const readArticles = getReadArticles();
          return readArticles.includes(url);
        }
        
        /**
         * Updates post card styling on list pages based on read status
         */
        function updatePostCards() {
          const postCards = document.querySelectorAll('.post-card[data-article-url]');
          
          postCards.forEach(function(card) {
            const url = card.getAttribute('data-article-url');
            if (!url) return;
            
            if (isArticleRead(url)) {
              card.classList.add('read');
              card.classList.remove('unread');
            } else {
              card.classList.add('unread');
              card.classList.remove('read');
            }
          });
        }
        
        /**
         * Marks current article as read (on article detail pages)
         */
        function markCurrentArticleAsRead() {
          const isArticlePage = document.querySelector('.post-body');
          if (isArticlePage) {
            const currentPath = window.location.pathname;
            markArticleAsRead(currentPath);
          }
        }
        
        /**
         * Initialize tracking system
         */
        function init() {
          updatePostCards();
          markCurrentArticleAsRead();
        }
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', init);
        
        // Handle back/forward navigation (bfcache)
        window.addEventListener('pageshow', function(event) {
          if (event.persisted) {
            init();
          }
        });
      })();
    </script> <!-- Code Copy Functionality --> <script>
      /**
       * Adds copy buttons to all code blocks
       */
      (function() {
        /**
         * Creates a copy button element
         */
        function createCopyButton() {
          const button = document.createElement('button');
          button.className = 'copy-code-button';
          button.setAttribute('aria-label', 'Copy code to clipboard');
          button.innerHTML = `
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
              <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
            </svg>
            <span>Copy</span>
          `;
          return button;
        }
        
        /**
         * Creates a success checkmark icon
         */
        function createCheckIcon() {
          return `
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
            <span>Copied!</span>
          `;
        }
        
        /**
         * Copies text to clipboard
         */
        async function copyToClipboard(text) {
          try {
            await navigator.clipboard.writeText(text);
            return true;
          } catch (err) {
            // Fallback for older browsers
            const textArea = document.createElement('textarea');
            textArea.value = text;
            textArea.style.position = 'fixed';
            textArea.style.left = '-999999px';
            document.body.appendChild(textArea);
            textArea.select();
            try {
              document.execCommand('copy');
              document.body.removeChild(textArea);
              return true;
            } catch (e) {
              document.body.removeChild(textArea);
              return false;
            }
          }
        }
        
        /**
         * Handles copy button click
         */
        async function handleCopyClick(button, codeBlock) {
          const code = codeBlock.textContent || '';
          const success = await copyToClipboard(code);
          
          if (success) {
            const originalHTML = button.innerHTML;
            button.classList.add('copied');
            button.innerHTML = createCheckIcon();
            
            setTimeout(function() {
              button.classList.remove('copied');
              button.innerHTML = originalHTML;
            }, 2000);
          }
        }
        
        /**
         * Adds copy buttons to all code blocks
         */
        function addCopyButtons() {
          const codeBlocks = document.querySelectorAll('.post-body pre');
          
          codeBlocks.forEach(function(pre) {
            // Skip if button already exists
            if (pre.querySelector('.copy-code-button')) {
              return;
            }
            
            const button = createCopyButton();
            const codeBlock = pre.querySelector('code');
            
            if (codeBlock) {
              button.addEventListener('click', function() {
                handleCopyClick(button, codeBlock);
              });
              
              pre.appendChild(button);
            }
          });
        }
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', addCopyButtons);
      })();
    </script> </body> </html> 