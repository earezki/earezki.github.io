<!DOCTYPE html><html lang="en" data-theme="dark"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><!-- Primary Meta Tags --><title>Microservices Design Patterns: Best Practices for Scalable Systems • Dev|Journal</title><meta name="description" content="Microservices Design Patterns: Best Practices for Scalable Systems Microservices architecture has become the de facto standard for building scalable,…"><meta name="keywords" content="software architecture, backend development, microservices, Java, Python, Spring Boot, technical blog"><meta name="author" content="El Mehdi Arezki"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://earezki.com/ai-news/2025-11-01-microservices-design-patterns-best-practices/"><meta property="og:title" content="Microservices Design Patterns: Best Practices for Scalable Systems • Dev|Journal"><meta property="og:site_name" content="Dev|Journal"><meta property="og:description" content="Microservices Design Patterns: Best Practices for Scalable Systems Microservices architecture has become the de facto standard for building scalable,…"><meta property="og:image" content="https://earezki.com/assets/og-image-default.jpg"><!-- Twitter --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:url" content="https://earezki.com/ai-news/2025-11-01-microservices-design-patterns-best-practices/"><meta name="twitter:title" content="Microservices Design Patterns: Best Practices for Scalable Systems • Dev|Journal"><meta name="twitter:description" content="Microservices Design Patterns: Best Practices for Scalable Systems Microservices architecture has become the de facto standard for building scalable,…"><meta name="twitter:image" content="https://earezki.com/assets/og-image-default.jpg"><meta name="twitter:creator" content="@earezki"><!-- Canonical and Indexing --><link rel="canonical" href="https://earezki.com/ai-news/2025-11-01-microservices-design-patterns-best-practices/"><!-- Favicons --><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="icon" type="image/x-icon" href="/favicon.ico"><!-- RSS Feed --><link rel="alternate" type="application/rss+xml" title="RSS" href="/rss.xml"><!-- Analytics: Google Analytics (Legacy UA) --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-161447264-1"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);} 
      gtag('js', new Date()); 
      gtag('config', 'UA-161447264-1');
    </script><!-- Analytics: Umami --><script defer src="https://cloud.umami.is/script.js" data-website-id="4a26531d-1053-4f79-97a6-06a1366aff91"></script><!-- Theme Persistence (runs before page render to prevent flash) --><script>
      (function() {
        const theme = localStorage.getItem('theme');
        if (theme) { 
          document.documentElement.setAttribute('data-theme', theme); 
        }
      })();
    </script><!-- Structured Data (JSON-LD) --><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Microservices Design Patterns: Best Practices for Scalable Systems","datePublished":"2025-11-01T10:00:00.000Z","dateModified":"2025-11-01T10:00:00.000Z","author":{"@type":"Person","name":"AREZKI El Mehdi"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://earezki.com/ai-news/2025-11-01-microservices-design-patterns-best-practices/"},"description":"Microservices Design Patterns: Best Practices for Scalable Systems Microservices architecture has become the de facto standard for building scalable,…"}</script><link rel="stylesheet" href="/_astro/_slug_.C8vOLobN.css">
<style>.toc[data-astro-cid-xvrfupwn]{position:sticky;top:90px;max-height:calc(100vh - 120px);overflow:auto;padding:1rem 1rem 1.2rem;background:var(--color-bg-alt);border:1px solid var(--color-border);border-radius:var(--radius-md);font-size:.8rem;line-height:1.3}.toc-title[data-astro-cid-xvrfupwn]{font-weight:600;font-size:.75rem;text-transform:uppercase;letter-spacing:.08em;margin-bottom:.6rem;color:var(--color-text-alt)}.toc[data-astro-cid-xvrfupwn] ul[data-astro-cid-xvrfupwn]{list-style:none;margin:0;padding:0;display:flex;flex-direction:column;gap:.35rem}.toc[data-astro-cid-xvrfupwn] a[data-astro-cid-xvrfupwn]{text-decoration:none;color:var(--color-text-alt);transition:color var(--transition)}.toc[data-astro-cid-xvrfupwn] a[data-astro-cid-xvrfupwn]:hover{color:var(--color-accent)}.toc[data-astro-cid-xvrfupwn] li[data-astro-cid-xvrfupwn][class*=d-3]{margin-left:.75rem}.toc[data-astro-cid-xvrfupwn] li[data-astro-cid-xvrfupwn][class*=d-4]{margin-left:1.4rem}@media (max-width: 1080px){.toc[data-astro-cid-xvrfupwn]{display:none}}.breadcrumbs[data-astro-cid-ilhxcym7]{margin:0 0 1.5rem;font-size:.85rem}.breadcrumbs[data-astro-cid-ilhxcym7] ol[data-astro-cid-ilhxcym7]{list-style:none;padding:0;margin:0;display:flex;flex-wrap:wrap;align-items:center;gap:.5rem}.breadcrumbs[data-astro-cid-ilhxcym7] li[data-astro-cid-ilhxcym7]{display:flex;align-items:center;gap:.5rem}.breadcrumbs[data-astro-cid-ilhxcym7] a[data-astro-cid-ilhxcym7]{color:var(--color-text-alt);text-decoration:none;transition:color var(--transition)}.breadcrumbs[data-astro-cid-ilhxcym7] a[data-astro-cid-ilhxcym7]:hover{color:var(--color-accent);text-decoration:underline}.breadcrumbs[data-astro-cid-ilhxcym7] .separator[data-astro-cid-ilhxcym7]{color:var(--color-text-alt);opacity:.5;user-select:none}.breadcrumbs[data-astro-cid-ilhxcym7] .current[data-astro-cid-ilhxcym7]{color:var(--color-text);font-weight:500}.related-posts[data-astro-cid-dpgbfi7r]{margin:3rem 0;padding-top:2rem;border-top:2px solid var(--color-border)}.related-posts[data-astro-cid-dpgbfi7r] h2[data-astro-cid-dpgbfi7r]{font-size:1.5rem;margin:0 0 1.5rem;color:var(--color-text)}.related-posts-grid[data-astro-cid-dpgbfi7r]{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1.5rem}.related-post-card[data-astro-cid-dpgbfi7r]{background:var(--color-bg-alt);border:1px solid var(--color-border);border-radius:var(--radius-md);padding:1.25rem;transition:all var(--transition)}.related-post-card[data-astro-cid-dpgbfi7r]:hover{border-color:var(--color-accent);transform:translateY(-2px);box-shadow:var(--shadow-md)}.related-post-link[data-astro-cid-dpgbfi7r]{text-decoration:none;color:inherit;display:block}.related-post-card[data-astro-cid-dpgbfi7r] h3[data-astro-cid-dpgbfi7r]{margin:0 0 .75rem;font-size:1.1rem;font-weight:600;color:var(--color-text);line-height:1.3}.related-post-link[data-astro-cid-dpgbfi7r]:hover h3[data-astro-cid-dpgbfi7r]{color:var(--color-accent)}.related-excerpt[data-astro-cid-dpgbfi7r]{font-size:.85rem;color:var(--color-text-alt);line-height:1.5;margin:0 0 .75rem}.related-meta[data-astro-cid-dpgbfi7r]{font-size:.75rem;color:var(--color-text-alt);display:flex;gap:.5rem;align-items:center}@media (max-width: 680px){.related-posts-grid[data-astro-cid-dpgbfi7r]{grid-template-columns:1fr}}
.post-layout[data-astro-cid-rkg3zjxi]{display:grid;grid-template-columns:260px 1fr;gap:2.5rem}.sidebar-left[data-astro-cid-rkg3zjxi]{position:relative}@media (max-width: 1080px){.post-layout[data-astro-cid-rkg3zjxi]{grid-template-columns:1fr}}.ai-disclaimer-article[data-astro-cid-rkg3zjxi]{display:flex;gap:.75rem;padding:.9rem 1.1rem;margin:0 auto 2rem;max-width:780px;background:linear-gradient(135deg,#667eea1a,#764ba21a,#f093fb1a);border:2px solid transparent;border-radius:var(--radius-md);position:relative;background-clip:padding-box;font-size:.85rem}.ai-disclaimer-article[data-astro-cid-rkg3zjxi]:before{content:"";position:absolute;inset:-2px;border-radius:var(--radius-md);padding:2px;background:var(--ai-gradient-border);background-size:200% 200%;animation:gradient-rotate 3s linear infinite;-webkit-mask:linear-gradient(#fff 0 0) content-box,linear-gradient(#fff 0 0);-webkit-mask-composite:xor;mask:linear-gradient(#fff 0 0) content-box,linear-gradient(#fff 0 0);mask-composite:exclude;pointer-events:none}html[data-theme=dark] .ai-disclaimer-article[data-astro-cid-rkg3zjxi]{background:linear-gradient(135deg,#667eea26,#764ba226,#f093fb26)}.ai-disclaimer-article[data-astro-cid-rkg3zjxi] svg[data-astro-cid-rkg3zjxi]{margin-top:.15rem}.ai-disclaimer-article[data-astro-cid-rkg3zjxi] strong[data-astro-cid-rkg3zjxi]{color:var(--color-text);display:block;margin-bottom:.15rem}.ai-disclaimer-article[data-astro-cid-rkg3zjxi] div[data-astro-cid-rkg3zjxi]{line-height:1.5;color:var(--color-text-alt)}
</style><script type="module" src="/_astro/hoisted.2U5tn40l.js"></script></head> <body> <div id="readingProgress" role="progressbar" aria-label="Reading progress" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="position:fixed;left:0;top:0;height:3px;background:linear-gradient(90deg,#2563eb,#9333ea);width:0;z-index:999;transition:width .15s ease;"></div>  <!-- Site Header --> <header class="site-header container"> <div class="logo-wrap"> <a class="logo" href="/" aria-label="Dev|Journal Home">
Dev|Journal
</a> </div> <nav class="main-nav" aria-label="Main navigation"> <a href="/"> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" style="vertical-align: -2px; margin-right: 4px;"> <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path> <polyline points="9 22 9 12 15 12 15 22"></polyline> </svg>
Home
</a> <a href="/ai-news/" class="ai-news-link"> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" style="vertical-align: -2px; margin-right: 4px;"> <path d="M12 2a2 2 0 0 1 2 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 0 1 7 7h-9.5a.5.5 0 0 0-.5.5.5.5 0 0 1-1 0 .5.5 0 0 0-.5-.5H1a7 7 0 0 1 7-7h1V5.73c-.6-.34-1-.99-1-1.73a2 2 0 0 1 2-2z"></path> <path d="M7 15v4a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-4"></path> </svg>
AI News
</a> <a href="/tags/"> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" style="vertical-align: -2px; margin-right: 4px;"> <path d="M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2z"></path> <circle cx="7" cy="7" r="1.5"></circle> </svg>
Tags
</a> <a href="/about/"> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" style="vertical-align: -2px; margin-right: 4px;"> <circle cx="12" cy="12" r="10"></circle> <path d="M12 16v-4"></path> <path d="M12 8h.01"></path> </svg>
About
</a> <button id="themeToggle" class="theme-toggle" aria-label="Toggle dark mode"> <span class="theme-icon" aria-hidden="true">☾</span> <span class="theme-text">dark</span> </button> </nav> </header> <!-- Main Content --> <main class="container content-area">  <nav class="breadcrumbs" aria-label="Breadcrumb" data-astro-cid-ilhxcym7> <ol data-astro-cid-ilhxcym7> <li data-astro-cid-ilhxcym7>  <a href="/" data-astro-cid-ilhxcym7>Home</a> <span class="separator" aria-hidden="true" data-astro-cid-ilhxcym7>/</span>  </li><li data-astro-cid-ilhxcym7>  <a href="/ai-news/" data-astro-cid-ilhxcym7>Ai News</a> <span class="separator" aria-hidden="true" data-astro-cid-ilhxcym7>/</span>  </li><li data-astro-cid-ilhxcym7> <span class="current" aria-current="page" data-astro-cid-ilhxcym7>Microservices Design Patterns: Best Practices for Scalable Systems</span> </li> </ol> </nav>  <div class="ai-disclaimer-article" data-astro-cid-rkg3zjxi> <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="flex-shrink: 0;" data-astro-cid-rkg3zjxi> <circle cx="12" cy="12" r="10" data-astro-cid-rkg3zjxi></circle> <line x1="12" y1="8" x2="12" y2="12" data-astro-cid-rkg3zjxi></line> <line x1="12" y1="16" x2="12.01" y2="16" data-astro-cid-rkg3zjxi></line> </svg> <div data-astro-cid-rkg3zjxi> <strong data-astro-cid-rkg3zjxi>AI-Generated Content:</strong> This article was created with AI assistance. Please verify important information and check original references.
</div> </div> <div class="post-layout" data-astro-cid-rkg3zjxi> <aside class="sidebar-left" data-astro-cid-rkg3zjxi> <nav class="toc" aria-label="Table of Contents" data-astro-cid-xvrfupwn> <div class="toc-title" data-astro-cid-xvrfupwn>On this page</div> <ul data-astro-cid-xvrfupwn> <li class="d-2" data-astro-cid-xvrfupwn> <a href="#table-of-contents" data-astro-cid-xvrfupwn> Table of Contents </a> </li><li class="d-2" data-astro-cid-xvrfupwn> <a href="#introduction-to-microservices-patterns-introduction" data-astro-cid-xvrfupwn> Introduction to Microservices Patterns {#introduction} </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#why-patterns-matter" data-astro-cid-xvrfupwn> Why Patterns Matter </a> </li><li class="d-2" data-astro-cid-xvrfupwn> <a href="#communication-patterns-communication-patterns" data-astro-cid-xvrfupwn> Communication Patterns {#communication-patterns} </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#1-api-gateway-pattern" data-astro-cid-xvrfupwn> 1. API Gateway Pattern </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#2-service-mesh-pattern" data-astro-cid-xvrfupwn> 2. Service Mesh Pattern </a> </li><li class="d-2" data-astro-cid-xvrfupwn> <a href="#data-management-patterns-data-management" data-astro-cid-xvrfupwn> Data Management Patterns {#data-management} </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#3-database-per-service-pattern" data-astro-cid-xvrfupwn> 3. Database per Service Pattern </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#4-saga-pattern" data-astro-cid-xvrfupwn> 4. Saga Pattern </a> </li><li class="d-4" data-astro-cid-xvrfupwn> <a href="#choreography-based-saga" data-astro-cid-xvrfupwn> Choreography-Based Saga </a> </li><li class="d-4" data-astro-cid-xvrfupwn> <a href="#orchestration-based-saga" data-astro-cid-xvrfupwn> Orchestration-Based Saga </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#5-cqrs-pattern-command-query-responsibility-segregation" data-astro-cid-xvrfupwn> 5. CQRS Pattern (Command Query Responsibility Segregation) </a> </li><li class="d-2" data-astro-cid-xvrfupwn> <a href="#resilience-patterns-resilience-patterns" data-astro-cid-xvrfupwn> Resilience Patterns {#resilience-patterns} </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#6-circuit-breaker-pattern" data-astro-cid-xvrfupwn> 6. Circuit Breaker Pattern </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#7-retry-pattern" data-astro-cid-xvrfupwn> 7. Retry Pattern </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#8-bulkhead-pattern" data-astro-cid-xvrfupwn> 8. Bulkhead Pattern </a> </li><li class="d-2" data-astro-cid-xvrfupwn> <a href="#deployment-and-infrastructure-patterns-deployment-patterns" data-astro-cid-xvrfupwn> Deployment and Infrastructure Patterns {#deployment-patterns} </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#9-service-registry-and-discovery" data-astro-cid-xvrfupwn> 9. Service Registry and Discovery </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#10-externalized-configuration" data-astro-cid-xvrfupwn> 10. Externalized Configuration </a> </li><li class="d-2" data-astro-cid-xvrfupwn> <a href="#real-world-implementation-examples-examples" data-astro-cid-xvrfupwn> Real-World Implementation Examples {#examples} </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#e-commerce-platform-architecture" data-astro-cid-xvrfupwn> E-Commerce Platform Architecture </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#banking-system-with-saga-pattern" data-astro-cid-xvrfupwn> Banking System with Saga Pattern </a> </li><li class="d-2" data-astro-cid-xvrfupwn> <a href="#best-practices-summary" data-astro-cid-xvrfupwn> Best Practices Summary </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#do" data-astro-cid-xvrfupwn> DO: </a> </li><li class="d-3" data-astro-cid-xvrfupwn> <a href="#dont" data-astro-cid-xvrfupwn> DON&#39;T: </a> </li><li class="d-2" data-astro-cid-xvrfupwn> <a href="#conclusion" data-astro-cid-xvrfupwn> Conclusion </a> </li><li class="d-2" data-astro-cid-xvrfupwn> <a href="#further-reading" data-astro-cid-xvrfupwn> Further Reading </a> </li> </ul> </nav>  </aside> <article class="post" data-astro-cid-rkg3zjxi> <header class="post-header" data-astro-cid-rkg3zjxi> <h1 data-astro-cid-rkg3zjxi>Microservices Design Patterns: Best Practices for Scalable Systems</h1> <div class="meta" data-astro-cid-rkg3zjxi> <time datetime="2025-11-01T10:00:00.000Z" data-astro-cid-rkg3zjxi>Sat Nov 01 2025</time> <span data-astro-cid-rkg3zjxi>• 6 min read</span> </div> <div class="tag-row" data-astro-cid-rkg3zjxi><a class="post-tag " href="/tags/software-architecture/" data-astro-cid-rkg3zjxi>Software architecture</a><a class="post-tag " href="/tags/microservices/" data-astro-cid-rkg3zjxi>Microservices</a><a class="post-tag " href="/tags/design-patterns/" data-astro-cid-rkg3zjxi>Design patterns</a></div> </header> <div class="post-body prose" data-astro-cid-rkg3zjxi> <h1 id="microservices-design-patterns-best-practices-for-scalable-systems">Microservices Design Patterns: Best Practices for Scalable Systems</h1>
<p>Microservices architecture has become the de facto standard for building scalable, maintainable enterprise applications. However, implementing microservices successfully requires understanding and applying proven design patterns. In this comprehensive guide, we’ll explore the essential patterns that form the foundation of robust microservices systems.</p>
<h2 id="table-of-contents">Table of Contents</h2>
<ol>
<li><a href="#introduction">Introduction to Microservices Patterns</a></li>
<li><a href="#communication-patterns">Communication Patterns</a></li>
<li><a href="#data-management">Data Management Patterns</a></li>
<li><a href="#resilience-patterns">Resilience Patterns</a></li>
<li><a href="#deployment-patterns">Deployment and Infrastructure Patterns</a></li>
<li><a href="#examples">Real-World Implementation Examples</a></li>
</ol>
<h2 id="introduction-to-microservices-patterns-introduction">Introduction to Microservices Patterns {#introduction}</h2>
<p>Microservices patterns solve common challenges in distributed systems:</p>
<ul>
<li><strong>Service discovery and communication</strong></li>
<li><strong>Data consistency across services</strong></li>
<li><strong>Failure handling and resilience</strong></li>
<li><strong>Monitoring and observability</strong></li>
<li><strong>Deployment and scaling</strong></li>
</ul>
<h3 id="why-patterns-matter">Why Patterns Matter</h3>
<p>When building microservices, you’ll encounter similar problems repeatedly. Patterns provide battle-tested solutions that:</p>
<p>✅ Reduce development time
✅ Improve system reliability
✅ Enable team collaboration
✅ Facilitate system evolution</p>
<h2 id="communication-patterns-communication-patterns">Communication Patterns {#communication-patterns}</h2>
<h3 id="1-api-gateway-pattern">1. API Gateway Pattern</h3>
<p>The API Gateway acts as a single entry point for all client requests, routing them to appropriate microservices.</p>
<p><strong>Benefits:</strong></p>
<ul>
<li>Simplified client interface</li>
<li>Cross-cutting concerns (auth, logging, rate limiting)</li>
<li>Protocol translation</li>
<li>Request aggregation</li>
</ul>
<p><strong>Implementation Example (Spring Cloud Gateway):</strong></p>
<pre class="language-java" data-language="java"><code is:raw="" class="language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GatewayConfig</span> <span class="token punctuation">{</span>
    
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">RouteLocator</span> <span class="token function">customRouteLocator</span><span class="token punctuation">(</span><span class="token class-name">RouteLocatorBuilder</span> builder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> builder<span class="token punctuation">.</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">route</span><span class="token punctuation">(</span><span class="token string">"user-service"</span><span class="token punctuation">,</span> r <span class="token operator">-></span> r
                <span class="token punctuation">.</span><span class="token function">path</span><span class="token punctuation">(</span><span class="token string">"/api/users/**"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">filters</span><span class="token punctuation">(</span>f <span class="token operator">-></span> f
                    <span class="token punctuation">.</span><span class="token function">rewritePath</span><span class="token punctuation">(</span><span class="token string">"/api/users/(?&#x3C;segment>.*)"</span><span class="token punctuation">,</span> <span class="token string">"/${segment}"</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">addRequestHeader</span><span class="token punctuation">(</span><span class="token string">"X-Gateway-Source"</span><span class="token punctuation">,</span> <span class="token string">"API-Gateway"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">uri</span><span class="token punctuation">(</span><span class="token string">"lb://USER-SERVICE"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">route</span><span class="token punctuation">(</span><span class="token string">"order-service"</span><span class="token punctuation">,</span> r <span class="token operator">-></span> r
                <span class="token punctuation">.</span><span class="token function">path</span><span class="token punctuation">(</span><span class="token string">"/api/orders/**"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">filters</span><span class="token punctuation">(</span>f <span class="token operator">-></span> f
                    <span class="token punctuation">.</span><span class="token function">circuitBreaker</span><span class="token punctuation">(</span>c <span class="token operator">-></span> c
                        <span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"orderServiceCircuitBreaker"</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">setFallbackUri</span><span class="token punctuation">(</span><span class="token string">"forward:/fallback/orders"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">uri</span><span class="token punctuation">(</span><span class="token string">"lb://ORDER-SERVICE"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p><strong>Best Practices:</strong></p>
<ul>
<li>Keep gateway logic thin</li>
<li>Implement request/response transformation at gateway level</li>
<li>Use caching for frequently accessed data</li>
<li>Monitor gateway performance metrics</li>
</ul>
<h3 id="2-service-mesh-pattern">2. Service Mesh Pattern</h3>
<p>Service mesh handles service-to-service communication at the infrastructure level.</p>
<p><strong>Key Features:</strong></p>
<ul>
<li>Load balancing</li>
<li>Service discovery</li>
<li>Failure recovery</li>
<li>Metrics collection</li>
<li>Distributed tracing</li>
</ul>
<p><strong>Popular Implementations:</strong></p>
<ul>
<li>Istio</li>
<li>Linkerd</li>
<li>Consul Connect</li>
</ul>
<h2 id="data-management-patterns-data-management">Data Management Patterns {#data-management}</h2>
<h3 id="3-database-per-service-pattern">3. Database per Service Pattern</h3>
<p>Each microservice owns its database, ensuring loose coupling and independent scaling.</p>
<p><strong>Advantages:</strong></p>
<ul>
<li>Service independence</li>
<li>Technology flexibility</li>
<li>Easier scaling</li>
<li>Fault isolation</li>
</ul>
<p><strong>Challenges:</strong></p>
<ul>
<li>Data consistency</li>
<li>Complex queries across services</li>
<li>Increased operational overhead</li>
</ul>
<h3 id="4-saga-pattern">4. Saga Pattern</h3>
<p>Manages distributed transactions across multiple services using a sequence of local transactions.</p>
<p><strong>Two Implementation Approaches:</strong></p>
<h4 id="choreography-based-saga">Choreography-Based Saga</h4>
<p>Services communicate through events:</p>
<pre class="language-java" data-language="java"><code is:raw="" class="language-java"><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderService</span> <span class="token punctuation">{</span>
    
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">EventPublisher</span> eventPublisher<span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">OrderRepository</span> orderRepository<span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@Transactional</span>
    <span class="token keyword">public</span> <span class="token class-name">Order</span> <span class="token function">createOrder</span><span class="token punctuation">(</span><span class="token class-name">OrderRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Create order</span>
        <span class="token class-name">Order</span> order <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Order</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        order<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token class-name">OrderStatus</span><span class="token punctuation">.</span><span class="token constant">PENDING</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        order<span class="token punctuation">.</span><span class="token function">setCustomerId</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getCustomerId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        order<span class="token punctuation">.</span><span class="token function">setTotalAmount</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getTotalAmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        orderRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">// Publish event</span>
        eventPublisher<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">OrderCreatedEvent</span><span class="token punctuation">(</span>
            order<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            order<span class="token punctuation">.</span><span class="token function">getCustomerId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            order<span class="token punctuation">.</span><span class="token function">getTotalAmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token keyword">return</span> order<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@EventListener</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handlePaymentSucceeded</span><span class="token punctuation">(</span><span class="token class-name">PaymentSucceededEvent</span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Order</span> order <span class="token operator">=</span> orderRepository<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token function">getOrderId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">orElseThrow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        order<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token class-name">OrderStatus</span><span class="token punctuation">.</span><span class="token constant">CONFIRMED</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        orderRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        eventPublisher<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">OrderConfirmedEvent</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@EventListener</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handlePaymentFailed</span><span class="token punctuation">(</span><span class="token class-name">PaymentFailedEvent</span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Order</span> order <span class="token operator">=</span> orderRepository<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token function">getOrderId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">orElseThrow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        order<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token class-name">OrderStatus</span><span class="token punctuation">.</span><span class="token constant">CANCELLED</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        orderRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h4 id="orchestration-based-saga">Orchestration-Based Saga</h4>
<p>Central orchestrator coordinates the saga:</p>
<pre class="language-java" data-language="java"><code is:raw="" class="language-java"><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderSagaOrchestrator</span> <span class="token punctuation">{</span>
    
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">PaymentService</span> paymentService<span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">InventoryService</span> inventoryService<span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">ShippingService</span> shippingService<span class="token punctuation">;</span>
    
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">executeOrderSaga</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// Step 1: Reserve inventory</span>
            <span class="token class-name">InventoryReservation</span> reservation <span class="token operator">=</span> 
                inventoryService<span class="token punctuation">.</span><span class="token function">reserveItems</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            <span class="token comment">// Step 2: Process payment</span>
            <span class="token class-name">Payment</span> payment <span class="token operator">=</span> 
                paymentService<span class="token punctuation">.</span><span class="token function">processPayment</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getTotalAmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            <span class="token comment">// Step 3: Schedule shipping</span>
            <span class="token class-name">Shipment</span> shipment <span class="token operator">=</span> 
                shippingService<span class="token punctuation">.</span><span class="token function">scheduleShipment</span><span class="token punctuation">(</span>order<span class="token punctuation">,</span> reservation<span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            order<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token class-name">OrderStatus</span><span class="token punctuation">.</span><span class="token constant">COMPLETED</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InventoryException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Handle inventory failure</span>
            order<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token class-name">OrderStatus</span><span class="token punctuation">.</span><span class="token constant">CANCELLED</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">PaymentException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Compensate: Release inventory</span>
            inventoryService<span class="token punctuation">.</span><span class="token function">releaseReservation</span><span class="token punctuation">(</span>reservation<span class="token punctuation">)</span><span class="token punctuation">;</span>
            order<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token class-name">OrderStatus</span><span class="token punctuation">.</span><span class="token constant">CANCELLED</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ShippingException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Compensate: Refund payment and release inventory</span>
            paymentService<span class="token punctuation">.</span><span class="token function">refund</span><span class="token punctuation">(</span>payment<span class="token punctuation">)</span><span class="token punctuation">;</span>
            inventoryService<span class="token punctuation">.</span><span class="token function">releaseReservation</span><span class="token punctuation">(</span>reservation<span class="token punctuation">)</span><span class="token punctuation">;</span>
            order<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token class-name">OrderStatus</span><span class="token punctuation">.</span><span class="token constant">CANCELLED</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="5-cqrs-pattern-command-query-responsibility-segregation">5. CQRS Pattern (Command Query Responsibility Segregation)</h3>
<p>Separates read and write operations into different models.</p>
<p><strong>Implementation Example:</strong></p>
<pre class="language-java" data-language="java"><code is:raw="" class="language-java"><span class="token comment">// Command Side</span>
<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProductCommandService</span> <span class="token punctuation">{</span>
    
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">ProductWriteRepository</span> writeRepository<span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">EventBus</span> eventBus<span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@Transactional</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">createProduct</span><span class="token punctuation">(</span><span class="token class-name">CreateProductCommand</span> command<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Product</span> product <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Product</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        product<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span>command<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        product<span class="token punctuation">.</span><span class="token function">setPrice</span><span class="token punctuation">(</span>command<span class="token punctuation">.</span><span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        product<span class="token punctuation">.</span><span class="token function">setStock</span><span class="token punctuation">(</span>command<span class="token punctuation">.</span><span class="token function">getStock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        writeRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        eventBus<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ProductCreatedEvent</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Query Side</span>
<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProductQueryService</span> <span class="token punctuation">{</span>
    
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">ProductReadRepository</span> readRepository<span class="token punctuation">;</span>
    
    <span class="token keyword">public</span> <span class="token class-name">ProductDTO</span> <span class="token function">getProduct</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> readRepository<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">::</span><span class="token function">toDTO</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">orElseThrow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&#x3C;</span><span class="token class-name">ProductDTO</span><span class="token punctuation">></span></span> <span class="token function">searchProducts</span><span class="token punctuation">(</span><span class="token class-name">SearchCriteria</span> criteria<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> readRepository<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>criteria<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">::</span><span class="token function">toDTO</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Event Handler to sync read model</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProductEventHandler</span> <span class="token punctuation">{</span>
    
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">ProductReadRepository</span> readRepository<span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@EventListener</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">on</span><span class="token punctuation">(</span><span class="token class-name">ProductCreatedEvent</span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ProductReadModel</span> model <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ProductReadModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        model<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token function">getProductId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        model<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        model<span class="token punctuation">.</span><span class="token function">setPrice</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        readRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>model<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="resilience-patterns-resilience-patterns">Resilience Patterns {#resilience-patterns}</h2>
<h3 id="6-circuit-breaker-pattern">6. Circuit Breaker Pattern</h3>
<p>Prevents cascading failures by stopping calls to failing services.</p>
<p><strong>States:</strong></p>
<ul>
<li><strong>Closed</strong>: Normal operation</li>
<li><strong>Open</strong>: Requests fail immediately</li>
<li><strong>Half-Open</strong>: Testing if service recovered</li>
</ul>
<p><strong>Implementation with Resilience4j:</strong></p>
<pre class="language-java" data-language="java"><code is:raw="" class="language-java"><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PaymentService</span> <span class="token punctuation">{</span>
    
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">CircuitBreaker</span> circuitBreaker<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">RestTemplate</span> restTemplate<span class="token punctuation">;</span>
    
    <span class="token keyword">public</span> <span class="token class-name">PaymentService</span><span class="token punctuation">(</span><span class="token class-name">CircuitBreakerRegistry</span> registry<span class="token punctuation">,</span> 
                         <span class="token class-name">RestTemplate</span> restTemplate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>circuitBreaker <span class="token operator">=</span> registry<span class="token punctuation">.</span><span class="token function">circuitBreaker</span><span class="token punctuation">(</span><span class="token string">"payment-service"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>restTemplate <span class="token operator">=</span> restTemplate<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token class-name">PaymentResponse</span> <span class="token function">processPayment</span><span class="token punctuation">(</span><span class="token class-name">PaymentRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> circuitBreaker<span class="token punctuation">.</span><span class="token function">executeSupplier</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> restTemplate<span class="token punctuation">.</span><span class="token function">postForObject</span><span class="token punctuation">(</span>
                <span class="token string">"http://payment-service/api/payments"</span><span class="token punctuation">,</span>
                request<span class="token punctuation">,</span>
                <span class="token class-name">PaymentResponse</span><span class="token punctuation">.</span><span class="token keyword">class</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p><strong>Configuration:</strong></p>
<pre class="language-yaml" data-language="yaml"><code is:raw="" class="language-yaml"><span class="token key atrule">resilience4j</span><span class="token punctuation">:</span>
  <span class="token key atrule">circuitbreaker</span><span class="token punctuation">:</span>
    <span class="token key atrule">instances</span><span class="token punctuation">:</span>
      <span class="token key atrule">payment-service</span><span class="token punctuation">:</span>
        <span class="token key atrule">register-health-indicator</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">sliding-window-size</span><span class="token punctuation">:</span> <span class="token number">10</span>
        <span class="token key atrule">minimum-number-of-calls</span><span class="token punctuation">:</span> <span class="token number">5</span>
        <span class="token key atrule">permitted-number-of-calls-in-half-open-state</span><span class="token punctuation">:</span> <span class="token number">3</span>
        <span class="token key atrule">automatic-transition-from-open-to-half-open-enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">wait-duration-in-open-state</span><span class="token punctuation">:</span> 10s
        <span class="token key atrule">failure-rate-threshold</span><span class="token punctuation">:</span> <span class="token number">50</span>
        <span class="token key atrule">slow-call-rate-threshold</span><span class="token punctuation">:</span> <span class="token number">100</span>
        <span class="token key atrule">slow-call-duration-threshold</span><span class="token punctuation">:</span> 2s
</code></pre>
<h3 id="7-retry-pattern">7. Retry Pattern</h3>
<p>Automatically retries failed operations with exponential backoff.</p>
<pre class="language-java" data-language="java"><code is:raw="" class="language-java"><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderService</span> <span class="token punctuation">{</span>
    
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Retry</span> retry<span class="token punctuation">;</span>
    
    <span class="token keyword">public</span> <span class="token class-name">OrderService</span><span class="token punctuation">(</span><span class="token class-name">RetryRegistry</span> retryRegistry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>retry <span class="token operator">=</span> retryRegistry<span class="token punctuation">.</span><span class="token function">retry</span><span class="token punctuation">(</span><span class="token string">"order-service"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token class-name">Order</span> <span class="token function">placeOrder</span><span class="token punctuation">(</span><span class="token class-name">OrderRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> retry<span class="token punctuation">.</span><span class="token function">executeSupplier</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> externalOrderApi<span class="token punctuation">.</span><span class="token function">createOrder</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p><strong>Configuration:</strong></p>
<pre class="language-yaml" data-language="yaml"><code is:raw="" class="language-yaml"><span class="token key atrule">resilience4j</span><span class="token punctuation">:</span>
  <span class="token key atrule">retry</span><span class="token punctuation">:</span>
    <span class="token key atrule">instances</span><span class="token punctuation">:</span>
      <span class="token key atrule">order-service</span><span class="token punctuation">:</span>
        <span class="token key atrule">max-attempts</span><span class="token punctuation">:</span> <span class="token number">3</span>
        <span class="token key atrule">wait-duration</span><span class="token punctuation">:</span> 1s
        <span class="token key atrule">exponential-backoff-multiplier</span><span class="token punctuation">:</span> <span class="token number">2</span>
        <span class="token key atrule">retry-exceptions</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> org.springframework.web.client.ResourceAccessException
          <span class="token punctuation">-</span> java.net.ConnectException
</code></pre>
<h3 id="8-bulkhead-pattern">8. Bulkhead Pattern</h3>
<p>Isolates resources to prevent one failing component from bringing down the entire system.</p>
<pre class="language-java" data-language="java"><code is:raw="" class="language-java"><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ReportService</span> <span class="token punctuation">{</span>
    
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Bulkhead</span> bulkhead<span class="token punctuation">;</span>
    
    <span class="token keyword">public</span> <span class="token class-name">ReportService</span><span class="token punctuation">(</span><span class="token class-name">BulkheadRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>bulkhead <span class="token operator">=</span> registry<span class="token punctuation">.</span><span class="token function">bulkhead</span><span class="token punctuation">(</span><span class="token string">"report-service"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&#x3C;</span><span class="token class-name">Report</span><span class="token punctuation">></span></span> <span class="token function">generateReport</span><span class="token punctuation">(</span><span class="token class-name">ReportRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> bulkhead<span class="token punctuation">.</span><span class="token function">executeSupplier</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> 
            <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">supplyAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">{</span>
                <span class="token comment">// Heavy report generation</span>
                <span class="token keyword">return</span> reportGenerator<span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="deployment-and-infrastructure-patterns-deployment-patterns">Deployment and Infrastructure Patterns {#deployment-patterns}</h2>
<h3 id="9-service-registry-and-discovery">9. Service Registry and Discovery</h3>
<p>Services register themselves and discover other services dynamically.</p>
<p><strong>Spring Cloud Netflix Eureka Example:</strong></p>
<pre class="language-java" data-language="java"><code is:raw="" class="language-java"><span class="token comment">// Eureka Server</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token annotation punctuation">@EnableEurekaServer</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DiscoveryServerApplication</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">DiscoveryServerApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Service Registration</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token annotation punctuation">@EnableDiscoveryClient</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserServiceApplication</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">UserServiceApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="10-externalized-configuration">10. Externalized Configuration</h3>
<p>Centralize configuration management for all services.</p>
<p><strong>Spring Cloud Config:</strong></p>
<pre class="language-yaml" data-language="yaml"><code is:raw="" class="language-yaml"><span class="token comment"># application.yml in config server</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">config</span><span class="token punctuation">:</span>
      <span class="token key atrule">server</span><span class="token punctuation">:</span>
        <span class="token key atrule">git</span><span class="token punctuation">:</span>
          <span class="token key atrule">uri</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//github.com/yourorg/config<span class="token punctuation">-</span>repo
          <span class="token key atrule">search-paths</span><span class="token punctuation">:</span> <span class="token string">'{application}'</span>
          <span class="token key atrule">default-label</span><span class="token punctuation">:</span> main
</code></pre>
<h2 id="real-world-implementation-examples-examples">Real-World Implementation Examples {#examples}</h2>
<h3 id="e-commerce-platform-architecture">E-Commerce Platform Architecture</h3>
<pre class="language-plaintext" data-language="plaintext"><code is:raw="" class="language-plaintext">┌─────────────────┐
│   API Gateway   │
└────────┬────────┘
         │
    ┌────┴────┬─────────┬──────────┐
    │         │         │          │
┌───▼───┐ ┌──▼───┐ ┌───▼────┐ ┌──▼─────┐
│ User  │ │Order │ │Product │ │Payment │
│Service│ │Svc   │ │Service │ │Service │
└───┬───┘ └──┬───┘ └───┬────┘ └──┬─────┘
    │        │         │          │
┌───▼────────▼─────────▼──────────▼───┐
│       Event Bus (Kafka/RabbitMQ)    │
└─────────────────────────────────────┘
</code></pre>
<h3 id="banking-system-with-saga-pattern">Banking System with Saga Pattern</h3>
<pre class="language-java" data-language="java"><code is:raw="" class="language-java"><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TransferSagaOrchestrator</span> <span class="token punctuation">{</span>
    
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">executeTransfer</span><span class="token punctuation">(</span><span class="token class-name">TransferRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SagaExecution</span> execution <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SagaExecution</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// Step 1: Debit source account</span>
            execution<span class="token punctuation">.</span><span class="token function">addStep</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DebitAccountStep</span><span class="token punctuation">(</span>
                request<span class="token punctuation">.</span><span class="token function">getSourceAccount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                request<span class="token punctuation">.</span><span class="token function">getAmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            <span class="token comment">// Step 2: Credit destination account</span>
            execution<span class="token punctuation">.</span><span class="token function">addStep</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">CreditAccountStep</span><span class="token punctuation">(</span>
                request<span class="token punctuation">.</span><span class="token function">getDestinationAccount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                request<span class="token punctuation">.</span><span class="token function">getAmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            <span class="token comment">// Step 3: Create transaction record</span>
            execution<span class="token punctuation">.</span><span class="token function">addStep</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RecordTransactionStep</span><span class="token punctuation">(</span>
                request
            <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            <span class="token comment">// Execute all steps</span>
            execution<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SagaExecutionException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Compensate all completed steps</span>
            execution<span class="token punctuation">.</span><span class="token function">compensate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TransferFailedException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="best-practices-summary">Best Practices Summary</h2>
<h3 id="do">DO:</h3>
<p>✅ Use API Gateway for client-facing APIs
✅ Implement Circuit Breaker for external calls
✅ Use Saga pattern for distributed transactions
✅ Employ CQRS for complex read requirements
✅ Implement proper monitoring and observability
✅ Use service mesh for cross-cutting concerns
✅ Design for failure (defensive programming)</p>
<h3 id="dont">DON’T:</h3>
<p>❌ Share databases between services
❌ Create tightly coupled services
❌ Implement synchronous call chains
❌ Ignore failure scenarios
❌ Skimp on monitoring and logging
❌ Deploy all services together
❌ Use distributed transactions (2PC)</p>
<h2 id="conclusion">Conclusion</h2>
<p>Microservices patterns are essential tools for building robust distributed systems. By understanding and applying these patterns appropriately, you can:</p>
<ul>
<li>Build scalable systems that handle millions of requests</li>
<li>Create resilient architectures that gracefully handle failures</li>
<li>Enable independent team development and deployment</li>
<li>Facilitate system evolution and technology migration</li>
</ul>
<p>Remember: <strong>patterns are guidelines, not rules</strong>. Always evaluate your specific requirements and constraints before applying any pattern.</p>
<h2 id="further-reading">Further Reading</h2>
<ul>
<li><a href="https://martinfowler.com/microservices/">Martin Fowler’s Microservices Guide</a></li>
<li><a href="https://microservices.io/patterns/">Microservices.io Patterns</a></li>
<li><a href="https://www.manning.com/books/cloud-native-patterns">Cloud Native Patterns Book</a></li>
<li><a href="https://www.oreilly.com/library/view/building-microservices-2nd/9781492034018/">Building Microservices by Sam Newman</a></li>
</ul>
<hr>
<p><em>Have you implemented these patterns in your projects? What challenges did you face? Share your experiences in the comments below!</em></p> </div>  <section class="related-posts" data-astro-cid-dpgbfi7r> <h2 data-astro-cid-dpgbfi7r>Related Posts</h2> <div class="related-posts-grid" data-astro-cid-dpgbfi7r> <article class="related-post-card" data-astro-cid-dpgbfi7r> <a href="/dependency-inversion-principle/" class="related-post-link" data-astro-cid-dpgbfi7r> <h3 data-astro-cid-dpgbfi7r>D (Dependency Inversion) from SOLID</h3> <p class="related-excerpt" data-astro-cid-dpgbfi7r>The Dependency Inversion Principle: Stop Depending on Details What Is Dependency Inversion, Really? Let me ask you a…</p> <div class="related-meta" data-astro-cid-dpgbfi7r> <time datetime="2024-06-21T23:00:46.000Z" data-astro-cid-dpgbfi7r> Jun 21, 2024 </time> <span data-astro-cid-dpgbfi7r>•</span> <span data-astro-cid-dpgbfi7r>14 min read</span> </div> </a> </article><article class="related-post-card" data-astro-cid-dpgbfi7r> <a href="/hexagonal-architecture/" class="related-post-link" data-astro-cid-dpgbfi7r> <h3 data-astro-cid-dpgbfi7r>Hexagonal Architecture</h3> <p class="related-excerpt" data-astro-cid-dpgbfi7r>&gt; The _ **_hexagonal architecture_** _, or _ **_ports and adapters architecture_** _, is an architectural pattern used…</p> <div class="related-meta" data-astro-cid-dpgbfi7r> <time datetime="2020-03-29T04:49:46.000Z" data-astro-cid-dpgbfi7r> Mar 29, 2020 </time> <span data-astro-cid-dpgbfi7r>•</span> <span data-astro-cid-dpgbfi7r>2 min read</span> </div> </a> </article><article class="related-post-card" data-astro-cid-dpgbfi7r> <a href="/interface-segregation-principle/" class="related-post-link" data-astro-cid-dpgbfi7r> <h3 data-astro-cid-dpgbfi7r>I (Interface Segregation) from SOLID</h3> <p class="related-excerpt" data-astro-cid-dpgbfi7r>The Interface Segregation Principle: Why Your Interfaces Are Probably Too Fat What Is Interface Segregation, Really?…</p> <div class="related-meta" data-astro-cid-dpgbfi7r> <time datetime="2024-06-20T23:00:46.000Z" data-astro-cid-dpgbfi7r> Jun 20, 2024 </time> <span data-astro-cid-dpgbfi7r>•</span> <span data-astro-cid-dpgbfi7r>17 min read</span> </div> </a> </article> </div> </section>  </article> </div> <div class="back-link" data-astro-cid-rkg3zjxi><a href="/ai-news/" data-astro-cid-rkg3zjxi>← Back to AI News</a></div>  </main> <!-- Site Footer --> <footer class="site-footer container"> <p>
© 2025 AREZKI El Mehdi •
<a href="https://github.com/earezki">GitHub</a> •
<a href="/rss.xml">RSS</a> •
<a href="/sitemap-index.xml">Sitemap</a> </p> </footer> <!-- Theme Toggle Script -->  <!-- Article Read/Unread Tracking --> <script>
      /**
       * Tracks which articles have been read using localStorage
       * Updates post card styling on list pages
       */
      (function() {
        const STORAGE_KEY = 'readArticles';
        
        /**
         * Gets list of read article URLs from localStorage
         */
        function getReadArticles() {
          try {
            const data = localStorage.getItem(STORAGE_KEY);
            return data ? JSON.parse(data) : [];
          } catch (e) {
            console.error('Failed to get read articles:', e);
            return [];
          }
        }
        
        /**
         * Marks an article URL as read
         */
        function markArticleAsRead(url) {
          try {
            const readArticles = getReadArticles();
            if (!readArticles.includes(url)) {
              readArticles.push(url);
              localStorage.setItem(STORAGE_KEY, JSON.stringify(readArticles));
            }
          } catch (e) {
            console.error('Failed to mark article as read:', e);
          }
        }
        
        /**
         * Checks if an article has been read
         */
        function isArticleRead(url) {
          const readArticles = getReadArticles();
          return readArticles.includes(url);
        }
        
        /**
         * Updates post card styling on list pages based on read status
         */
        function updatePostCards() {
          const postCards = document.querySelectorAll('.post-card[data-article-url]');
          
          postCards.forEach(function(card) {
            const url = card.getAttribute('data-article-url');
            if (!url) return;
            
            if (isArticleRead(url)) {
              card.classList.add('read');
              card.classList.remove('unread');
            } else {
              card.classList.add('unread');
              card.classList.remove('read');
            }
          });
        }
        
        /**
         * Marks current article as read (on article detail pages)
         */
        function markCurrentArticleAsRead() {
          const isArticlePage = document.querySelector('.post-body');
          if (isArticlePage) {
            const currentPath = window.location.pathname;
            markArticleAsRead(currentPath);
          }
        }
        
        /**
         * Initialize tracking system
         */
        function init() {
          updatePostCards();
          markCurrentArticleAsRead();
        }
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', init);
        
        // Handle back/forward navigation (bfcache)
        window.addEventListener('pageshow', function(event) {
          if (event.persisted) {
            init();
          }
        });
      })();
    </script> <!-- Code Copy Functionality --> <script>
      /**
       * Adds copy buttons to all code blocks
       */
      (function() {
        /**
         * Creates a copy button element
         */
        function createCopyButton() {
          const button = document.createElement('button');
          button.className = 'copy-code-button';
          button.setAttribute('aria-label', 'Copy code to clipboard');
          button.innerHTML = `
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
              <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
            </svg>
            <span>Copy</span>
          `;
          return button;
        }
        
        /**
         * Creates a success checkmark icon
         */
        function createCheckIcon() {
          return `
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
            <span>Copied!</span>
          `;
        }
        
        /**
         * Copies text to clipboard
         */
        async function copyToClipboard(text) {
          try {
            await navigator.clipboard.writeText(text);
            return true;
          } catch (err) {
            // Fallback for older browsers
            const textArea = document.createElement('textarea');
            textArea.value = text;
            textArea.style.position = 'fixed';
            textArea.style.left = '-999999px';
            document.body.appendChild(textArea);
            textArea.select();
            try {
              document.execCommand('copy');
              document.body.removeChild(textArea);
              return true;
            } catch (e) {
              document.body.removeChild(textArea);
              return false;
            }
          }
        }
        
        /**
         * Handles copy button click
         */
        async function handleCopyClick(button, codeBlock) {
          const code = codeBlock.textContent || '';
          const success = await copyToClipboard(code);
          
          if (success) {
            const originalHTML = button.innerHTML;
            button.classList.add('copied');
            button.innerHTML = createCheckIcon();
            
            setTimeout(function() {
              button.classList.remove('copied');
              button.innerHTML = originalHTML;
            }, 2000);
          }
        }
        
        /**
         * Adds copy buttons to all code blocks
         */
        function addCopyButtons() {
          const codeBlocks = document.querySelectorAll('.post-body pre');
          
          codeBlocks.forEach(function(pre) {
            // Skip if button already exists
            if (pre.querySelector('.copy-code-button')) {
              return;
            }
            
            const button = createCopyButton();
            const codeBlock = pre.querySelector('code');
            
            if (codeBlock) {
              button.addEventListener('click', function() {
                handleCopyClick(button, codeBlock);
              });
              
              pre.appendChild(button);
            }
          });
        }
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', addCopyButtons);
      })();
    </script> </body> </html> 