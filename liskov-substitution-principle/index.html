<!DOCTYPE html><html lang="en" data-theme="dark"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>L from SOLID • Dev|Journal</title><meta name="description" content="The Liskov Substitution Principle (LSP) in Object-Oriented Design Introduction The Liskov Substitution Principle (LSP) is one of the five SOLID principles of…"><meta name="keywords" content="Software design, SOLID"><meta name="author" content="El Mehdi Arezki"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://earezki.com/liskov-substitution-principle/"><meta property="og:title" content="L from SOLID • Dev|Journal"><meta property="og:site_name" content="Dev|Journal"><meta property="og:description" content="The Liskov Substitution Principle (LSP) in Object-Oriented Design Introduction The Liskov Substitution Principle (LSP) is one of the five SOLID principles of…"><meta property="og:image" content="https://earezki.com/assets/og-image-default.jpg"><!-- Twitter --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:url" content="https://earezki.com/liskov-substitution-principle/"><meta name="twitter:title" content="L from SOLID • Dev|Journal"><meta name="twitter:description" content="The Liskov Substitution Principle (LSP) in Object-Oriented Design Introduction The Liskov Substitution Principle (LSP) is one of the five SOLID principles of…"><meta name="twitter:image" content="https://earezki.com/assets/og-image-default.jpg"><meta name="twitter:creator" content="@earezki"><link rel="canonical" href="https://earezki.com/liskov-substitution-principle/"><link rel="alternate" type="application/rss+xml" title="RSS" href="/rss.xml"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-161447264-1"></script><script defer src="https://cloud.umami.is/script.js" data-website-id="4a26531d-1053-4f79-97a6-06a1366aff91"></script><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"L from SOLID","description":"The Liskov Substitution Principle (LSP) in Object-Oriented Design Introduction The Liskov Substitution Principle (LSP) is one of the five SOLID principles of…","image":"https://earezki.com/assets/og-image-default.jpg","datePublished":"2024-06-19T23:00:46.000Z","dateModified":"2024-06-19T23:00:46.000Z","author":{"@type":"Person","name":"El Mehdi Arezki","url":"https://earezki.com/about","jobTitle":"Lead Software Engineer","sameAs":["https://github.com/earezki","https://www.linkedin.com/in/mehdi-arezki"]},"publisher":{"@type":"Organization","name":"Dev|Journal","url":"https://earezki.com","logo":{"@type":"ImageObject","url":"https://earezki.com/assets/logo.png"}},"mainEntityOfPage":{"@type":"WebPage","@id":"https://earezki.com/liskov-substitution-principle/"}}</script><link rel="stylesheet" href="/_astro/_slug_.CDWqF8AB.css">
<style>.post-layout[data-astro-cid-yvbahnfj]{display:grid;grid-template-columns:260px 1fr;gap:2.5rem}.sidebar-left[data-astro-cid-yvbahnfj]{position:relative}@media (max-width: 1080px){.post-layout[data-astro-cid-yvbahnfj]{grid-template-columns:1fr}}
.toc[data-astro-cid-xvrfupwn]{position:sticky;top:90px;max-height:calc(100vh - 120px);overflow:auto;padding:1rem 1rem 1.2rem;background:var(--color-bg-alt);border:1px solid var(--color-border);border-radius:var(--radius-md);font-size:.8rem;line-height:1.3}.toc-title[data-astro-cid-xvrfupwn]{font-weight:600;font-size:.75rem;text-transform:uppercase;letter-spacing:.08em;margin-bottom:.6rem;color:var(--color-text-alt)}.toc[data-astro-cid-xvrfupwn] ul[data-astro-cid-xvrfupwn]{list-style:none;margin:0;padding:0;display:flex;flex-direction:column;gap:.35rem}.toc[data-astro-cid-xvrfupwn] a[data-astro-cid-xvrfupwn]{text-decoration:none;color:var(--color-text-alt)}.toc[data-astro-cid-xvrfupwn] a[data-astro-cid-xvrfupwn]:hover{color:var(--color-accent)}.toc[data-astro-cid-xvrfupwn] li[data-astro-cid-xvrfupwn][class*=d-3]{margin-left:.75rem}.toc[data-astro-cid-xvrfupwn] li[data-astro-cid-xvrfupwn][class*=d-4]{margin-left:1.4rem}@media (max-width: 1080px){.toc[data-astro-cid-xvrfupwn]{display:none}}
</style><script type="module" src="/_astro/hoisted.CwSnpN4J.js"></script></head> <body> <div id="readingProgress" style="position:fixed;left:0;top:0;height:3px;background:linear-gradient(90deg,#2563eb,#9333ea);width:0;z-index:999;transition:width .15s ease;"></div>  <header class="site-header container"> <div class="logo-wrap"> <a class="logo" href="/">Dev|Journal</a> </div> <nav class="main-nav"> <a href="/"> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: -2px; margin-right: 4px;"> <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path> <polyline points="9 22 9 12 15 12 15 22"></polyline> </svg>
Home
</a> <a href="/ai-news/" class="ai-news-link"> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: -2px; margin-right: 4px;"> <path d="M12 2a2 2 0 0 1 2 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 0 1 7 7h-9.5a.5.5 0 0 0-.5.5.5.5 0 0 1-1 0 .5.5 0 0 0-.5-.5H1a7 7 0 0 1 7-7h1V5.73c-.6-.34-1-.99-1-1.73a2 2 0 0 1 2-2z"></path> <path d="M7 15v4a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-4"></path> </svg>
AI News
</a> <a href="/tags/"> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: -2px; margin-right: 4px;"> <path d="M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2z"></path> <circle cx="7" cy="7" r="1.5"></circle> </svg>
Tags
</a> <a href="/about/"> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: -2px; margin-right: 4px;"> <circle cx="12" cy="12" r="10"></circle> <path d="M12 16v-4"></path> <path d="M12 8h.01"></path> </svg>
About
</a> <button id="themeToggle" class="theme-toggle" aria-label="Toggle dark mode"> <span class="theme-icon">☾</span> <span class="theme-text">dark</span> </button> </nav> </header> <main class="container content-area">  <div class="post-layout" data-astro-cid-yvbahnfj> <aside class="sidebar-left" data-astro-cid-yvbahnfj> <nav class="toc" aria-label="Table of Contents" data-astro-cid-xvrfupwn> <div class="toc-title" data-astro-cid-xvrfupwn>On this page</div> <ul data-astro-cid-xvrfupwn> <li class="d-2" data-astro-cid-xvrfupwn><a href="#introduction" data-astro-cid-xvrfupwn>Introduction</a></li><li class="d-2" data-astro-cid-xvrfupwn><a href="#why-lsp-matters" data-astro-cid-xvrfupwn>Why LSP Matters</a></li><li class="d-3" data-astro-cid-xvrfupwn><a href="#1-maintainability" data-astro-cid-xvrfupwn>1. **Maintainability**</a></li><li class="d-3" data-astro-cid-xvrfupwn><a href="#2-reusability" data-astro-cid-xvrfupwn>2. **Reusability**</a></li><li class="d-3" data-astro-cid-xvrfupwn><a href="#3-polymorphism" data-astro-cid-xvrfupwn>3. **Polymorphism**</a></li><li class="d-3" data-astro-cid-xvrfupwn><a href="#4-testability" data-astro-cid-xvrfupwn>4. **Testability**</a></li><li class="d-3" data-astro-cid-xvrfupwn><a href="#example-before-applying-lsp" data-astro-cid-xvrfupwn>Example: Before Applying LSP</a></li><li class="d-3" data-astro-cid-xvrfupwn><a href="#example-after-applying-lsp" data-astro-cid-xvrfupwn>Example: After Applying LSP</a></li><li class="d-2" data-astro-cid-xvrfupwn><a href="#examples-from-java" data-astro-cid-xvrfupwn>Examples from java</a></li><li class="d-3" data-astro-cid-xvrfupwn><a href="#1-java-collections-framework" data-astro-cid-xvrfupwn>1. **Java Collections Framework**</a></li><li class="d-3" data-astro-cid-xvrfupwn><a href="#2-java-inputoutput-io-streams" data-astro-cid-xvrfupwn>2. **Java Input/Output (I/O) Streams**</a></li><li class="d-2" data-astro-cid-xvrfupwn><a href="#common-pitfalls" data-astro-cid-xvrfupwn>Common Pitfalls</a></li><li class="d-3" data-astro-cid-xvrfupwn><a href="#1-improper-use-of-inheritance" data-astro-cid-xvrfupwn>1. **Improper Use of Inheritance**</a></li><li class="d-3" data-astro-cid-xvrfupwn><a href="#2-ignoring-pre-and-post-conditions" data-astro-cid-xvrfupwn>2. **Ignoring Pre- and Post-conditions**</a></li><li class="d-3" data-astro-cid-xvrfupwn><a href="#3-overriding-methods-incorrectly" data-astro-cid-xvrfupwn>3. **Overriding Methods Incorrectly**</a></li><li class="d-2" data-astro-cid-xvrfupwn><a href="#conclusion" data-astro-cid-xvrfupwn>Conclusion</a></li> </ul> </nav>  </aside> <article class="post" data-astro-cid-yvbahnfj> <header class="post-header" data-astro-cid-yvbahnfj> <h1 data-astro-cid-yvbahnfj>L from SOLID</h1> <div class="meta" data-astro-cid-yvbahnfj> <time datetime="2024-06-19T23:00:46.000Z" data-astro-cid-yvbahnfj>Wed Jun 19 2024</time> <span data-astro-cid-yvbahnfj>• 4 min read</span> </div> <div class="tag-row" data-astro-cid-yvbahnfj><a class="tag " href="/tags/software-design/" data-astro-cid-yvbahnfj>Software design</a><a class="tag " href="/tags/solid/" data-astro-cid-yvbahnfj>SOLID</a></div> </header> <div class="post-body prose" data-astro-cid-yvbahnfj> <h1 id="the-liskov-substitution-principle-lsp-in-object-oriented-design">The Liskov Substitution Principle (LSP) in Object-Oriented Design</h1>
<h2 id="introduction">Introduction</h2>
<p>The Liskov Substitution Principle (LSP) is one of the five SOLID principles of object-oriented design, it states that objects of a superclass should be replaceable with objects of a subclass without affecting the correctness of the program. This principle ensures that a subclass can stand in for its superclass, promoting more robust and maintainable code.</p>
<h2 id="why-lsp-matters">Why LSP Matters</h2>
<h3 id="1-maintainability">1. <strong>Maintainability</strong></h3>
<p>Adhering to LSP makes the codebase easier to maintain. When subclasses can replace their parent classes without introducing errors, developers can extend and refactor the system without fear of breaking existing functionality.</p>
<h3 id="2-reusability">2. <strong>Reusability</strong></h3>
<p>LSP enhances code reusability. By ensuring subclasses maintain the behavior expected by the superclass, these subclasses can be used interchangeably in different parts of the application, increasing the versatility of the code.</p>
<h3 id="3-polymorphism">3. <strong>Polymorphism</strong></h3>
<p>LSP is foundational to achieving true polymorphism in object-oriented systems. It allows objects to be treated as instances of their parent class, enabling dynamic method dispatch and more flexible system design.</p>
<h3 id="4-testability">4. <strong>Testability</strong></h3>
<p>Following LSP improves testability. When subclasses adhere to the contracts defined by their superclasses, unit tests for the superclass are also valid for the subclass. This reduces redundancy in testing and ensures consistent behavior across the hierarchy.</p>
<h3 id="example-before-applying-lsp">Example: Before Applying LSP</h3>
<p>Consider a scenario with a base class <code>Bird</code> and a derived class <code>Penguin</code>.</p>
<pre class="astro-code github-dark-default" style="background-color:#0d1117;color:#e6edf3; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="java"><code><span class="line"><span style="color:#FF7B72">public</span><span style="color:#FF7B72"> class</span><span style="color:#FFA657"> Bird</span><span style="color:#E6EDF3"> {</span></span>
<span class="line"><span style="color:#FF7B72">    public</span><span style="color:#FF7B72"> void</span><span style="color:#D2A8FF"> fly</span><span style="color:#E6EDF3">() {</span></span>
<span class="line"><span style="color:#E6EDF3">        System.out.</span><span style="color:#D2A8FF">println</span><span style="color:#E6EDF3">(</span><span style="color:#A5D6FF">"I am flying"</span><span style="color:#E6EDF3">);</span></span>
<span class="line"><span style="color:#E6EDF3">    }</span></span>
<span class="line"><span style="color:#E6EDF3">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF7B72">public</span><span style="color:#FF7B72"> class</span><span style="color:#FFA657"> Penguin</span><span style="color:#FF7B72"> extends</span><span style="color:#79C0FF"> Bird</span><span style="color:#E6EDF3"> {</span></span>
<span class="line"><span style="color:#E6EDF3">    @</span><span style="color:#FF7B72">Override</span></span>
<span class="line"><span style="color:#FF7B72">    public</span><span style="color:#FF7B72"> void</span><span style="color:#D2A8FF"> fly</span><span style="color:#E6EDF3">() {</span></span>
<span class="line"><span style="color:#FF7B72">        throw</span><span style="color:#FF7B72"> new</span><span style="color:#D2A8FF"> UnsupportedOperationException</span><span style="color:#E6EDF3">(</span><span style="color:#A5D6FF">"Penguins cannot fly"</span><span style="color:#E6EDF3">);</span></span>
<span class="line"><span style="color:#E6EDF3">    }</span></span>
<span class="line"><span style="color:#E6EDF3">}</span></span>
<span class="line"></span></code></pre>
<p>In this example, <code>Penguin</code> violates LSP because it cannot be substituted for <code>Bird</code>. A <code>Penguin</code> object will cause unexpected behavior when the <code>fly</code> method is called, which contradicts the expectations set by the <code>Bird</code> class.</p>
<h3 id="example-after-applying-lsp">Example: After Applying LSP</h3>
<p>To adhere to LSP, we need to rethink our class hierarchy. One approach is to introduce a more specific class structure that accommodates different types of birds appropriately.</p>
<pre class="astro-code github-dark-default" style="background-color:#0d1117;color:#e6edf3; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="java"><code><span class="line"><span style="color:#FF7B72">public</span><span style="color:#FF7B72"> abstract</span><span style="color:#FF7B72"> class</span><span style="color:#FFA657"> Bird</span><span style="color:#E6EDF3"> {</span></span>
<span class="line"><span style="color:#FF7B72">    public</span><span style="color:#FF7B72"> abstract</span><span style="color:#FF7B72"> void</span><span style="color:#D2A8FF"> move</span><span style="color:#E6EDF3">();</span></span>
<span class="line"><span style="color:#E6EDF3">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF7B72">public</span><span style="color:#FF7B72"> class</span><span style="color:#FFA657"> FlyingBird</span><span style="color:#FF7B72"> extends</span><span style="color:#79C0FF"> Bird</span><span style="color:#E6EDF3"> {</span></span>
<span class="line"><span style="color:#E6EDF3">    @</span><span style="color:#FF7B72">Override</span></span>
<span class="line"><span style="color:#FF7B72">    public</span><span style="color:#FF7B72"> void</span><span style="color:#D2A8FF"> move</span><span style="color:#E6EDF3">() {</span></span>
<span class="line"><span style="color:#D2A8FF">        fly</span><span style="color:#E6EDF3">();</span></span>
<span class="line"><span style="color:#E6EDF3">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF7B72">    public</span><span style="color:#FF7B72"> void</span><span style="color:#D2A8FF"> fly</span><span style="color:#E6EDF3">() {</span></span>
<span class="line"><span style="color:#E6EDF3">        System.out.</span><span style="color:#D2A8FF">println</span><span style="color:#E6EDF3">(</span><span style="color:#A5D6FF">"I am flying"</span><span style="color:#E6EDF3">);</span></span>
<span class="line"><span style="color:#E6EDF3">    }</span></span>
<span class="line"><span style="color:#E6EDF3">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF7B72">public</span><span style="color:#FF7B72"> class</span><span style="color:#FFA657"> Penguin</span><span style="color:#FF7B72"> extends</span><span style="color:#79C0FF"> Bird</span><span style="color:#E6EDF3"> {</span></span>
<span class="line"><span style="color:#E6EDF3">    @</span><span style="color:#FF7B72">Override</span></span>
<span class="line"><span style="color:#FF7B72">    public</span><span style="color:#FF7B72"> void</span><span style="color:#D2A8FF"> move</span><span style="color:#E6EDF3">() {</span></span>
<span class="line"><span style="color:#D2A8FF">        walk</span><span style="color:#E6EDF3">();</span></span>
<span class="line"><span style="color:#E6EDF3">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF7B72">    public</span><span style="color:#FF7B72"> void</span><span style="color:#D2A8FF"> walk</span><span style="color:#E6EDF3">() {</span></span>
<span class="line"><span style="color:#E6EDF3">        System.out.</span><span style="color:#D2A8FF">println</span><span style="color:#E6EDF3">(</span><span style="color:#A5D6FF">"I am walking"</span><span style="color:#E6EDF3">);</span></span>
<span class="line"><span style="color:#E6EDF3">    }</span></span>
<span class="line"><span style="color:#E6EDF3">}</span></span>
<span class="line"></span></code></pre>
<p>In this revised structure:</p>
<ul>
<li>The <code>Bird</code> class is abstract and defines a general movement behavior.</li>
<li><code>FlyingBird</code> and <code>Penguin</code> are concrete classes that implement the <code>move</code> method according to their capabilities.</li>
</ul>
<p>Now, substituting a <code>Penguin</code> for a <code>Bird</code> does not violate any expectations, as both can still perform the <code>move</code> action correctly.</p>
<h2 id="examples-from-java">Examples from java</h2>
<h3 id="1-java-collections-framework">1. <strong>Java Collections Framework</strong></h3>
<p>The Java Collections Framework is a good example of LSP in action. Consider the <code>List</code> interface and its implementations, <code>ArrayList</code> and <code>LinkedList</code>.</p>
<pre class="astro-code github-dark-default" style="background-color:#0d1117;color:#e6edf3; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="java"><code><span class="line"><span style="color:#E6EDF3">List</span><span style="color:#FFA657">&#x3C;</span><span style="color:#FF7B72">String</span><span style="color:#FFA657">> </span><span style="color:#E6EDF3">arrayList</span><span style="color:#FF7B72"> =</span><span style="color:#FF7B72"> new</span><span style="color:#E6EDF3"> ArrayList&#x3C;>();</span></span>
<span class="line"><span style="color:#E6EDF3">List</span><span style="color:#FFA657">&#x3C;</span><span style="color:#FF7B72">String</span><span style="color:#FFA657">> </span><span style="color:#E6EDF3">linkedList</span><span style="color:#FF7B72"> =</span><span style="color:#FF7B72"> new</span><span style="color:#E6EDF3"> LinkedList&#x3C;>();</span></span>
<span class="line"></span></code></pre>
<p>Both <code>ArrayList</code> and <code>LinkedList</code> can be used interchangeably as <code>List</code> objects without affecting the correctness of the code. Methods defined in the <code>List</code> interface work seamlessly with both <code>ArrayList</code> and <code>LinkedList</code>, adhering to LSP.</p>
<p>but the immutable list doesn’t support the remove method, so it doesn’t respect LSP.</p>
<h3 id="2-java-inputoutput-io-streams">2. <strong>Java Input/Output (I/O) Streams</strong></h3>
<p>The Java I/O Streams follow LSP by allowing different stream types to be used interchangeably. For example, <code>FileInputStream</code>, <code>BufferedInputStream</code>, and <code>DataInputStream</code> can all be used as <code>InputStream</code> objects.</p>
<pre class="astro-code github-dark-default" style="background-color:#0d1117;color:#e6edf3; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="java"><code><span class="line"><span style="color:#E6EDF3">InputStream</span><span style="color:#E6EDF3"> fileStream</span><span style="color:#FF7B72"> =</span><span style="color:#FF7B72"> new</span><span style="color:#D2A8FF"> FileInputStream</span><span style="color:#E6EDF3">(</span><span style="color:#A5D6FF">"data.txt"</span><span style="color:#E6EDF3">);</span></span>
<span class="line"><span style="color:#E6EDF3">InputStream</span><span style="color:#E6EDF3"> bufferedStream</span><span style="color:#FF7B72"> =</span><span style="color:#FF7B72"> new</span><span style="color:#D2A8FF"> BufferedInputStream</span><span style="color:#E6EDF3">(fileStream);</span></span>
<span class="line"><span style="color:#E6EDF3">InputStream</span><span style="color:#E6EDF3"> dataStream</span><span style="color:#FF7B72"> =</span><span style="color:#FF7B72"> new</span><span style="color:#D2A8FF"> DataInputStream</span><span style="color:#E6EDF3">(bufferedStream);</span></span>
<span class="line"></span></code></pre>
<p>Each stream type can be substituted for <code>InputStream</code> without altering the behavior expected from an input stream.</p>
<h2 id="common-pitfalls">Common Pitfalls</h2>
<h3 id="1-improper-use-of-inheritance">1. <strong>Improper Use of Inheritance</strong></h3>
<p>A common mistake is using inheritance for code reuse without considering LSP. This can lead to subclasses that do not fulfill the contract of the superclass. To avoid this, always ensure that a subclass can stand in for its superclass without altering the expected behavior.</p>
<h3 id="2-ignoring-pre--and-post-conditions">2. <strong>Ignoring Pre- and Post-conditions</strong></h3>
<p>Subclasses should not weaken preconditions or strengthen postconditions of methods they override. This means that the conditions required before and after method execution in a subclass should be consistent with those in the superclass.</p>
<h3 id="3-overriding-methods-incorrectly">3. <strong>Overriding Methods Incorrectly</strong></h3>
<p>Subclasses should override methods to provide specific behavior while still honoring the contract of the superclass. For instance, if a superclass method returns a specific type, the subclass should return a compatible type.</p>
<h2 id="conclusion">Conclusion</h2>
<p>The Liskov Substitution Principle is crucial for creating flexible, maintainable, and scalable object-oriented systems. By ensuring that subclasses can substitute their superclasses without altering expected behavior, developers can build more robust and reusable code. Adhering to LSP involves careful design of class hierarchies, mindful implementation of inheritance, and rigorous testing to confirm consistent behavior across the hierarchy. By mastering LSP, you will significantly improve the quality and reliability of your software.</p> </div> </article> </div> <div class="back-link" data-astro-cid-yvbahnfj><a href="/" data-astro-cid-yvbahnfj>← Back to home</a></div>  </main> <footer class="site-footer container"> <p>© 2025 AREZKI El Mehdi • <a href="https://github.com/earezki">GitHub</a> • <a href="/rss.xml">RSS</a></p> </footer>  <script>
      // Read/Unread article tracking
      (function() {
        const STORAGE_KEY = 'readArticles';
        
        function getReadArticles() {
          try {
            const data = localStorage.getItem(STORAGE_KEY);
            return data ? JSON.parse(data) : [];
          } catch (e) {
            return [];
          }
        }
        
        function markArticleAsRead(url) {
          try {
            const readArticles = getReadArticles();
            if (!readArticles.includes(url)) {
              readArticles.push(url);
              localStorage.setItem(STORAGE_KEY, JSON.stringify(readArticles));
            }
          } catch (e) {
            console.error('Failed to mark article as read:', e);
          }
        }
        
        function isArticleRead(url) {
          const readArticles = getReadArticles();
          return readArticles.includes(url);
        }
        
        // Update post cards on list pages
        function updatePostCards() {
          const postCards = document.querySelectorAll('.post-card[data-article-url]');
          postCards.forEach(function(card) {
            const url = card.getAttribute('data-article-url');
            if (url) {
              if (isArticleRead(url)) {
                card.classList.add('read');
                card.classList.remove('unread');
              } else {
                card.classList.add('unread');
                card.classList.remove('read');
              }
            }
          });
        }
        
        // Mark current article as read (on article pages)
        function markCurrentArticleAsRead() {
          const isArticlePage = document.querySelector('.post-body');
          if (isArticlePage) {
            const currentPath = window.location.pathname;
            markArticleAsRead(currentPath);
          }
        }
        
        // Initialize function
        function init() {
          updatePostCards();
          markCurrentArticleAsRead();
        }
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', init);
        
        // Handle back/forward navigation (bfcache)
        window.addEventListener('pageshow', function(event) {
          // If page is loaded from cache, update the cards
          if (event.persisted) {
            init();
          }
        });
      })();
    </script> </body> </html> 